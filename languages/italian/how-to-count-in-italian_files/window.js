if(typeof (Draggable)!="undefined"){Draggable.prototype.draw=function(I){var H=Position.cumulativeOffset(this.element);if(this.options.ghosting){var A=Position.realOffset(this.element);H[0]+=A[0]-Position.deltaX;H[1]+=A[1]-Position.deltaY;}var G=this.currentDelta();H[0]-=G[0];H[1]-=G[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){H[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;
H[1]-=this.options.scroll.scrollTop-this.originalScrollTop;}var C=[0,1].map(function(L){return(I[L]-H[L]-this.offset[L]);}.bind(this));if(this.options.snap){if(typeof this.options.snap=="function"){C=this.options.snap(C[0],C[1],this);}else{if(this.options.snap instanceof Array){C=C.map(function(L,M){return Math.round(L/this.options.snap[M])*this.options.snap[M];
}.bind(this));}else{C=C.map(function(L){return Math.round(L/this.options.snap)*this.options.snap;}.bind(this));}}}if(this.options.onDraw){this.options.onDraw.bind(this)(C);}else{var B=this.element.style;if(this.options.constrainToViewport){var K=document.viewport.getDimensions();var E=this.element.getDimensions();
var F=parseInt(this.element.getStyle("margin-top"));var J=parseInt(this.element.getStyle("margin-left"));var D=[[0-J,0-F],[(K.width-E.width)-J,(K.height-E.height)-F]];if((!this.options.constraint)||(this.options.constraint=="horizontal")){if((C[0]>=D[0][0])&&(C[0]<=D[1][0])){this.element.style.left=C[0]+"px";
}else{this.element.style.left=((C[0]<D[0][0])?D[0][0]:D[1][0])+"px";}}if((!this.options.constraint)||(this.options.constraint=="vertical")){if((C[1]>=D[0][1])&&(C[1]<=D[1][1])){this.element.style.top=C[1]+"px";}else{this.element.style.top=((C[1]<=D[0][1])?D[0][1]:D[1][1])+"px";}}}else{if((!this.options.constraint)||(this.options.constraint=="horizontal")){B.left=C[0]+"px";
}if((!this.options.constraint)||(this.options.constraint=="vertical")){B.top=C[1]+"px";}}if(B.visibility=="hidden"){B.visibility="";}}};}if(typeof (Prototype)=="undefined"){throw"Control.Window requires Prototype to be loaded.";}if(typeof (IframeShim)=="undefined"){throw"Control.Window requires IframeShim to be loaded.";
}if(typeof (Object.Event)=="undefined"){throw"Control.Window requires Object.Event to be loaded.";}Control.Window=Class.create({initialize:function(B,C){Control.Window.windows.push(this);this.container=false;this.isOpen=false;this.href=false;this.sourceContainer=false;this.ajaxRequest=false;this.remoteContentLoaded=false;
this.numberInSequence=Control.Window.windows.length+1;this.indicator=false;this.effects={fade:false,appear:false};this.indicatorEffects={fade:false,appear:false};this.options=Object.extend({beforeOpen:Prototype.emptyFunction,afterOpen:Prototype.emptyFunction,beforeClose:Prototype.emptyFunction,afterClose:Prototype.emptyFunction,height:null,width:null,className:false,position:"center",offsetLeft:0,offsetTop:0,iframe:false,hover:false,indicator:false,closeOnClick:false,iframeshim:true,fade:false,fadeDuration:0.75,draggable:false,onDrag:Prototype.emptyFunction,resizable:false,minHeight:false,minWidth:false,maxHeight:false,maxWidth:false,onResize:Prototype.emptyFunction,constrainToViewport:false,method:"post",parameters:{},onComplete:Prototype.emptyFunction,onSuccess:Prototype.emptyFunction,onFailure:Prototype.emptyFunction,onException:Prototype.emptyFunction,onRemoteContentLoaded:Prototype.emptyFunction,insertRemoteContentAt:false},C||{});
this.indicator=this.options.indicator?$(this.options.indicator):false;if(B){if(typeof (B)=="string"&&B.match(Control.Window.uriRegex)){this.href=B;}else{this.container=$(B);this.createDefaultContainer(B);if(this.container&&((this.container.readAttribute("href")&&this.container.readAttribute("href")!="")||(this.options.hover&&this.options.hover!==true))){if(this.options.hover&&this.options.hover!==true){this.sourceContainer=$(this.options.hover);
}else{this.sourceContainer=this.container;this.href=this.container.readAttribute("href");var A=this.href.match(/^#(.+)$/);if(A&&A[1]){this.container=$(A[1]);this.href=false;}else{this.container=false;}}this.sourceContainerOpenHandler=function(E){this.open(E);E.stop();return false;}.bindAsEventListener(this);
this.sourceContainerCloseHandler=function(E){this.close(E);}.bindAsEventListener(this);this.sourceContainerMouseMoveHandler=function(E){this.position(E);}.bindAsEventListener(this);if(this.options.hover){this.sourceContainer.observe("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.observe("mouseleave",this.sourceContainerCloseHandler);
if(this.options.position=="mouse"){this.sourceContainer.observe("mousemove",this.sourceContainerMouseMoveHandler);}}else{this.sourceContainer.observe("click",this.sourceContainerOpenHandler);}}}}this.createDefaultContainer(B);if(this.options.insertRemoteContentAt===false){this.options.insertRemoteContentAt=this.container;
}var D={margin:0,position:"absolute",zIndex:Control.Window.initialZIndexForWindow()};if(this.options.width){D.width=$value(this.options.width)+"px";}if(this.options.height){D.height=$value(this.options.height)+"px";}this.container.setStyle(D);if(this.options.className){this.container.addClassName(this.options.className);
}this.positionHandler=this.position.bindAsEventListener(this);this.outOfBoundsPositionHandler=this.ensureInBounds.bindAsEventListener(this);this.bringToFrontHandler=this.bringToFront.bindAsEventListener(this);this.container.observe("mousedown",this.bringToFrontHandler);this.container.hide();this.closeHandler=this.close.bindAsEventListener(this);
if(this.options.iframeshim){this.iFrameShim=new IframeShim();this.iFrameShim.hide();}this.applyResizable();this.applyDraggable();Event.observe(window,"resize",this.outOfBoundsPositionHandler);this.notify("afterInitialize");},open:function(C){if(this.isOpen){this.bringToFront();return false;}if(this.notify("beforeOpen")===false){return false;
}if(this.options.closeOnClick){if(this.options.closeOnClick===true){this.closeOnClickContainer=$(document.body);}else{if(this.options.closeOnClick=="container"){this.closeOnClickContainer=this.container;}else{if(this.options.closeOnClick=="overlay"){Control.Overlay.load();this.closeOnClickContainer=Control.Overlay.container;
}else{this.closeOnClickContainer=$(this.options.closeOnClick);}}}this.closeOnClickContainer.observe("click",this.closeHandler);}if(this.href&&!this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.href.match(/\.(jpe?g|gif|png|tiff?)$/i)){var A=new Element("img");A.observe("load",function(D){this.getRemoteContentInsertionTarget().insert(D);
this.position();if(this.notify("onRemoteContentLoaded")!==false){if(this.options.indicator){this.hideIndicator();}this.finishOpen();}}.bind(this,A));A.writeAttribute("src",this.href);}else{if(!this.ajaxRequest){if(this.options.indicator){this.showIndicator();}this.ajaxRequest=new Ajax.Request(this.href,{method:this.options.method,parameters:this.options.parameters,onComplete:function(D){this.notify("onComplete",D);
this.ajaxRequest=false;}.bind(this),onSuccess:function(D){this.getRemoteContentInsertionTarget().insert(D.responseText);this.notify("onSuccess",D);if(this.notify("onRemoteContentLoaded")!==false){if(this.options.indicator){this.hideIndicator();}this.finishOpen();}}.bind(this),onFailure:function(D){this.notify("onFailure",D);
if(this.options.indicator){this.hideIndicator();}}.bind(this),onException:function(D,E){this.notify("onException",D,E);if(this.options.indicator){this.hideIndicator();}}.bind(this)});}}return true;}else{if(this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.options.indicator){this.showIndicator();
}this.getRemoteContentInsertionTarget().insert(Control.Window.iframeTemplate.evaluate({href:this.href}));var B=this.container.down("iframe");B.onload=function(){this.notify("onRemoteContentLoaded");if(this.options.indicator){this.hideIndicator();}B.onload=null;}.bind(this);}}this.finishOpen(C);return true;
},close:function(A){if(!this.isOpen||this.notify("beforeClose",A)===false){return false;}if(this.options.closeOnClick){this.closeOnClickContainer.stopObserving("click",this.closeHandler);}if(this.options.fade){this.effects.fade=new Effect.Fade(this.container,{queue:{position:"front",scope:"Control.Window"+this.numberInSequence},from:1,to:0,duration:this.options.fadeDuration/2,afterFinish:function(){if(this.iFrameShim){this.iFrameShim.hide();
}this.isOpen=false;this.notify("afterClose");}.bind(this)});}else{this.container.hide();if(this.iFrameShim){this.iFrameShim.hide();}}if(this.ajaxRequest){this.ajaxRequest.transport.abort();}if(!(this.options.draggable||this.options.resizable)&&this.options.position=="center"){Event.stopObserving(window,"resize",this.positionHandler);
}if(!this.options.draggable&&this.options.position=="center"){Event.stopObserving(window,"scroll",this.positionHandler);}if(this.options.indicator){this.hideIndicator();}if(!this.options.fade){this.isOpen=false;this.notify("afterClose");}return true;},position:function(D){if(this.options.position=="mouse"){var G=[Event.pointerX(D),Event.pointerY(D)];
this.container.setStyle({top:G[1]+$value(this.options.offsetTop)+"px",left:G[0]+$value(this.options.offsetLeft)+"px"});return ;}var H=this.container.getDimensions();var C=document.viewport.getDimensions();Position.prepare();var B=(Position.deltaX+Math.floor((C.width-H.width)/2));var A=(Position.deltaY+((C.height>H.height)?Math.floor((C.height-H.height)/2):0));
if(this.options.position=="center"){this.container.setStyle({top:(H.height<=C.height)?((A!=null&&A>0)?A:0)+"px":0,left:(H.width<=C.width)?((B!=null&&B>0)?B:0)+"px":0});}else{if(this.options.position=="relative"){var G=this.sourceContainer.cumulativeOffset();var F=G[1]+$value(this.options.offsetTop);var E=G[0]+$value(this.options.offsetLeft);
this.container.setStyle({top:(H.height<=C.height)?(this.options.constrainToViewport?Math.max(0,Math.min(C.height-(H.height),F)):F)+"px":0,left:(H.width<=C.width)?(this.options.constrainToViewport?Math.max(0,Math.min(C.width-(H.width),E)):E)+"px":0});}else{if(this.options.position.length){var F=$value(this.options.position[1])+$value(this.options.offsetTop);
var E=$value(this.options.position[0])+$value(this.options.offsetLeft);this.container.setStyle({top:(H.height<=C.height)?(this.options.constrainToViewport?Math.max(0,Math.min(C.height-(H.height),F)):F)+"px":0,left:(H.width<=C.width)?(this.options.constrainToViewport?Math.max(0,Math.min(C.width-(H.width),E)):E)+"px":0});
}}}if(this.iFrameShim){this.updateIFrameShimZIndex();}},ensureInBounds:function(){if(!this.isOpen){return ;}var A=document.viewport.getDimensions();var C=this.container.cumulativeOffset();var B=this.container.getDimensions();if(C.left+B.width>A.width){this.container.setStyle({left:(Math.max(0,A.width-B.width))+"px"});
}if(C.top+B.height>A.height){this.container.setStyle({top:(Math.max(0,A.height-B.height))+"px"});}},bringToFront:function(){Control.Window.bringToFront(this);this.notify("bringToFront");},destroy:function(){this.container.stopObserving("mousedown",this.bringToFrontHandler);if(this.draggable){Resizables.removeObserver(this.container);
this.draggable.handle.stopObserving("mousedown",this.bringToFrontHandler);this.draggable.destroy();}if(this.resizable){Resizables.removeObserver(this.container);this.resizable.handle.stopObserving("mousedown",this.bringToFrontHandler);this.resizable.destroy();}if(this.container&&!this.sourceContainer){this.container.remove();
}if(this.sourceContainer){if(this.options.hover){this.sourceContainer.stopObserving("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.stopObserving("mouseleave",this.sourceContainerCloseHandler);if(this.options.position=="mouse"){this.sourceContainer.stopObserving("mousemove",this.sourceContainerMouseMoveHandler);
}}else{this.sourceContainer.stopObserving("click",this.sourceContainerOpenHandler);}}if(this.iFrameShim){this.iFrameShim.destroy();}Event.stopObserving(window,"resize",this.outOfBoundsPositionHandler);Control.Window.windows=Control.Window.windows.without(this);this.notify("afterDestroy");},applyResizable:function(){if(this.options.resizable){if(typeof (Resizable)=="undefined"){throw"Control.Window requires resizable.js to be loaded.";
}var A=null;if(this.options.resizable===true){A=new Element("div",{className:"resizable_handle"});this.container.insert(A);}else{A=$(this.options.resziable);}this.resizable=new Resizable(this.container,{handle:A,minHeight:this.options.minHeight,minWidth:this.options.minWidth,maxHeight:this.options.constrainToViewport?function(B){return(document.viewport.getDimensions().height-parseInt(B.style.top||0))-(B.getHeight()-parseInt(B.style.height||0));
}:this.options.maxHeight,maxWidth:this.options.constrainToViewport?function(B){return(document.viewport.getDimensions().width-parseInt(B.style.left||0))-(B.getWidth()-parseInt(B.style.width||0));}:this.options.maxWidth});this.resizable.handle.observe("mousedown",this.bringToFrontHandler);Resizables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){if(this.iFrameShim){this.updateIFrameShimZIndex();
}this.notify("onResize");}.bind(this)));}},applyDraggable:function(){if(this.options.draggable){if(typeof (Draggables)=="undefined"){throw"Control.Window requires dragdrop.js to be loaded.";}var A=null;if(this.options.draggable===true){A=new Element("div",{className:"draggable_handle"});this.container.insert(A);
}else{A=$(this.options.draggable);}this.draggable=new Draggable(this.container,{handle:A,constrainToViewport:this.options.constrainToViewport,zindex:this.container.getStyle("z-index"),starteffect:function(){if(Prototype.Browser.IE){this.old_onselectstart=document.onselectstart;document.onselectstart=function(){return false;
};}}.bind(this),endeffect:function(){document.onselectstart=this.old_onselectstart;}.bind(this)});this.draggable.handle.observe("mousedown",this.bringToFrontHandler);Draggables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){if(this.iFrameShim){this.updateIFrameShimZIndex();}this.notify("onDrag");
}.bind(this)));}},createDefaultContainer:function(A){if(!this.container){this.container=new Element("div",{id:"control_window_"+this.numberInSequence});$(document.body).insert(this.container);if(typeof (A)=="string"&&$(A)==null&&!A.match(/^#(.+)$/)&&!A.match(Control.Window.uriRegex)){this.container.update(A);
}}},finishOpen:function(A){this.bringToFront();if(this.options.fade){if(typeof (Effect)=="undefined"){throw"Control.Window requires effects.js to be loaded.";}if(this.effects.fade){this.effects.fade.cancel();}this.effects.appear=new Effect.Appear(this.container,{queue:{position:"end",scope:"Control.Window."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2,afterFinish:function(){if(this.iFrameShim){this.updateIFrameShimZIndex();
}this.isOpen=true;this.notify("afterOpen");}.bind(this)});}else{this.container.show();}this.position(A);if(!(this.options.draggable||this.options.resizable)&&this.options.position=="center"){Event.observe(window,"resize",this.positionHandler,false);}if(!this.options.draggable&&this.options.position=="center"){Event.observe(window,"scroll",this.positionHandler,false);
}if(!this.options.fade){this.isOpen=true;this.notify("afterOpen");}return true;},showIndicator:function(){this.showIndicatorTimeout=window.setTimeout(function(){if(this.options.fade){this.indicatorEffects.appear=new Effect.Appear(this.indicator,{queue:{position:"front",scope:"Control.Window.indicator."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2});
}else{this.indicator.show();}}.bind(this),Control.Window.indicatorTimeout);},hideIndicator:function(){if(this.showIndicatorTimeout){window.clearTimeout(this.showIndicatorTimeout);}this.indicator.hide();},getRemoteContentInsertionTarget:function(){return typeof (this.options.insertRemoteContentAt)=="string"?this.container.down(this.options.insertRemoteContentAt):$(this.options.insertRemoteContentAt);
},updateIFrameShimZIndex:function(){if(this.iFrameShim){this.iFrameShim.positionUnder(this.container);}}});Object.extend(Control.Window,{windows:[],baseZIndex:9999,indicatorTimeout:250,iframeTemplate:new Template('<iframe src="#{href}" width="100%" height="100%" frameborder="0"></iframe>'),uriRegex:/^(\/|\#|https?\:\/\/|[\w]+\/)/,bringToFront:function(A){Control.Window.windows=Control.Window.windows.without(A);
Control.Window.windows.push(A);Control.Window.windows.each(function(C,D){var B=Control.Window.baseZIndex+D;C.container.setStyle({zIndex:B});if(C.isOpen){if(C.iFrameShim){C.updateIFrameShimZIndex();}}if(C.options.draggable){C.draggable.options.zindex=B;}});},open:function(B,C){var A=new Control.Window(B,C);
A.open();return A;},initialZIndexForWindow:function(A){return Control.Window.baseZIndex+(Control.Window.windows.length-1);}});Object.Event.extend(Control.Window);Control.Window.LayoutUpdateObserver=Class.create({initialize:function(A,B){this.w=A;this.element=$(A.container);this.observer=B;},onStart:Prototype.emptyFunction,onEnd:function(B,A){if(A.element==this.element&&this.iFrameShim){this.w.updateIFrameShimZIndex();
}},onResize:function(B,A){if(A.element==this.element){this.observer(this.element);}},onDrag:function(B,A){if(A.element==this.element){this.observer(this.element);}}});Control.Overlay={id:"control_overlay",loaded:false,container:false,lastOpacity:0,styles:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9998},ieStyles:{position:"absolute",top:0,left:0,zIndex:9998},effects:{fade:false,appear:false},load:function(){if(Control.Overlay.loaded){return false;
}Control.Overlay.loaded=true;Control.Overlay.container=new Element("div",{id:Control.Overlay.id});$(document.body).insert(Control.Overlay.container);if(Prototype.Browser.IE){Control.Overlay.container.setStyle(Control.Overlay.ieStyles);Event.observe(window,"scroll",Control.Overlay.positionOverlay);Event.observe(window,"resize",Control.Overlay.positionOverlay);
Control.Overlay.observe("beforeShow",Control.Overlay.positionOverlay);}else{Control.Overlay.container.setStyle(Control.Overlay.styles);}Control.Overlay.iFrameShim=new IframeShim();Control.Overlay.iFrameShim.hide();Event.observe(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.container.hide();
return true;},unload:function(){if(!Control.Overlay.loaded){return false;}Event.stopObserving(window,"resize",Control.Overlay.positionOverlay);Control.Overlay.stopObserving("beforeShow",Control.Overlay.positionOverlay);Event.stopObserving(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.iFrameShim.destroy();
Control.Overlay.container.remove();Control.Overlay.loaded=false;return true;},show:function(A,B){if(Control.Overlay.notify("beforeShow")===false){return false;}Control.Overlay.lastOpacity=A;Control.Overlay.positionIFrameShim();Control.Overlay.iFrameShim.show();if(B){if(typeof (Effect)=="undefined"){throw"Control.Window requires effects.js to be loaded.";
}if(Control.Overlay.effects.fade){Control.Overlay.effects.fade.cancel();}Control.Overlay.effects.appear=new Effect.Appear(Control.Overlay.container,{queue:{position:"end",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterShow");},from:0,to:Control.Overlay.lastOpacity,duration:(B===true?0.75:B)/2});
}else{Control.Overlay.container.setStyle({opacity:A||1});Control.Overlay.container.show();Control.Overlay.notify("afterShow");}return true;},hide:function(A){if(Control.Overlay.notify("beforeHide")===false){return false;}if(Control.Overlay.effects.appear){Control.Overlay.effects.appear.cancel();}Control.Overlay.iFrameShim.hide();
if(A){Control.Overlay.effects.fade=new Effect.Fade(Control.Overlay.container,{queue:{position:"front",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterHide");},from:Control.Overlay.lastOpacity,to:0,duration:(A===true?0.75:A)/2});}else{Control.Overlay.container.hide();Control.Overlay.notify("afterHide");
}return true;},positionIFrameShim:function(){if(Control.Overlay.container.visible()){Control.Overlay.iFrameShim.positionUnder(Control.Overlay.container);}},positionOverlay:function(){Control.Overlay.container.setStyle({width:document.body.clientWidth+"px",height:document.body.clientHeight+"px"});}};Object.Event.extend(Control.Overlay);
Control.ToolTip=Class.create(Control.Window,{initialize:function($super,A,C,B){$super(C,Object.extend(Object.extend(Object.clone(Control.ToolTip.defaultOptions),B||{}),{position:"mouse",hover:A}));}});Object.extend(Control.ToolTip,{defaultOptions:{offsetLeft:10}});Control.Modal=Class.create(Control.Window,{initialize:function($super,A,B){Control.Modal.InstanceMethods.beforeInitialize.bind(this)();
$super(A,Object.extend(Object.clone(Control.Modal.defaultOptions),B||{}));}});Object.extend(Control.Modal,{defaultOptions:{overlayOpacity:0.5,closeOnClick:"overlay"},current:false,open:function(A,B){var C=new Control.Modal(A,B);C.open();return C;},close:function(){if(Control.Modal.current){Control.Modal.current.close();
}},InstanceMethods:{beforeInitialize:function(){Control.Overlay.load();this.overlayFinishedOpening=false;this.observe("beforeOpen",Control.Modal.Observers.beforeOpen.bind(this));this.observe("afterOpen",Control.Modal.Observers.afterOpen.bind(this));this.observe("afterClose",Control.Modal.Observers.afterClose.bind(this));
}},Observers:{beforeOpen:function(){if(!this.overlayFinishedOpening){Control.Overlay.observeOnce("afterShow",function(){this.overlayFinishedOpening=true;this.open();}.bind(this));Control.Overlay.show(this.options.overlayOpacity,this.options.fade?this.options.fadeDuration:false);throw $break;}else{Control.Window.windows.without(this).invoke("close");
}},afterOpen:function(){Control.Modal.current=this;},afterClose:function(){Control.Overlay.hide(this.options.fade?this.options.fadeDuration:false);Control.Modal.current=false;this.overlayFinishedOpening=false;}}});Control.LightBox=Class.create(Control.Window,{initialize:function($super,A,B){this.allImagesLoaded=false;
if(B.modal){var B=Object.extend(Object.clone(Control.LightBox.defaultOptions),B||{});B=Object.extend(Object.clone(Control.Modal.defaultOptions),B);B=Control.Modal.InstanceMethods.beforeInitialize.bind(this)(B);$super(A,B);}else{$super(A,Object.extend(Object.clone(Control.LightBox.defaultOptions),B||{}));
}this.hasRemoteContent=this.href&&!this.options.iframe;if(this.hasRemoteContent){this.observe("onRemoteContentLoaded",Control.LightBox.Observers.onRemoteContentLoaded.bind(this));}else{this.applyImageObservers();}this.observe("beforeOpen",Control.LightBox.Observers.beforeOpen.bind(this));},applyImageObservers:function(){var A=this.getImages();
this.numberImagesToLoad=A.length;this.numberofImagesLoaded=0;A.each(function(B){B.observe("load",function(C){++this.numberofImagesLoaded;if(this.numberImagesToLoad==this.numberofImagesLoaded){this.allImagesLoaded=true;this.onAllImagesLoaded();}}.bind(this,B));B.hide();}.bind(this));},onAllImagesLoaded:function(){this.getImages().each(function(A){this.showImage(A);
}.bind(this));if(this.hasRemoteContent){if(this.options.indicator){this.hideIndicator();}this.finishOpen();}else{this.open();}},getImages:function(){return this.container.select(Control.LightBox.imageSelector);},showImage:function(A){A.show();}});Object.extend(Control.LightBox,{imageSelector:"img",defaultOptions:{},Observers:{beforeOpen:function(){if(!this.hasRemoteContent&&!this.allImagesLoaded){throw $break;
}},onRemoteContentLoaded:function(){this.applyImageObservers();if(!this.allImagesLoaded){throw $break;}}}});