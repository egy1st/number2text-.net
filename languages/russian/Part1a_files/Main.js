if(!window.WIDGETBOX){(function(){var D=false;var C=function(){WIDGETBOX.setPageLoaded();};var B=function(){WIDGETBOX.setPageUnloaded();};WIDGETBOX={libs:{},version:"60304",urls:{runtimeBaseUrl:"http://www.widgetserver.com/syndication",galleryBaseUrl:"http://www.widgetbox.com",cdnRuntimeBaseUrl:"http://cdn.widgetserver.com/syndication",cdnGalleryBaseUrl:"http://pub.widgetbox.com",metricsBaseUrl:"http://t.widgetserver.com/t",proxyBaseUrl:"http://p.widgetserver.com/p",mobileSiteRuntimeBaseUrl:"http://m.wbx.me",linkbarBaseUrl:"http://www.widgetserver.com/syndication/l",shareBaseUrl:"http://data.widgetserver.com/data-api",imageProxyBaseUrl:"http://p.widgetserver.com/p",dataApiBaseUrl:"http://data.widgetserver.com"},globals:{token:"",tokenTime:0,widgets:[],widgetCount:0,pageLoaded:false,pageUnloaded:false,eventListeners:[],pageLoadListeners:[],pageUnloadListeners:[],panels:[],panelCount:0,showPanelMarks:true,suppressGetWidget:false,disableGetWidget:false,enableLogging:false,disableHitTracking:false,log:"",trustedPage:false,disableInstallerMenu:false,renderInstallerMenuInline:false,anchorEl:null,vid:null,startTime:0,flashBlacklist:[],nextZIndex:5001,isTopAccessible:true,trackingKeys:{i:"appId",aik:"appPK",ri:"regId",ark:"regPK",uid:"userPK",apk:"providerPK",pnk:"installPartnerNetworkPK",gk:"fromGalleryPK",pt:"widgetPrototypeOrdinal",rv:"regVersion",rpv:"regPubVersion",iv:"appVersion",udd:"isUseDefaultDomain",dd:"defaultDomain"},shareTrackingKeyRegex:"sik|sid|iv|rv|rpv|v.S+|sd.S+|ud.S+"},init:function(){if(!D){D=true;WIDGETBOX.globals.startTime=(new Date()).getTime();if(window&&window.location&&window.location.protocol==="https:"){for(var H in WIDGETBOX.urls){if(WIDGETBOX.urls.hasOwnProperty(H)){WIDGETBOX.urls[H]=WIDGETBOX.urls[H].replace("http://","https://");}}}if(window.WIDGETBOXLOADLISTENERS){for(H=0;H<WIDGETBOXLOADLISTENERS.length;H++){A.addPageLoadListener(WIDGETBOXLOADLISTENERS[H]);}}A.addEvent(window,"load",C);A.addEvent(window,"unload",B);if(window.WIDGETBOXINITLISTENERS){for(H=0;H<WIDGETBOXINITLISTENERS.length;H++){try{WIDGETBOXINITLISTENERS[H]();}catch(J){WIDGETBOX.logMessage(J);}}}try{var K=new RegExp("[A-Za-z]+:[/][/][A-Za-z0-9.-]+");var G=window.document.referrer;if(G){G=G.toLowerCase();}var I=window.location.href;if(I){I=I.toLowerCase();}var M=G.match(K);var F=(M&&M[0])||G;var L=I.match(K);var E=(L&&L[0])||I;WIDGETBOX.globals.isTopAccessible=A==top||!E||E=="about:blank"||F==E;}catch(J){WIDGETBOX.logMessage(J);}}},namespace:function(G){G=G.replace(".","/");if(G.indexOf("WIDGETBOX/")===0){G=G.substr(10);}if(G.indexOf("POSTAPP/")===0){G=G.substr(8);}var E=G.split("/");var I=WIDGETBOX;if(E){var H;for(var F=0;F<E.length;F++){H=E[F];if(!I[H]){I[H]={};}I=I[H];}}return G;},logMessage:function(E){if(A.globals.enableLogging){A.globals.log+=E+"\n";}},newLibInfo:function(G){G=G.replace(".","/");var J=G;var H="";var F=G.lastIndexOf("/");if(F>=0){H=G.substr(0,F);J=G.substr(F+1);}H=A.namespace(H);G=H+"/"+J;var I=G.replace("/","_").toLowerCase();var E={ns:H,name:J,path:G,id:I,status:null,callback:null};return E;},load:function(G,F,H){var E=A.newLibInfo(G);if(!WIDGETBOX.libs[E.id]){WIDGETBOX.libs[E.id]=E;E.status="loading";if(F){if(!E.listeners){E.listeners=[];}E.listeners.push(F);}A.appendScript(((!H)?WIDGETBOX.urls.runtimeBaseUrl:WIDGETBOX.urls.cdnRuntimeBaseUrl)+"/"+E.path+".js?"+WIDGETBOX.version,"widgetbox_lib_"+E.id,"true");}else{E=WIDGETBOX.libs[E.id];if(F){if(E.status=="ready"){try{F(E);}catch(I){WIDGETBOX.logMessage(I);}}else{if(!E.listeners){E.listeners=[];}E.listeners.push(F);}}}},ready:function(F){var E=A.newLibInfo(F);if(!WIDGETBOX.libs[E.id]){WIDGETBOX.libs[E.id]=E;}E=WIDGETBOX.libs[E.id];return E.status=="ready";},setReady:function(G){var F=A.newLibInfo(G);if(!WIDGETBOX.libs[F.id]){WIDGETBOX.libs[F.id]=F;}F=WIDGETBOX.libs[F.id];F.status="ready";if(F.listeners){var E=0;for(E=0;E<F.listeners.length;E++){var H=F.listeners[E];try{H(F);}catch(I){WIDGETBOX.logMessage(I);}}}},appendScript:function(G,J,I,E){var F=document.createElement("script");F.id=J;F.type="text/javascript";if(I&&I!="false"){F.setAttribute("async",I);}if(E){F.onreadystatechange=function(){if(this.readyState=="complete"){E();}};F.onload=E;}F.src=G;var H=document.documentElement.firstChild;if(!H||(H.nodeName&&(H.nodeName.toLowerCase().indexOf("comment")>-1||H.nodeName.toLowerCase().indexOf("script")>-1))){H=document.getElementsByTagName("head")[0];}H.appendChild(F);},addEvent:function(I,H,F,E){if(!I){return ;}if(I.addEventListener){I.addEventListener(H,F,E);return true;}else{if(I.attachEvent){var G=I.attachEvent("on"+H,F);return G;}}},removeEvent:function(H,G,F,E){if(!H){return ;}if(H.removeEventListener){H.removeEventListener(G,F,E);return true;}else{if(H.detachEvent){return H.detachEvent("on"+G,F);}}},addEventListener:function(E,G){if(G){if(!A.globals.eventListeners){A.globals.eventListeners={};}if(!A.globals.eventListeners[E]){A.globals.eventListeners[E]=[];}var F=A.globals.eventListeners[E];F[F.length]=G;}},notifyEventListeners:function(F){if(!A.globals.eventListeners){return ;}var G=A.globals.eventListeners[F];if(!G){return ;}for(var E=0;E<G.length;E++){var H=G[E];try{H(this);}catch(I){WIDGETBOX.logMessage(I);}}},addPageLoadListener:function(E){if(E){if(!A.globals.pageLoaded){A.globals.pageLoadListeners.push(E);}else{try{E();}catch(F){WIDGETBOX.logMessage(F);}}}},addPageUnloadListener:function(E){if(E){if(!A.globals.pageUnloaded){A.globals.pageUnloadListeners.push(E);}else{try{E();}catch(F){WIDGETBOX.logMessage(F);}}}},setPageLoaded:function(){if(A.globals.pageLoaded){return ;}A.globals.pageLoaded=true;A.removeEvent(window,"load",C);var F=A.globals.pageLoadListeners;var E;for(E=0;E<F.length;E++){try{F[E]();}catch(G){WIDGETBOX.logMessage(G);}}},setPageUnloaded:function(){if(A.globals.pageUnloaded){return ;}A.globals.pageUnloaded=true;A.removeEvent(window,"unload",B);var E=A.globals.pageUnloadListeners;for(i=0;i<E.length;i++){try{E[i]();}catch(F){WIDGETBOX.logMessage(F);}}},generateGUID:function(H,E){var I=(H)?H:Math.random;var K=(E)?36:32,M="0123456789abcdef".split(""),F,G=[];if(E){G[8]=G[13]=G[18]=G[23]="-";G[14]="4";}for(var J=0;J<K;J++){if(!G[J]){F=0|I()*16;G[J]=M[(J==19)?(F&3)|8:F];}}var L=G.join("");if(!WIDGETBOX.globals.vid){WIDGETBOX.globals.vid=L;}return L;},generateProxiedImageUrl:function(E,H,G,F){var I=E;I=this.urls.imageProxyBaseUrl+"/ip/origin=="+encodeURIComponent(I);if(H){I+="&&w=="+Math.round(H);}if(G){I+="&&h=="+Math.round(G);}if(F){I+="&&type=="+F;}I+="?token="+WIDGETBOX.globals.token;return I;},createElement:function(F,E){if(E){return E.ownerDocument.createElement(F);}else{return document.createElement(F);}},isType:function(E,F){var G=Object.prototype.toString.call(F).slice(8,-1);return F!==undefined&&F!==null&&G===E;},extend:function(F,E){for(var G in E){F[G]=E[G];}return F;}};POSTAPP=WIDGETBOX;var A=WIDGETBOX;A.init();})();}WIDGETBOX.namespace("random");if(!WIDGETBOX.random.Utils){(function(){WIDGETBOX.random.Utils={seedData:null,seeded:false,random:function(){if(!WIDGETBOX.random.Utils.seeded){(function(J,K,D,I,M,G,C){K.seedrandom=function H(N,R){var Q=[];var O;var T=new Date();var P=T.getTime();var S=B(R?[N,J]:(arguments.length?N:[P,J,window]),3);N=L(S,Q);WIDGETBOX.random.Utils.seedData='{t:"'+P+'"}';O=new F(Q);L(O.S,J);K.betterRandom=function U(){var X=O.g(I);var W=C;var V=0;while(X<M){X=(X+V)*D;W*=D;V=O.g(1);}while(X>=G){X/=2;W/=2;V>>>=1;}return(X+V)/W;};return N;};function F(S){var R,P,U=this,T=S.length;var Q=0,O=U.i=U.j=U.m=0;U.S=[];U.c=[];if(!T){S=[T++];}while(Q<D){U.S[Q]=Q++;}for(Q=0;Q<D;Q++){R=U.S[Q];O=E(O+R+S[Q%T]);P=U.S[O];U.S[Q]=P;U.S[O]=R;}U.g=function N(b){var Z=U.S;var Y=E(U.i+1);var X=Z[Y];var W=E(U.j+X);var V=Z[W];Z[Y]=V;Z[W]=X;var a=Z[E(X+V)];while(--b){Y=E(Y+1);X=Z[Y];W=E(W+X);V=Z[W];Z[Y]=V;Z[W]=X;a=a*D+Z[E(X+V)];}U.i=Y;U.j=W;return a;};U.g(D);}function B(P,Q,N,R){N=[];if(Q&&typeof (P)=="object"){for(R in P){if(R.indexOf("S")<5){try{N.push(B(P[R],Q-1));}catch(O){}}}}return N.length?N:""+P;}function L(N,P,Q,O){N+="";Q=0;for(O=0;O<N.length;O++){P[E(O)]=E((Q^=P[E(O)]*19)+N.charCodeAt(O));}N="";for(O in P){N+=String.fromCharCode(P[O]);}return N;}function E(N){return N&(D-1);}C=K.pow(D,I);M=K.pow(2,M);G=M*2;L(K.random(),J);})([],Math,256,6,52);Math.seedrandom();WIDGETBOX.random.Utils.seeded=true;}var A=Math.betterRandom();return A;}};})();}WIDGETBOX.namespace("flash");if(!WIDGETBOX.flash.Utils){(function(){var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;WIDGETBOX.flash.Utils={isIE:function(){return isIE;},isWin:function(){return isWin;},isOpera:function(){return isOpera;},getMovie:function(movieName){if(isIE){return window[movieName];}else{return document[movieName];}},destroyMovie:function(flashTag){if(flashTag){var doc=flashTag.ownerDocument;if(doc&&WIDGETBOX.flash.Utils.isIE){var proxyEl=doc.createElement("div");proxyEl.id=flashTag.id;proxyEl.style.position="absolute";proxyEl.style.display="none";proxyEl.style.bottom="0px";proxyEl.style.left="0px";proxyEl.SetReturnValue=function(v){};doc.body.appendChild(proxyEl);setTimeout(function(){doc.body.removeChild(proxyEl);},1000);}if(flashTag.parentNode){flashTag.parentNode.removeChild(flashTag);}}},getParamValue:function(flashTag,paramName){var pValue="";if(flashTag){if(flashTag.nodeName=="OBJECT"){for(var i=0;i<flashTag.childNodes.length;i++){var paramNode=flashTag.childNodes[i];if(paramNode&&paramNode.nodeName=="PARAM"){var pName=paramNode.getAttribute("name");if(pName&&pName.toLowerCase()==paramName){var paramValue=paramNode.getAttribute("value");if(paramValue){pValue=paramValue.toLowerCase();}}}}}else{var paramValue=flashTag.getAttribute(paramName);if(paramValue){pValue=paramValue.toLowerCase();}}}return pValue;}};function ControlVersion(){var version;var axo;var e;try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");version=axo.GetVariable("$version");}catch(e){}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");version="WIN 6,0,21,0";axo.AllowScriptAccess="always";version=axo.GetVariable("$version");}catch(e){}}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");version=axo.GetVariable("$version");}catch(e){}}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");version="WIN 3,0,18,0";}catch(e){}}if(!version){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");version="WIN 2,0,0,11";}catch(e){version=-1;}}return version;}function GetSwfVer(){var flashVer=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var swVer2=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var flashDescription=navigator.plugins["Shockwave Flash"+swVer2].description;var descArray=flashDescription.split(" ");var tempArrayMajor=descArray[2].split(".");var versionMajor=tempArrayMajor[0];var versionMinor=tempArrayMajor[1];if(descArray[3]!=""){tempArrayMinor=descArray[3].split("r");}else{tempArrayMinor=descArray[4].split("r");}var versionRevision=tempArrayMinor[1]>0?tempArrayMinor[1]:0;var flashVer=versionMajor+"."+versionMinor+"."+versionRevision;}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){flashVer=4;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){flashVer=3;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){flashVer=2;}else{if(isIE&&isWin&&!isOpera){flashVer=ControlVersion();}}}}}return flashVer;}function DetectFlashVer(reqMajorVer,reqMinorVer,reqRevision){versionStr=GetSwfVer();if(versionStr==-1){return false;}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",");}else{versionArray=versionStr.split(".");}var versionMajor=versionArray[0];var versionMinor=versionArray[1];var versionRevision=versionArray[2];var ua=navigator.userAgent.toLowerCase();if(isWin&&versionMajor==8){try{if(ua.indexOf("firefox/3.0")>=0||(!isIE&&window!=window.top)){return false;}}catch(e){return false;}}if(WIDGETBOX.globals&&WIDGETBOX.globals.flashBlacklist){for(var i=0;i<WIDGETBOX.globals.flashBlacklist.length;i++){var userAgent=WIDGETBOX.globals.flashBlacklist[i].userAgent;if(userAgent&&ua.match(userAgent)){var rule=WIDGETBOX.globals.flashBlacklist[i].rule;if(rule){if(rule.indexOf("*")==0){return false;}else{if(rule.indexOf("==")==0){if(versionMajor==parseFloat(rule.substr(2))){return false;}}else{if(rule.indexOf("!=")==0){if(versionMajor!=parseFloat(rule.substr(2))){return false;}}else{if(rule.indexOf("<=")==0){if(versionMajor<=parseFloat(rule.substr(2))){return false;}}else{if(rule.indexOf(">=")==0){if(versionMajor>=parseFloat(rule.substr(2))){return false;}}else{if(rule.indexOf("<")==0){if(versionMajor<parseFloat(rule.substr(1))){return false;}}else{if(rule.indexOf(">")==0){if(versionMajor>parseFloat(rule.substr(1))){return false;}}}}}}}}}}}}if(versionMajor>parseFloat(reqMajorVer)){return true;}else{if(versionMajor==parseFloat(reqMajorVer)){if(versionMinor>parseFloat(reqMinorVer)){return true;}else{if(versionMinor==parseFloat(reqMinorVer)){if(versionRevision>=parseFloat(reqRevision)){return true;}}}}}return false;}}}function GetFlashVersionArray(){var version=[];version[0]=-1;version[1]=-1;version[2]=-1;var versionStr=GetSwfVer();if(isNaN(versionStr)){if(isIE){var versionParts=versionStr.split(" ");if(versionParts.length==2){versionParts=versionParts[1].split(",");if(versionParts.length==4){version[0]=parseInt(versionParts[0]);version[1]=parseInt(versionParts[1]);version[2]=parseInt(versionParts[2]);}}}else{var versionParts=versionStr.split(".");if(versionParts.length==3){version[0]=parseInt(versionParts[0]);version[1]=parseInt(versionParts[1]);version[2]=parseInt(versionParts[2]);}}}return version;}function Exception(name,message){if(name){this.name=name;}if(message){this.message=message;}}Exception.prototype.setName=function(name){this.name=name;};Exception.prototype.getName=function(){return this.name;};Exception.prototype.setMessage=function(msg){this.message=msg;};Exception.prototype.getMessage=function(){return this.message;};function FlashTag(src,width,height,version){if(arguments.length<4){throw new Exception("RequiredParameterException","You must pass in a src, width, height, and version when creating a FlashTag.");}this.src=src;this.width=width;this.height=height;this.version=version;this.id=null;this.flashVars=null;this.flashVarsStr=null;this.genericParam={};this.ie=(navigator.appName.indexOf("Microsoft")!=-1)?1:0;this.enableFSCommand=false;}FlashTag.prototype.setSource=function(src){this.src=src;};FlashTag.prototype.setWidth=function(w){this.width=w;};FlashTag.prototype.setHeight=function(h){this.height=h;};FlashTag.prototype.setVersion=function(v){this.version=v;};FlashTag.prototype.setId=function(id){this.id=id;};FlashTag.prototype.setBgcolor=function(bgc){if(bgc.charAt(0)!="#"){bgc="#"+bgc;}this.genericParam.bgcolor=bgc;};FlashTag.prototype.addParams=function(params){for(var paramName in params){var paramValue=params[paramName];this.genericParam[paramName]=paramValue;}};FlashTag.prototype.addFlashVars=function(fvs){this.flashVarsStr=fvs;};FlashTag.prototype.addFlashVarsParams=function(params){if(!this.flashVars){this.flashVars={};}for(var paramName in params){var paramValue=params[paramName];this.flashVars[paramName]=paramValue;}};FlashTag.prototype.addFlashVar=function(n,v){if(!this.flashVars){this.flashVars={};}this.flashVars[n]=v;};FlashTag.prototype.removeFlashVar=function(n){if(this.flashVars){this.flashVars[n]=null;}};FlashTag.prototype.setSwliveconnect=function(swlc){this.genericParam.swliveconnect=swlc;};FlashTag.prototype.setPlay=function(p){this.genericParam.play=p;};FlashTag.prototype.setLoop=function(l){this.genericParam.loop=l;};FlashTag.prototype.setMenu=function(m){this.genericParam.menu=m;};FlashTag.prototype.setQuality=function(q){if(q!="low"&&q!="high"&&q!="autolow"&&q!="autohigh"&&q!="best"){throw new Exception("UnsupportedValueException",'Supported values are "low", "high", "autolow", "autohigh", and "best".');}this.genericParam.quality=q;};FlashTag.prototype.setScale=function(sc){if(sc!="showall"&&sc!="noborder"&&sc!="exactfit"&&sc!="noscale"){throw new Exception("UnsupportedValueException",'Supported values are "showall", "noborder", and "exactfit".');}this.genericParam.scale=sc;};FlashTag.prototype.setAlign=function(a){if(a!="l"&&a!="t"&&a!="r"&&a!="b"){throw new Exception("UnsupportedValueException",'Supported values are "l", "t", "r" and "b".');}this.genericParam.align=a;};FlashTag.prototype.setSalign=function(sa){if(sa!="l"&&sa!="t"&&sa!="r"&&sa!="b"&&sa!="tl"&&sa!="tr"&&sa!="bl"&&sa!="br"){throw new Exception("UnsupportedValueException",'Supported values are "l", "t", "r", "b", "tl", "tr", "bl" and "br".');}this.genericParam.salign=sa;};FlashTag.prototype.setWmode=function(wm){if(wm!="window"&&wm!="opaque"&&wm!="transparent"){throw new Exception("UnsupportedValueException",'Supported values are "window", "opaque", and "transparent".');}this.genericParam.wmode=wm;};FlashTag.prototype.setBase=function(base){this.genericParam.base=base;};FlashTag.prototype.setAllowScriptAccess=function(sa){if(sa!="never"&&sa!="always"&&sa!="sameDomain"){throw new Exception("UnsupportedValueException",'Supported values are "never" and "always", and "sameDomain".');}this.genericParam.allowScriptAccess=sa;};FlashTag.prototype.setAllowNetworking=function(na){if(na!="all"&&na!="internal"&&na!="none"){throw new Exception("UnsupportedValueException",'Supported values are "all", "internal", and "none".');}this.genericParam.allowNetworking=na;};FlashTag.prototype.setEnableFSCommand=function(enableFSCommand){this.enableFSCommand=enableFSCommand;};FlashTag.prototype.toString=function(){var flashTag=new String();if(this.ie){flashTag+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ';if(this.id){flashTag+='id="'+this.id+'" ';}flashTag+='codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version='+this.version+'" ';if(String(this.width).indexOf("%")>=0||this.width>=0){flashTag+='width="'+this.width+'" ';flashTag+='height="'+this.height+'"';}flashTag+=">";flashTag+='<param name="movie" value="'+this.src+'"/>';var wmodeExists=false;for(var n in this.genericParam){if(this.genericParam[n]){if(n.toLowerCase()=="wmode"&&WIDGETBOX.globals.wmodeOverride){if(WIDGETBOX.globals.wmodeOverride.toLowerCase()=="best"){if(this.genericParam[n].toLowerCase()=="opaque"||this.genericParam[n].toLowerCase()=="window"){flashTag+='<param name="wmode" value="opaque"/>';}else{flashTag+='<param name="wmode" value="transparent"/>';}}else{flashTag+='<param name="wmode" value="'+WIDGETBOX.globals.wmodeOverride.toLowerCase()+'"/>';}wmodeExists=true;}else{if(n.toLowerCase()=="wmode"){wmodeExists=true;}flashTag+='<param name="'+n+'" value="'+this.genericParam[n]+'"/>';}}}if(!wmodeExists&&WIDGETBOX.globals.wmodeOverride){if(WIDGETBOX.globals.wmodeOverride.toLowerCase()=="best"){flashTag+='<param name="wmode" value="opaque"/>';}else{flashTag+='<param name="wmode" value="'+WIDGETBOX.globals.wmodeOverride.toLowerCase()+'"/>';}wmodeExists=true;}if(this.flashVars||this.flashVarsStr){var fv=this.getFlashVarsAsString();if(fv.length>0){flashTag+='<param name="flashvars" value="'+fv+'"/>';}}flashTag+="</object>";if(this.enableFSCommand&&navigator.platform.indexOf("Win")!=-1&&navigator.userAgent.indexOf("Opera")==-1){flashTag+='<script event="FSCommand(command,args)" for="'+this.id+'">\nFlashProxy.callJS(command, args);\n<\/script>';}}else{flashTag+='<embed src="'+this.src+'"';if(String(this.width).indexOf("%")>=0||this.width>=0){flashTag+=' width="'+this.width+'"';flashTag+=' height="'+this.height+'"';}flashTag+=' type="application/x-shockwave-flash"';if(this.id){flashTag+=' id="'+this.id+'"';flashTag+=' name="'+this.id+'"';}var wmodeExists=false;for(var n in this.genericParam){if(this.genericParam[n]){if(n.toLowerCase()=="wmode"&&WIDGETBOX.globals.wmodeOverride){if(WIDGETBOX.globals.wmodeOverride.toLowerCase()=="best"){if(this.genericParam[n].toLowerCase()=="opaque"||this.genericParam[n].toLowerCase()=="window"){flashTag+=(' wmode="opaque"');}else{flashTag+=(' wmode="transparent"');}}else{flashTag+=(' wmode="'+WIDGETBOX.globals.wmodeOverride.toLowerCase()+'"');}wmodeExists=true;}else{if(n.toLowerCase()=="wmode"){wmodeExists=true;}flashTag+=(" "+n+'="'+this.genericParam[n]+'"');}}}if(!wmodeExists&&WIDGETBOX.globals.wmodeOverride){if(WIDGETBOX.globals.wmodeOverride.toLowerCase()=="best"){flashTag+=(' wmode="opaque"');}else{flashTag+=(' wmode="'+WIDGETBOX.globals.wmodeOverride.toLowerCase()+'"');}wmodeExists=true;}if(this.flashVars||this.flashVarsStr){var fv=this.getFlashVarsAsString();if(fv.length>0){flashTag+=' flashvars="'+fv+'"';}}flashTag+=' pluginspage="http://www.macromedia.com/go/getflashplayer">';flashTag+="</embed>";}return flashTag;};FlashTag.prototype.write=function(doc){if(!doc){doc=document;}doc.write(this.toString());};FlashTag.prototype.getElement=function(doc){if(!doc){doc=document;}var tempDiv=doc.createElement("div");tempDiv.innerHTML=this.toString();return(tempDiv.children&&tempDiv.children.length>0)?tempDiv.children[0]:null;};FlashTag.prototype.getFlashVarsAsString=function(){var qs=new String();for(var n in this.flashVars){if(this.flashVars[n]!==undefined&&this.flashVars[n]!==null){qs+=(encodeURIComponent(n)+"="+encodeURIComponent(this.flashVars[n])+"&");}}if(this.flashVarsStr){return qs+this.flashVarsStr;}return qs.substring(0,qs.length-1);};function FlashSerializer(useCdata){this.useCdata=useCdata;}FlashSerializer.prototype.serialize=function(args){var qs=new String();for(var i=0;i<args.length;++i){switch(typeof (args[i])){case"undefined":qs+="t"+(i)+"=undf";break;case"string":qs+="t"+(i)+"=str&d"+(i)+"="+escape(args[i]);break;case"number":qs+="t"+(i)+"=num&d"+(i)+"="+escape(args[i]);break;case"boolean":qs+="t"+(i)+"=bool&d"+(i)+"="+escape(args[i]);break;case"object":if(!args[i]){qs+="t"+(i)+"=null";}else{if(args[i] instanceof Date){qs+="t"+(i)+"=date&d"+(i)+"="+escape(args[i].getTime());}else{try{qs+="t"+(i)+"=xser&d"+(i)+"="+escape(this._serializeXML(args[i]));}catch(exception){throw new Exception("FlashSerializationException","The following error occurred during complex object serialization: "+exception.getMessage());}}}break;default:throw new Exception("FlashSerializationException","You can only serialize strings, numbers, booleans, dates, objects, arrays, nulls, and undefined.");}if(i!=(args.length-1)){qs+="&";}}return qs;};FlashSerializer.prototype._serializeXML=function(obj){var doc={};doc.xml="<fp>";try{this._serializeNode(obj,doc,null);}catch(exception){if(exception.message){throw new Exception("FlashSerializationException","Unable to serialize object because: "+exception.message);}throw exception;}doc.xml+="</fp>";return doc.xml;};FlashSerializer.prototype._serializeNode=function(obj,doc,name){switch(typeof (obj)){case"undefined":doc.xml+="<undf"+this._addName(name)+"/>";break;case"string":doc.xml+="<str"+this._addName(name)+">"+this._escapeXml(obj)+"</str>";break;case"number":doc.xml+="<num"+this._addName(name)+">"+obj+"</num>";break;case"boolean":doc.xml+="<bool"+this._addName(name)+' val="'+obj+'"/>';break;case"object":if(!obj){doc.xml+="<null"+this._addName(name)+"/>";}else{if(obj instanceof Date){doc.xml+="<date"+this._addName(name)+">"+obj.getTime()+"</date>";}else{if(obj instanceof Array){doc.xml+="<array"+this._addName(name)+">";for(var i=0;i<obj.length;++i){this._serializeNode(obj[i],doc,null);}doc.xml+="</array>";}else{doc.xml+="<obj"+this._addName(name)+">";for(var n in obj){if(typeof (obj[n])=="function"){continue;}this._serializeNode(obj[n],doc,n);}doc.xml+="</obj>";}}}break;default:throw new Exception("FlashSerializationException","You can only serialize strings, numbers, booleans, objects, dates, arrays, nulls and undefined");break;}};FlashSerializer.prototype._addName=function(name){if(name){return' name="'+name+'"';}return"";};FlashSerializer.prototype._escapeXml=function(str){if(this.useCdata){return"<![CDATA["+str+"]]>";}else{return str.replace(/&/g,"&amp;").replace(/</g,"&lt;");}};function FlashProxy(lcId,flashId,proxySwfName,callbackScope){FlashProxy.fpmap[lcId]=this;this.uid=lcId;this.proxySwfName=proxySwfName;this.callbackScope=callbackScope;this.flashSerializer=new FlashSerializer(false);this.q=[];}FlashProxy.prototype.call=function(){if(arguments.length==0){throw new Exception("Flash Proxy Exception","The first argument should be the function name followed by any number of additional arguments.");}this.q.push(arguments);if(this.q.length==1){this._execute(arguments);}};FlashProxy.prototype._execute=function(args){var ft=new FlashTag(this.proxySwfName,1,1,"6,0,65,0");ft.addFlashVar("lcId",this.uid);ft.addFlashVar("functionName",args[0]);if(args.length>1){var justArgs=[];for(var i=1;i<args.length;++i){justArgs.push(args[i]);}ft.addFlashVars(this.flashSerializer.serialize(justArgs));}var divName="_flash_proxy_"+this.uid;if(!document.getElementById(divName)){var newTarget=document.createElement("div");newTarget.id=divName;document.body.appendChild(newTarget);}var target=document.getElementById(divName);target.innerHTML=ft.toString();};FlashProxy.callJS=function(command,args){var argsArray=eval(args);var fp=FlashProxy.fpmap[argsArray.shift()];var scope=null;if(fp){scope=fp.callbackScope;}if(scope&&(command.indexOf(".")<0)){var functionToCall=scope[command];functionToCall.apply(scope,argsArray);}else{var functionToCall=eval(command);functionToCall.apply(functionToCall,argsArray);}};FlashProxy.callComplete=function(uid){var fp=FlashProxy.fpmap[uid];if(fp){fp.q.shift();if(fp.q.length>0){fp._execute(fp.q[0]);}}};FlashProxy.fpmap={};WIDGETBOX.flash.Utils.GetSwfVer=GetSwfVer;WIDGETBOX.flash.Utils.DetectFlashVer=DetectFlashVer;WIDGETBOX.flash.Utils.GetFlashVersionArray=GetFlashVersionArray;WIDGETBOX.flash.Utils.FlashTag=FlashTag;WIDGETBOX.flash.Utils.FlashSerializer=FlashSerializer;WIDGETBOX.flash.Utils.FlashProxy=FlashProxy;window.FlashProxy=FlashProxy;WIDGETBOX.setReady("flash.Utils");})();}WIDGETBOX.namespace("flash");if(!WIDGETBOX.flash.Helper){(function(){var F=false;var D=false;var C=false;var E={};var H=null;var G=[];var B=false;WIDGETBOX.flash.Helper={init:function(){if(!F){F=true;B=WIDGETBOX.flash.Utils.DetectFlashVer(8,0,0);}},addStartListener:function(I){if(I){if(!C){G[G.length]=I;}else{try{I();}catch(J){WIDGETBOX.logMessage(J);}}}},startHelper:function(K,N,I,J){if(D&&C){try{I();}catch(Q){WIDGETBOX.logMessage(Q);}return ;}A.addStartListener(I);if(!D){D=true;H="widgetbox_jsproxy_"+N;var L=WIDGETBOX.urls.cdnRuntimeBaseUrl+"/flash/v6/Helper.swf?cb="+WIDGETBOX.version;var R="6,0,65,0";if(B){L=WIDGETBOX.urls.cdnRuntimeBaseUrl+"/flash/v8/Helper.swf?cb="+WIDGETBOX.version;R="8,0,0,0";}var M=new WIDGETBOX.flash.Utils.FlashTag(L,1,1,R);M.addFlashVar("token",K);M.addFlashVar("widgetId",N);M.setId(H);M.setAllowScriptAccess("always");M.setAllowNetworking("all");M.setWmode("transparent");if(!B){M.setEnableFSCommand(true);}var O="widgetbox_helper_div_"+K;if(document.body){var P=document.getElementById(O);if(!P){P=document.createElement("div");P.id=O;P.style.position="absolute";P.style.left="0";P.style.top="0";if(WIDGETBOX.globals.firstParentNode){WIDGETBOX.globals.firstParentNode.parentNode.appendChild(P);}else{document.body.appendChild(P);}}P.innerHTML=M.toString();}else{document.write('<div id="'+O+'">'+M.toString()+"</div>");}}},setHelperStarted:function(){if(!C){C=true;for(var I=0;I<G.length;I++){var J=G[I];try{J();}catch(K){WIDGETBOX.logMessage(K);}}}},isHelperStarted:function(){return C;},sendMessage:function(L,M,P,I){if(C){if(B){var J=document.getElementById(H);if(J){J.sendMessage(L,M,P,I);}}else{var O="jsproxy_"+L+"_"+M;var K="widgetbox_jsproxy_"+M;var N=new FlashProxy(O,K,WIDGETBOX.urls.cdnRuntimeBaseUrl+"/flash/v6/JavaScriptFlashGateway.swf",null);N.call("sendMessage",L,M,P,I);}}},setMessageHandler:function(J,I){E[J]=I;},messageListener:function(L,I){var J=E[L];if(J){try{J(I);}catch(K){WIDGETBOX.logMessage(K);}}else{}}};var A=WIDGETBOX.flash.Helper;A.init();WIDGETBOX.setReady("flash.Helper");})();}WIDGETBOX.namespace("message");if(!WIDGETBOX.message.Helper){(function(){var D=false;var H=false;var F=false;var A={};var B=null;var G=false;var C=false;var E;var I="wbx_jg986gikek";WIDGETBOX.message.Helper={supported:function(){var L=navigator.userAgent.toLowerCase();var K=(L.indexOf("opera")>-1),M=(!K&&L.indexOf("msie")>-1);return !M&&typeof window.postMessage!=="undefined"&&typeof JSON!=="undefined";},init:function(){if(J.supported()){if(typeof window.addEventListener!=="undefined"){window.addEventListener("message",J.handleMessage,false);D=true;}else{if(typeof window.attachEvent!=="undefined"){window.attachEvent("onmessage",J.handleMessage);D=true;}}}},startHelper:function(K,L,M){if(!E){E=window.parent;}try{M();}catch(N){WIDGETBOX.logMessage(N);}},handleMessage:function(M){var L=J.getWbxMessage(M);if(L){var K=A[L.msgName];if(K){try{K(L.msgPayload);}catch(N){WIDGETBOX.logMessage(N);}}}},getWbxMessage:function(L){var N=null;try{if(L.data[0]==="{"){var K=JSON.parse(L.data);if(K.wbx===I){N=K;}}}catch(M){}return N;},sendMessage:function(L,M,O,K){if(D){try{E.postMessage(JSON.stringify({wbx:I,token:L,widgetId:M,msgName:O,msgPayload:K}),"*");}catch(N){}}},setMessageHandler:function(L,K){A[L]=K;}};var J=WIDGETBOX.message.Helper;J.init();WIDGETBOX.setReady("message.Helper");})();}WIDGETBOX.namespace("behaviour");if(!WIDGETBOX.behaviour.Behaviour){(function(){var B=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var C={list:[],register:function(D){A.list.push(D);},start:function(){A.addLoadEvent(function(){A.apply();});},apply:function(){for(var H=0;H<A.list.length;H++){var G=A.list[H];for(var D in G){var I=A.getElementsBySelector(D);if(!I){continue;}for(var F=0;F<I.length;F++){var E=I[F];try{G[D](E);}catch(J){WIDGETBOX.logMessage(J);}}}}},addLoadEvent:function(D){WIDGETBOX.addPageLoadListener(D);},getAllChildren:function(D){return D.all?D.all:D.getElementsByTagName("*");},getElementsBySelector:function(V){if(!document.getElementsByTagName){return[];}var O=V.split(" ");var I=new Array(document);for(var X=0;X<O.length;X++){token=O[X].replace(/^\s+/,"").replace(/\s+$/,"");if(token.indexOf("#")>-1){var S=token.split("#");var G=S[0];var Q=S[1];var E=document.getElementById(Q);if(G&&E.nodeName.toLowerCase()!=G){return[];}I=new Array(E);continue;}if(token.indexOf(".")>-1){var S=token.split(".");var G=S[0];var F=S[1];if(!G){G="*";}var L=new Array;var J=0;for(var Y=0;Y<I.length;Y++){var M;if(G=="*"){M=A.getAllChildren(I[Y]);}else{M=A.getElementsByTagName(I[Y],G);}for(var U=0;U<M.length;U++){L[J++]=M[U];}}I=new Array;var P=0;for(var T=0;T<L.length;T++){if(L[T].className){var K=L[T].className.split(" ");for(var R=0;R<K.length;R++){if(K[R]==F){I[P++]=L[T];}}}}continue;}if(token.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var G=RegExp.$1;var W=RegExp.$2;var D=RegExp.$3;var N=RegExp.$4;if(!G){G="*";}var L=new Array;var J=0;for(var Y=0;Y<I.length;Y++){var M;if(G=="*"){M=A.getAllChildren(I[Y]);}else{M=A.getElementsByTagName(I[Y],G);}for(var U=0;U<M.length;U++){L[J++]=M[U];}}I=new Array;var P=0;var H;switch(D){case"=":if(B&&W=="class"){H=function(Z){return(Z.className==N);};}else{H=function(Z){return(Z.getAttribute(W)==N);};}break;case"~":H=function(Z){return(Z.getAttribute(W).match(new RegExp("\b"+N+"\b")));};break;case"|":H=function(Z){return(Z.getAttribute(W).match(new RegExp("^"+N+"-?")));};break;case"^":H=function(Z){return(Z.getAttribute(W).indexOf(N)==0);};break;case"$":H=function(Z){return(Z.getAttribute(W).lastIndexOf(N)==Z.getAttribute(W).length-N.length);};break;case"*":H=function(Z){return(Z.getAttribute(W).indexOf(N)>-1);};break;default:H=function(Z){return Z.getAttribute(W);};}I=new Array;var P=0;for(var T=0;T<L.length;T++){if(H(L[T])){I[P++]=L[T];}}continue;}if(!I[0]){return ;}G=token;var L=new Array;var J=0;for(var Y=0;Y<I.length;Y++){var M=A.getElementsByTagName(I[Y],G);for(var U=0;U<M.length;U++){L[J++]=M[U];}}I=L;}return I;},getElementsByTagName:function(D,F){if(F.indexOf(":")>-1){var G=F.split(":");var E=G[0];F=G[1];return A.getElementsByTagNameNS(D,E,F);}else{return D.getElementsByTagName(F);}},getElementsByTagNameNS:function(F,H,J){if(B){var K=F.getElementsByTagName(J);var E=[];for(var G=0;G<K.length;G++){var I=K[G];var D=I.scopeName;if(D){D=D.toLowerCase();}if(D==H){E[E.length]=I;}}return E;}else{return F.getElementsByTagName(H+":"+J);}},getInnerText:function(E){if(typeof E.textContent!="undefined"){return E.textContent;}else{if(typeof E.innerText!="undefined"){return E.innerText;}else{if(typeof E.text!="undefined"){return E.text;}else{switch(E.nodeType){case 3:case 4:return E.nodeValue;break;case 1:case 11:var F="";for(var D=0;D<E.childNodes.length;D++){F+=getInnerText(E.childNodes[D]);}return F;break;default:return"";}}}}}};var A=C;WIDGETBOX.behaviour.Behaviour=C;WIDGETBOX.setReady("behaviour.Behaviour");})();}WIDGETBOX.namespace("net");if(!WIDGETBOX.net.Utils){(function(){var B=0;WIDGETBOX.net.Utils={newTimestamp:function(){var C=(new Date()).getTime();if(C==B){C++;}B=C;return C;},createXMLHttpRequest:function(){try{return new ActiveXObject("Msxml2.XMLHTTP");}catch(C){}try{return new ActiveXObject("Microsoft.XMLHTTP");}catch(C){}try{return new XMLHttpRequest();}catch(C){}alert("XMLHttpRequest not supported");return null;},urlEncode:function(C){if(!C){return C;}return encodeURIComponent(C).replace(/\~/g,"%7E").replace(/\!/g,"%21").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\'/g,"%27");},newURLWithParams:function(E,K,F,J,C){var I="";var O="";var P="";if(F){for(var N in F){var G=F[N];var D=C?[C,N].join("."):N;E+=[P,A.urlEncode(D),"==",A.urlEncode(G)].join("");P="&&";}}if(K){for(var M in K){var H=K[M];var L=J?[J,M].join("."):M;I+=[O,A.urlEncode(L),"=",A.urlEncode(H)].join("");O="&";}if(I.length>0){var Q=E.charAt(E.length-1);if(E.indexOf("?")<0){E+="?";}else{if((Q!="&")&&(Q!="?")){E+="&";}}E+=I;}}return E;},addParameter:function(C,F,E){var D=C?(C+(C.indexOf("?")>-1?"&":"?")):"";return D+F+"="+encodeURIComponent(E);},addParameters:function(E,D){for(var C in D){E=WIDGETBOX.net.Utils.addParameter(E,C,D[C]);}return E;},sendPost:function(C,G,E){var F="wbx-poster";var D=document.getElementById(F);if(D&&D.parentNode){D.parentNode.removeChild(D);}D=document.createElement("form");D.style.display="none";D.id=F;D.action=C;D.target=E||"_blank";D.method="POST";for(key in G){if(G.hasOwnProperty(key)){var H=document.createElement("input");H.setAttribute("name",key);H.setAttribute("value",G[key]);D.appendChild(H);}}document.body.appendChild(D);D=document.getElementById(F);D.submit();}};var A=WIDGETBOX.net.Utils;WIDGETBOX.setReady("net.Utils");})();}WIDGETBOX.namespace("net");if(!WIDGETBOX.net.JSONRequest){(function(){var B=[];WIDGETBOX.net.JSONRequest={get:function(D,H,J,O,E){var M=document;var L=WIDGETBOX.net.Utils.newTimestamp();var P=B.length;if(!H){H={};}var F=(E!=null)?E:H;F.timestamp=L;F.callback="WIDGETBOX.net.JSONRequest.handleCallback("+P+")";F.output="json";var I={};I.readyState=0;I.url=D;I.send=H;I.pathParams=E;I.done=J;I.timestamp=L;I.number=P;I.timeout=O;var G=WIDGETBOX.net.Utils.newURLWithParams(D,H,E);var C="widgetbox_jsonrequest_"+P;var N=M.getElementsByTagName("head").item(0);var K=M.createElement("script");I.script=K;I.id=C;B[P]=I;K.setAttribute("src",G);K.setAttribute("id",C);N.appendChild(K);},handleCallback:function(E){var J=document;if(B[E]){try{var F=B[E];B[E]=null;F.readyState=4;var D=J.getElementsByTagName("head").item(0);if(F.script){try{D.removeChild(F.script);}catch(I){WIDGETBOX.logMessage(I);}}var H=F.done;if(H){var C=function(K){try{H(E,K,null);}catch(L){WIDGETBOX.logMessage(L);}};return C;}}catch(I){WIDGETBOX.logMessage(I);}}var G=function(K){};return G;}};var A=WIDGETBOX.net.JSONRequest;WIDGETBOX.setReady("net.JSONRequest");})();}WIDGETBOX.namespace("net");if(!WIDGETBOX.net.ProxiedHTTPRequest){(function(){function A(E){var G=null;try{if(typeof ActiveXObject!="undefined"){G=new ActiveXObject("Microsoft.XMLDOM");G.async=false;G.loadXML(E);}else{var H=new DOMParser();G=H.parseFromString(E,"text/xml");}}catch(F){WIDGETBOX.logMessage(F);}return G;}var D=[];var C=0;function B(){this.initialized=false;this.onreadystatechange=null;this.onload=null;this.onerror=null;this.onprogress=null;this.readyState=0;this.status=0;this.statusText=null;this.requestHeaders=null;this.responseHeaders=null;this.responseXML=null;this.responseText=null;this.responseObj=null;this.parseAtProxyServer=false;this.format="raw";}B.prototype={getResponseXML:function(){if(!this.responseXML&&this.responseText){this.responseXML=A(this.responseText);}return this.responseXML;},abort:function(){this.initialized=false;},getAllResponseHeaders:function(){var F="";if(this.initialized){for(var E in this.responseHeaders){var G=this.responseHeaders[E];F+=E+": "+G+"\n";}}return F;},getResponseHeader:function(E){if(this.initialized){return this.responseHeaders[E];}return null;},setFormat:function(E){this.format=E;},setParseAtProxyServer:function(F,E){this.parseAtProxyServer=F;if(E){this.format=E;}},open:function(I,G,H,E,F){this.url=G;this.method=I;this.initialized=true;this.readyState=0;this.status=0;this.statusText=null;this.requestHeaders={};this.responseHeaders=null;this.responseXML=null;this.responseText=null;this.responseObj=null;this.parseAtProxyServer=false;this.format="raw";},send:function(E){if(this.initialized){var F=this;var L=function(N,P,M){F.readyState=4;if(P&&(!P.error)){if(P.responseText){F.responseText=P.responseText;}if(P.responseObj){F.responseObj=P.responseObj;}if(P.headers){F.responseHeaders=P.headers;}F.status=P.status;F.statusText=P.statusText;var O=F.getResponseHeader("Content-Type");if(O&&(O.indexOf("xml")>=0)){F.getResponseXML();}if(F.onreadystatechange){F.onreadystatechange();}if(F.onload){F.onload();}}else{if(P&&P.status){if(P.headers){F.responseHeaders=P.headers;}F.status=P.status;F.statusText=P.statusText;}else{F.status=502;F.statusText="Bad Gateway (Irrecoverable Error at Widgetbox Proxy)";}if(F.onreadystatechange){F.onreadystatechange();}if(F.onerror){F.onerror();}}};var K={};var J={};J.target=this.url;J.method=this.method;if(E){J.body=E;}var H="";for(var G in this.requestHeaders){var I=this.requestHeaders[G];H+=G+":"+I+"\n";}if(H){J.headers=H;}J.parse=this.parseAtProxyServer;J.format=this.format;K.token=WIDGETBOX.globals.token;WIDGETBOX.net.JSONRequest.get(WIDGETBOX.urls.proxyBaseUrl+"/ws_p/",K,L,0,J);}},setRequestHeader:function(F,E){if(this.initialized){this.requestHeaders[F]=E;}}};WIDGETBOX.net.ProxiedHTTPRequest=B;WIDGETBOX.setReady("net.ProxiedHTTPRequest");})();}WIDGETBOX.namespace("dom");if(!WIDGETBOX.dom.Utils){(function(){var docWriteFunc=document.write;var docWritelnFunc=document.writeln;var outputBuf="";var docWritePatch=function(markup){outputBuf+=markup;};var docWritelnPatch=function(markup){outputBuf+=markup+"\n";};WIDGETBOX.dom.Utils={lTrim:function(value){var re=/\s*((\S+\s*)*)/;return value.replace(re,"$1");},rTrim:function(value){var re=/((\s*\S+)*)\s*/;return value.replace(re,"$1");},trim:function(value){return utils.lTrim(utils.rTrim(value));},startWriteCapture:function(){document.write=docWritePatch;document.writeln=docWritelnPatch;},stopWriteCapture:function(){document.write=docWriteFunc;document.writeln=docWritelnFunc;},removeAllChildren:function(parentNode,loop){if(!loop){loop=0;}if(loop<5){try{if(parentNode.childNodes){while(parentNode.childNodes.length>0){var toRemove=parentNode.childNodes[parentNode.childNodes.length-1];WIDGETBOX.dom.Utils.removeAllChildren(toRemove);parentNode.removeChild(toRemove,loop++);}}}catch(e){WIDGETBOX.logMessage(e);}}},insertHtmlText:function(elem,htmlStr){var headNodes=[];try{var re=new RegExp("<\s*?script[\s\S]*?<\/script\s*?>","gi");var filteredHtml=htmlStr.replace(re,"");elem.innerHTML=filteredHtml;var head=document.getElementsByTagName("head").item(0);re=new RegExp("<\s*?script([^>]*?)>([\s\S]*?)<\/script","gi");var match=re.exec(htmlStr);while(match!=null){var scriptContent=RegExp.$2;if(scriptContent){scriptContent=WIDGETBOX.dom.Utils.trim(scriptContent);}if(scriptContent&&scriptContent.length>0){eval(scriptContent);}else{var scriptNode=document.createElement("script");scriptNode.setAttribute("type","text/javascript");scriptNode.setAttribute("defer",true);var reSrc=new RegExp('src="([\s\S]*?)"',"gi");var strSrc=reSrc.exec(match[1]);if(strSrc){scriptNode.setAttribute("src",strSrc[1]);}else{scriptNode.text=match[2];}headNodes.push(scriptNode);head.appendChild(scriptNode);}match=re.exec(htmlStr);}}catch(e){WIDGETBOX.logMessage(e);}return headNodes;},insertCssFile:function(URI,doc,checkDuplicates){if(!URI){return ;}var doc=document;var req=new WIDGETBOX.net.ProxiedHTTPRequest();req.onload=function(){var cssStr=req.responseText;cssStr=utils.fixPathsInCssText(cssStr,URI);if(checkDuplicates){var styles=doc.getElementsByTagName("style");var cssText="";for(var i=0;i<styles.length;i++){cssText=(styles[i].styleSheet&&styles[i].styleSheet.cssText)?styles[i].styleSheet.cssText:styles[i].innerHTML;if(cssStr==cssText){return ;}}}var style=utils.insertCssText(cssStr);};req.open("get",URI);req.send();},insertCssText:function(cssStr,doc,URI,id){if(!cssStr){return ;}var doc=document;if(URI){cssStr=utils.fixPathsInCssText(cssStr,URI);}var style;if(id){style=doc.getElementById(id);}if(!style){style=doc.createElement("style");style.setAttribute("type","text/css");if(id){style.setAttribute("id",id);}var head=doc.getElementsByTagName("head")[0];if(!head){return ;}else{head.appendChild(style);}}else{WIDGETBOX.dom.Utils.removeAllChildren(style);}if(style.styleSheet){style.styleSheet.cssText=cssStr;}else{var cssText=doc.createTextNode(cssStr);style.appendChild(cssText);}return style;},fixPathsInCssText:function(cssStr,URI){if(!cssStr||!URI){return ;}var pos=0;var str="";var url="";while(pos!=-1){pos=0;url="";pos=cssStr.indexOf("url(",pos);if(pos<0){break;}str+=cssStr.slice(0,pos+4);cssStr=cssStr.substring(pos+4,cssStr.length);url+=cssStr.match(/^[\t\s\w()\/.\\'"-:#=&?]*\)/)[0];cssStr=cssStr.substring(url.length-1,cssStr.length);url=url.replace(/^[\s\t]*(['"]?)([\w()\/.\\'"-:#=&?]*)\1[\s\t]*?\)/,"$2");if(url.search(/(file|https?|ftps?):\/\//)==-1){url=(new WIDGETBOX.net.Uri(URI,url).toString());}str+=url;}return str+cssStr;},getComputedStyle:function(el,prop){if(window.getComputedStyle){return el.ownerDocument.defaultView.getComputedStyle(el,null).getPropertyValue(prop);}if(!el){return"";}var re=/(\-([a-z]){1})/g;if(prop=="float"){prop="styleFloat";}if(re.test(prop)){prop=prop.replace(re,function(){return arguments[2].toUpperCase();});}return(el.currentStyle&&el.currentStyle[prop])?el.currentStyle[prop]:null;},getX:function(node){return utils.getXY(node)[0];},getY:function(node){return utils.getXY(node)[1];},getXY:function(node){var ua=navigator.userAgent.toLowerCase();var isIE=(ua.indexOf("msie")>-1);var isIE8=(isIE&&(ua.indexOf("msie 8")>-1));var isIE9=(isIE&&(ua.indexOf("msie 9")>-1));var isGecko=(ua.indexOf("gecko")>-1);var isSafari=(ua.indexOf("safari")>-1);var isOpera=(ua.indexOf("opera")>-1);var xy=false;if(node!=null&&node.style.display!=null){var doc=node.ownerDocument;var docEl=document.documentElement;var docScrollLeft=utils.getDocumentScrollLeft(doc);var docScrollTop=utils.getDocumentScrollTop(doc);if(docEl.getBoundingClientRect){var box={top:0,left:0};try{box=node.getBoundingClientRect();}catch(e){}xy=[box.left,box.top];var docMode=doc.documentMode;try{if(self.top&&self.top.document&&self.top.document.documentMode){docMode=self.top.document.documentMode;}}catch(ignore){}var isIE8or9=isIE8||isIE9;if((isIE&&!isIE8or9)||(isIE8or9&&(docMode&&!isNaN(docMode)&&Number(docMode)<8))){var off1=2;var off2=2;var mode=doc.compatMode;if((mode==="BackCompat")){var bLeft=utils.getComputedStyle(docEl,"border-left-width");var bTop=utils.getComputedStyle(docEl,"border-top-width");if(bLeft!=="medium"){off1=parseInt(bLeft,10);}if(bTop!=="medium"){off2=parseInt(bTop,10);}}xy[0]-=off1;xy[1]-=off2;}if((docScrollTop||docScrollLeft)){xy[0]+=docScrollLeft;xy[1]+=docScrollTop;}}else{xy=[node.offsetLeft,node.offsetTop];var parentNode=node;var borders;while((parentNode=parentNode.offsetParent)){xy[0]+=parentNode.offsetLeft;xy[1]+=parentNode.offsetTop;if(isGecko){borders=utils.calcBorders(parentNode);xy[0]+=borders[0];xy[1]+=borders[1];}}if(utils.getComputedStyle(node,"position")!=="fixed"){parentNode=node;var scrollTop,scrollLeft;while((parentNode=parentNode.parentNode)&&parentNode.tagName){scrollTop=parentNode.scrollTop;scrollLeft=parentNode.scrollLeft;if(isGecko&&(utils.getComputedStyle(parentNode,"overflow")!=="visible")){borders=utils.calcBorders(parentNode);xy[0]+=borders[0];xy[1]+=borders[1];}if(scrollTop||scrollLeft){xy[0]-=scrollLeft;xy[1]-=scrollTop;}}xy[0]+=docScrollLeft;xy[1]+=docScrollTop;}else{if(isOpera){xy[0]-=docScrollLeft;xy[1]-=docScrollTop;}else{if(isSafari||isGecko){xy[0]+=docScrollLeft;xy[1]+=docScrollTop;}}}}}return xy;},setXY:function(node,xy){var pos=utils.getComputedStyle(node,"position");var left=parseFloat(utils.getComputedStyle(node,"left"));var top=parseFloat(utils.getComputedStyle(node,"top"));if(pos=="static"){pos="relative";node.style.position=pos;}if(isNaN(left)){left=(pos=="relative")?0:node.offsetLeft;}if(isNaN(top)){top=(pos=="relative")?0:node.offsetTop;}var currentXY=utils.getXY(node);if(xy[0]!==null){node.style.left=(xy[0]-currentXY[0]+left)+"px";}if(xy[1]!==null){node.style.top=(xy[1]-currentXY[1]+top)+"px";}},getDocumentScrollTop:function(doc){doc=doc||document;return Math.max(doc.documentElement.scrollTop,doc.body.scrollTop);},getDocumentScrollLeft:function(doc){doc=doc||document;return Math.max(doc.documentElement.scrollLeft,doc.body.scrollLeft);},getDocumentHeight:function(doc){doc=doc||document;return Math.max(Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight),Math.max(doc.body.offsetHeight,doc.documentElement.offsetHeight),Math.max(doc.body.clientHeight,doc.documentElement.clientHeight));},getDocumentWidth:function(doc){doc=doc||document;return Math.max(Math.max(doc.body.scrollWidth,doc.documentElement.scrollWidth),Math.max(doc.body.offsetWidth,doc.documentElement.offsetWidth),Math.max(doc.body.clientWidth,doc.documentElement.clientWidth));},calcBorders:function(node){var l=parseInt(utils.getComputedStyle(node,"border-left-width"),10)||0;var t=parseInt(utils.getComputedStyle(node,"border-top-width"),10)||0;var ua=navigator.userAgent.toLowerCase();if((ua.indexOf("gecko")>-1)){var RE_TABLE=new RegExp("^t(?:able|d|h)$","i");if(RE_TABLE.test(node.tagName)){l=0;t=0;}}return[l,t];},openPopupWindow:function(url,name,width,height,config){if(url){if(!name){name="wbxpopupwindow";}if(!width){width=500;}if(!height){height=500;}if(!config){var centerWidth=(window.screen.width-width)/2;var centerHeight=(window.screen.height-height)/2;config="width="+width+",height="+height+",toolbar=0,locationbar=1,directories=0,status=0,menubar=0,scrollbars=1,resizable=0,copyhistory=0,left="+centerWidth+",top="+centerHeight;}window.open(url,name,config);}},hideElementsOnPage:function(doc,nodeName,overlapNode,array){if(!doc){doc=document;}if(!array){array=[];}var nodes=WIDGETBOX.dom.Utils.getElementsByTagName(nodeName,doc);for(var i=0;i<nodes.length;i++){var n=nodes[i];if(n.style&&n.style.visibility!="hidden"&&(!overlapNode||WIDGETBOX.dom.Utils.doNodesOverlap(overlapNode,n))){n.setAttribute("data-visibility",n.style.visibility);n.style.visibility="hidden";array[array.length]=n;}}return array;},showHiddenElementsOnPage:function(array){if(array){for(var i=0;i<array.length;i++){var previousVisibility=array[i].getAttribute("data-visibility");array[i].style.visibility=previousVisibility||"";}array=[];}return array;},doNodesOverlap:function(node1,node2){var top1=WIDGETBOX.dom.Utils.getY(node1);var left1=WIDGETBOX.dom.Utils.getX(node1);var right1=left1+node1.offsetWidth;var bottom1=top1+node1.offsetHeight;var left2=WIDGETBOX.dom.Utils.getX(node2);var top2=WIDGETBOX.dom.Utils.getY(node2);var right2=left2+node2.offsetWidth;var bottom2=top2+node2.offsetHeight;var v=false;var h=false;if(top1<=top2&&bottom1>=top2){v=true;}if(top1>=top2&&top1<=bottom2){v=true;}if(left1<=left2&&right1>=left2){h=true;}if(left1>=left2&&left1<=right2){h=true;}return v&&h;},getElementsByTagName:function(nodeName,rootNode,array){if(!rootNode){rootNode=document;}if(!array){array=[];}for(var i=0;i<rootNode.childNodes.length;i++){var node=rootNode.childNodes[i];if(node.nodeName.toLowerCase()==nodeName){array.push(node);}else{array=WIDGETBOX.dom.Utils.getElementsByTagName(nodeName,node,array);}}return array;}};var utils=WIDGETBOX.dom.Utils;WIDGETBOX.setReady("dom.Utils");})();}WIDGETBOX.namespace("track");if(!WIDGETBOX.track.tracker){(function(){WIDGETBOX.track.tracker={Tracker:function(F,B,E,A,C,D){this.firstImpressionLogged=false;this.affiliateImpressionsLogged=false;this.timesLogged=0;this.targetUrl=null;this.sessionId=B;this.impressionDuration="5";this.adTreatmentId=null;this.adPartnerId=null;this.affiliateId=null;this.channelId=null;this.isInEditor=false;this.syndication_sid="";this.hover_locked=false;this.hover_lock_int=null;this.isAdServerDetailsDoneLoading=false;this.isInitialized=false;this.clickTrackingParams=null;this.locationUrl=A;this.affiliateTrackers=null;this.sik=null;this.token=C;this.widgetPrototype=(F&&F.widgetPrototype)||"NONE";this.widgetPrototypeOrdinal=(F&&F.widgetPrototypeOrdinal)||"";this.systemData=null;this.userData=null;this.testVariants=D;this.seq=0;this.hasEngaged=false;this.wrapperType=E?E:"1";this.baseData=null;this.initialize=function(L,H){this.sessionId=H||this.sessionId||WIDGETBOX.generateGUID();this.baseData={};this.baseData.sid=this.sessionId;this.baseData.vid=WIDGETBOX.globals.vid||this.sessionId;this.baseData.sik="";if(this.systemData){for(var J in this.systemData){if(this.systemData.hasOwnProperty(J)){this.baseData["sd."+J]=this.systemData[J];}}}if(this.userData){for(var G in this.userData){if(this.userData.hasOwnProperty(G)){this.baseData["ud."+G]=this.userData[G];}}}if(this.testVariants){for(var M in this.testVariants){if(this.testVariants.hasOwnProperty(M)){this.baseData["v."+M]=this.testVariants[M];}}}this.baseData.t=(this.token)?this.token:WIDGETBOX.globals.token;this.baseData.w=this.wrapperType;for(var I in WIDGETBOX.globals.trackingKeys){this.baseData[I]=L[WIDGETBOX.globals.trackingKeys[I]];}try{this.locationUrl=(this.locationUrl)?this.locationUrl:window.location.href;}catch(K){}this.updateBaseTrackingRequestUrl();this.instId=L.appId;this.userPk=L.userPK;this.isInitialized=true;};this.updateBaseTrackingRequestUrl=function(){this.baseMetricsTrackingRequestUrl=WIDGETBOX.net.Utils.newURLWithParams(WIDGETBOX.urls.metricsBaseUrl+"/image.gif",this.baseData);};this.setSubInstanceKey=function(G){if(G){this.sik=G;this.baseData.sik=this.sik;this.updateBaseTrackingRequestUrl();}};this.logWidgetImpression=function(){if(!this.firstImpressionLogged&&!this.isInEditor&&!WIDGETBOX.globals.disableHitTracking&&this.isInitialized){this.firstImpressionLogged=true;var G={};G.it="0";G.sq=this.getNextSequence();G.ts=new Date().getTime();G.CXNID="2000003.0000000001NXC";G.l=this.locationUrl;try{if(WIDGETBOX.random.Utils.seedData){G.cs=WIDGETBOX.random.Utils.seedData;}}catch(H){WIDGETBOX.logMessage(H);}this.loadMetricsTrackerImage(WIDGETBOX.net.Utils.addParameters(this.baseMetricsTrackingRequestUrl,G));}};this.logAffiliateImpressions=function(){if(this.affiliateTrackers&&!this.affiliateImpressionsLogged&&!this.isInEditor&&!WIDGETBOX.globals.disableHitTracking&&this.isInitialized){this.affiliateImpressionsLogged=true;for(var G=0;G<this.affiliateTrackers.length;G++){this.loadMetricsTrackerImage(this.affiliateTrackers[G],true);}}};this.getActionRequestData=function(L,M,H,G,I,O){var K={};if(O){for(var N in this.baseData){K[N]=this.baseData[N];}}K.it="8";K.lbl=L;K.pl=M;if(H!==undefined&&H!==null){if(!this.getHasEngaged()&&this.isAnEngagement(L,M,H,G)){this.setHasEngaged();}K.c=H;}if(!this.getHasEngaged()&&H!=WIDGETBOX.track.tracker.ActionCause.SYSTEM&&H!="6"){K["sd.deprecated"]="1";}if(G!==undefined&&G!==null){K.cs=G;}if(I!==undefined&&I!==null){for(var J in I){if(I.hasOwnProperty(J)){K["ud."+J]=I[J];}}}K.sq=this.getNextSequence();K.ts=new Date().getTime();K.l=this.locationUrl;return K;};this.logWidgetAction=function(H,K,J,I,G){if(!this.isInEditor&&this.isInitialized){this.loadMetricsTrackerImage(WIDGETBOX.net.Utils.addParameters(this.baseMetricsTrackingRequestUrl,this.getActionRequestData(H,K,J,I,G,false)));}};this.isAnEngagement=function(G,J,I,H){return(I==WIDGETBOX.track.tracker.ActionCause.USER||I=="1")&&!(G=="hover"&&J=="initial");};this.setHasEngaged=function(){this.hasEngaged=true;};this.getHasEngaged=function(){return this.hasEngaged;};this.getMetricsRedirectUrl=function(L,H){if(this.isInitialized){var G={};G.it="5";G.ts=new Date().getTime();if(L){if(this.clickTrackingParams&&this.clickTrackingParams.wbx_ls){L+=this.clickTrackingParams.wbx_ls;}G.u=L;}if(this.clickTrackingParams){var I=0;var K=this.clickTrackingParams.wbx_lp;if(!K){K=this.clickTrackingParams["wbx_lp_"+I];}while(K){if(I==0){G.up=K;}else{G["up"+I]=K;}I++;K=this.clickTrackingParams["wbx_lp_"+I];}var J=this.clickTrackingParams.wbx_ct;if(J){G["up"+I]=J;}}if(H){G.r=H;G.p="1";}else{G.p="0";}G.sq=this.getNextSequence();G.l=this.locationUrl;return WIDGETBOX.net.Utils.addParameters(this.baseMetricsTrackingRequestUrl,G);}return null;};this.loadMetricsTrackerImage=function(H,G){try{var J=new Date().getTime();H=H.replace("__WBX_TIMESTAMP__",J).replace("[timestamp]",J);if(!G){H=WIDGETBOX.net.Utils.addParameter(H,"et","G");}if(!this.isInEditor){var I=new Image(1,1);I.alt="";I.onload=function(){};I.src=H;}}catch(K){}};this.getTrackingParams=function(){return this.baseData;};this.setClickTrackingParams=function(G){this.clickTrackingParams=G;};this.getOOBLinkTracker=function(){if(this.clickTrackingParams&&this.clickTrackingParams.wbx_lt){return this.clickTrackingParams.wbx_lt;}else{return null;}};this.getNextSequence=function(){return this.seq++;};this.getShareUrl=function(U,P,K,I,L,G,T,O,Q,J,H){if(!G){G="json";}var N=WIDGETBOX.urls.shareBaseUrl+"/share/get/";N+=U||this.instId;if(P.toUpperCase()==WIDGETBOX.track.tracker.ShareType.FACEBOOK_WIDGET){P=WIDGETBOX.track.tracker.ShareType.FACEBOOK;}N+="/"+P.toUpperCase()+"."+G;var S={};S.token=this.token||WIDGETBOX.globals.token;S[WIDGETBOX.track.tracker.ShareConstants.LABEL]=K?K.toLowerCase():P.toLowerCase();if(I){S[WIDGETBOX.track.tracker.ShareConstants.URL]=I;}if(T){S.wbx_callback=T;}if(J!==undefined){S.c=J;}if(H!==undefined){S.cs=H;}var M=new RegExp(WIDGETBOX.globals.shareTrackingKeyRegex);for(var R in this.baseData){if(this.baseData.hasOwnProperty(R)){if(M.test(R)){S[R]=this.baseData[R];}}}if(Q){S.sid=Q;}if(O){S.sik=O;}S.ts=new Date().getTime();if(L){N=WIDGETBOX.net.Utils.newURLWithParams(N,L);}return WIDGETBOX.net.Utils.newURLWithParams(N,S);};this.clone=function(){var H=this;var G=new WIDGETBOX.track.tracker.Tracker();for(var I in H){if(H.hasOwnProperty(I)&&!WIDGETBOX.isType("Function",H[I])){G[I]=H[I];}}G.getNextSequence=function(){return H.getNextSequence();};G.getHasEngaged=function(){return H.getHasEngaged();};G.setHasEngaged=function(){H.setHasEngaged();};return G;};if(F){this.initialize(F,B);}},ShareType:{DEFAULT:"DEFAULT",URL:"URL",OWN_SITE:"OWN_SITE",QR_CODE:"QR_CODE",SMS:"SMS",EMAIL:"EMAIL",TWITTER:"TWITTER",FACEBOOK:"FACEBOOK",FACEBOOK_WIDGET:"FACEBOOK_WIDGET",LINKED_IN:"LINKED_IN",DIGG:"DIGG",DELICIOUS:"DELICIOUS",STUMBLE_UPON:"STUMBLE_UPON",REDDIT:"REDDIT",YAHOO:"YAHOO",MENU_SHOW:"MENU_SHOW"},ShareConstants:{URL:"url",ACTION:"action",LABEL:"label",TO:"to",FROM:"from",FROM_NAME:"fname",IP:"ip",USER_AGENT:"ua",LANG:"lang",REFERRER:"rf",SMS_CARRIER:"carrier",MESSAGE_CUSTOM_BODY:"body",MESSAGE_CUSTOM_SUBJECT:"subject",IMAGE_WIDTH:"w",IMAGE_HEIGHT:"h",TITLE:"title"},SendShareAction:{MOBILE_DEFAULT_SMS:0,MOBILE_DEFAULT_EMAIL:1,MOBILE_CUSTOM:2,SOCIAL_SHARE_EMAIL:3,WIDGET_SHARE_EMAIL:4,SOCIAL_SHARE_SMS:5,CUSTOM_TEMPLATE:6},SMSCarrier:{ATT:0,TMOBILE:1,SPRINT:2,VERIZON:3},ActionLabel:{HOVER:"hover",TAB_CLICK:"tab click",BODY_CLICK:"body click",SCROLL:"scroll",PLAY:"play",PLAY_AUTO:"play auto",PLAYBACK_QUARTER:"play 1/4",PLAYBACK_HALF:"play half",PLAYBACK_THREE_QUARTER:"play 3/4",PLAYBACK_FULL:"play full",PLAYBACK_REPLAY_WITH_SOUND:"play sound",FOLLOW:"follow",CONNECT:"connect",TWEET:"tweet",SUBMIT:"submit",RESULT:"result",READ_MORE:"read more",SHARE:"share",CUSTOM:"custom",OPEN:"open",CLOSE:"close",EXPAND:"expand",COLLAPSE:"collapse",INSTALL:"install",PAGE_VIEW:"page view",HOMESCREEN:"homescreen",TEL:"tel:",MAILTO:"mailto:",MAP:"map:",WEBCAL:"webcal:"},ActionCause:{AUTO:0,USER:1,CLICK:2,HOVER:3,TOUCH:4,KEYBOARD:5,SYSTEM:6}};}());}WIDGETBOX.namespace("track");if(!WIDGETBOX.track.metrics){(function(){WIDGETBOX.track.metrics={EventTypes:{IMPRESSION:12,INTERACTION:13,CONTENT:14,NOTATION:15},EventSubtypes:{UNKNOWN:0,IMPRESSION_FULL:1,IMPRESSION_LIMITED:2,INTERACTION_SELECT:21,INTERACTION_DESELECT:22,INTERACTION_LEGACY:28,CONTENT_CLICKTHRU:43,CONTENT_SHARE:44,NOTATION_UPDATE:60},EventModes:{CLICK:1,ROLLOUT:4},Client:function(){this.isNew=true;this.METRICS_ENDPOINT=WIDGETBOX.urls.metricsBaseUrl+"/image.gif";this.seq=0;this.hasEngaged=false;this.isInitialized=false;this.firstImpressionLogged=false;this.affiliateImpressionsLogged=false;this.expansionTrigger=null;this.baseDataKeysRegex=new RegExp("i|ri|aik|pt|iv|rpv|ark");this.baseData={};this.logEventDelegate=null;this.widget=null;this.options={widgetId:null,isInEditor:false};this.init=function(C){WIDGETBOX.extend(this.options,C);if(this.options.widgetId!==null){this.widget=WIDGETBOX.globals.widgets[this.options.widgetId];if(this.widget){for(var B in WIDGETBOX.globals.trackingKeys){if(this.baseDataKeysRegex.test(B)){this.baseData[B]=this.widget.info[WIDGETBOX.globals.trackingKeys[B]];}}var A=(this.widget.getSourceWidget())?this.widget.getSourceWidget().testVariants:this.widget.testVariants;if(A){for(var D in A){if(A.hasOwnProperty(D)){this.baseData["v."+D]=A[D];}}}this.baseData.sid=this.widget.sid;}this.isInitialized=true;}};this.setSubInstanceKey=function(A){this.baseData.sik=A;};this.logAffiliateImpressions=function(){if(!this.options.isInEditor&&this.isInitialized&&!this.affiliateImpressionsLogged){this.affiliateImpressionsLogged=true;if(this.widget&&this.widget.affiliateTrackers){for(var A=0;A<this.widget.affiliateTrackers.length;A++){this.loadMetricsTrackerImage(this.widget.affiliateTrackers[A]);}}}};this.logImpression=function(A){if(!this.options.isInEditor&&this.isInitialized&&!this.firstImpressionLogged){this.firstImpressionLogged=true;var B=WIDGETBOX.extend({subtype:WIDGETBOX.track.metrics.EventSubtypes.IMPRESSION_FULL,detail:"Impression"},A);B=WIDGETBOX.extend(B,{type:WIDGETBOX.track.metrics.EventTypes.IMPRESSION});return this.logEvent(B);}};this.logInteraction=function(A){if(!this.options.isInEditor&&this.isInitialized){var B=WIDGETBOX.extend({subtype:WIDGETBOX.track.metrics.EventSubtypes.UNKNOWN},A);B=WIDGETBOX.extend(B,{type:WIDGETBOX.track.metrics.EventTypes.INTERACTION});return this.logEvent(B);}};this.logCloseInteraction=function(A){var B="Subsequent ad closed";if(A){this.logInteraction({type:WIDGETBOX.track.metrics.EventTypes.INTERACTION,subtype:WIDGETBOX.track.metrics.EventSubtypes.INTERACTION_DESELECT,mode:WIDGETBOX.track.metrics.EventModes.ROLLOUT,detail:B});}else{this.logInteraction({type:WIDGETBOX.track.metrics.EventTypes.INTERACTION,subtype:WIDGETBOX.track.metrics.EventSubtypes.INTERACTION_SELECT,mode:WIDGETBOX.track.metrics.EventModes.CLICK,detail:B});}};this.logContent=function(A){if(!this.options.isInEditor&&this.isInitialized){var B=WIDGETBOX.extend({subtype:WIDGETBOX.track.metrics.EventSubtypes.UNKNOWN},A);B=WIDGETBOX.extend(B,{type:WIDGETBOX.track.metrics.EventTypes.CONTENT});return this.logEvent(A);}};this.logNotation=function(A){if(!this.options.isInEditor&&this.isInitialized){var B=WIDGETBOX.extend({subtype:WIDGETBOX.track.metrics.EventSubtypes.UPDATE},A);B=WIDGETBOX.extend(B,{type:WIDGETBOX.track.metrics.EventTypes.NOTATION});return this.logEvent(A);}};this.logWidgetAction=function(A,D,C,B){this.logEvent({type:WIDGETBOX.track.metrics.EventTypes.INTERACTION,subtype:WIDGETBOX.track.metrics.EventSubtypes.INTERACTION_LEGACY,detail:D,eventData:{label:A,cause:C,custom:B}});};this.logEvent=function(A){var B=null;var C=this.getEventData(A);if(C){if(this.logEventDelegate){this.logEventDelegate(this.METRICS_ENDPOINT,C);}else{this.loadMetricsTrackerImage(WIDGETBOX.net.Utils.newURLWithParams(this.METRICS_ENDPOINT,C),true);}B=C.sq;}return B;};this.getEventData=function(B){var C=WIDGETBOX.extend({},this.baseData);try{if(B.type==WIDGETBOX.track.metrics.EventTypes.INTERACTION){this.hasEngaged=true;if(B.mode!=null){C.m=B.mode;}}if(B.type==WIDGETBOX.track.metrics.EventTypes.IMPRESSION){if(B.systemData==null){B.systemData={};}B.systemData.startTime=WIDGETBOX.globals.startTime;}C.it=B.type;if(B.subtype!=null){C.ist=B.subtype;}if(B.context!=null){C.csq=B.context;}if(B.trigger!=null){C.tsq=B.trigger;}if(B.component!=null){C.cmp=B.component;}if(B.part!=null){C.prt=B.part;}if(B.detail!=null){C.dt=B.detail;}if(B.eventData!=null){for(var F in B.eventData){if(B.eventData.hasOwnProperty(F)){C["ed."+F]=B.eventData[F];}}}if(B.systemData!=null){for(var D in B.systemData){if(B.systemData.hasOwnProperty(D)){C["sd."+D]=B.systemData[D];}}}C.ts=new Date().getTime();try{C.l=window.location.href;}catch(E){}}catch(A){return null;}C.sq=this.getNextSequence();return C;};this.getClickthroughUrl=function(A){var F=A.url;if(F&&this.isInitialized){A.type=WIDGETBOX.track.metrics.EventTypes.CONTENT;A.subtype=WIDGETBOX.track.metrics.EventSubtypes.CONTENT_CLICKTHRU;var G=this.widget.info&&this.widget.info.configParams;if(G&&G.wbx_ls){F+=G.wbx_ls.value;}var B={};B.u=F;if(G){var C=0;var E=G.wbx_lp&&G.wbx_lp.value;if(!E){E=G["wbx_lp_"+C]&&G["wbx_lp_"+C].value;}while(E){if(C==0){B.up=E;}else{B["up"+C]=E;}C++;E=G["wbx_lp_"+C]&&G["wbx_lp_"+C].value;}var D=G.wbx_ct&&G.wbx_ct.value;if(D){B["up"+C]=D;}}F=WIDGETBOX.net.Utils.addParameters(this.METRICS_ENDPOINT,WIDGETBOX.extend(B,this.getEventData(A)));}return F;};this.getShareUrl=function(A){if(!A||!A.shareService){return null;}A.type=WIDGETBOX.track.metrics.EventTypes.CONTENT;A.subtype=WIDGETBOX.track.metrics.EventSubtypes.CONTENT_SHARE;var E=WIDGETBOX.urls.shareBaseUrl+"/share/get/"+this.widget.appId+"/"+A.shareService+".json";var D={};D.ev=2;D.token=WIDGETBOX.globals.token;D.label="widget";D.c=WIDGETBOX.track.tracker.ActionCause.USER;if(A.shareUrl){D[WIDGETBOX.track.tracker.ShareConstants.URL]=A.shareUrl;}if(A.shareTitle){D[WIDGETBOX.track.tracker.ShareConstants.MESSAGE_CUSTOM_SUBJECT]=A.shareTitle;}if(A.shareDescription){D[WIDGETBOX.track.tracker.ShareConstants.MESSAGE_CUSTOM_BODY]=A.shareDescription;}if(A.shareAction){D[WIDGETBOX.track.tracker.ShareConstants.ACTION]=A.shareAction;}if(A.shareTo){D[WIDGETBOX.track.tracker.ShareConstants.TO]=A.shareTo;}if(A.shareFrom){D[WIDGETBOX.track.tracker.ShareConstants.FROM]=A.shareFrom;}if(A.shareFromName){D[WIDGETBOX.track.tracker.ShareConstants.FROM_NAME]=A.shareFromName;}var C=new RegExp(WIDGETBOX.globals.shareTrackingKeyRegex);for(var B in this.baseData){if(this.baseData.hasOwnProperty(B)){if(C.test(B)){D[B]=this.baseData[B];}}}return WIDGETBOX.net.Utils.newURLWithParams(E,WIDGETBOX.extend(D,this.getEventData(A)));};this.getNextSequence=function(){return this.seq++;};this.updateTrigger=function(A){this.expansionTrigger=A;};this.getAndClearTrigger=function(){var A=this.expansionTrigger;this.expansionTrigger=null;return A;};this.getOOBLinkTracker=function(){var A=null;if(this.widget&&this.widget.info.configParams&&this.widget.info.configParams.wbx_lt){A=this.widget.info.configParams.wbx_lt.value;}return A;};this.loadMetricsTrackerImage=function(A,B){if(!A){return ;}try{var D=new Date().getTime();A=A.replace("__WBX_TIMESTAMP__",D).replace("[timestamp]",D);if(B){A=WIDGETBOX.net.Utils.addParameter(A,"et","G");}var C=new Image(1,1);C.alt="";C.onload=function(){};C.src=A;}catch(E){}};this.clone=function(){var B=this;var A=new WIDGETBOX.track.metrics.Client();for(var C in B){if(B.hasOwnProperty(C)&&!WIDGETBOX.isType("Function",B[C])){A[C]=B[C];}}A.getNextSequence=function(){return B.getNextSequence();};A.logEventDelegate=function(D,E){return B.logEventDelegate(D,E);};return A;};}};}());}WIDGETBOX.namespace("subscriber");if(!WIDGETBOX.subscriber.Widget){(function(){var A=WIDGETBOX.net.JSONRequest;var B=WIDGETBOX.net.Utils;function C(F,E,D){if(!F){F="00000000-0000-0000-0000-000000000000";}this.appId=F;this.regId=E;this.fId=this.regId;this.providerId=null;this.sid=WIDGETBOX.generateGUID(WIDGETBOX.random.Utils.random);this.id=WIDGETBOX.globals.widgets.length;this.loaded=false;this.unloaded=false;this.widgetInfoRequestPending=false;this.hasError=false;this.sendsMessages=false;this.subscribeMode=null;this.buttonMode=0;this.defer=false;this.preventLoad=false;this.info=null;this.eventListeners=null;this.activityImage=null;this.widgetImage=null;this.iframe=null;this.adDiv=null;this.divNode=null;this.headNodes=null;this.parentNode=D;this.divId="widgetbox_widget_div_"+this.id;this.divNode=WIDGETBOX.createElement("div",this.parentNode);this.divNode.setAttribute("id",this.divId);this.getWidgetLoaded=false;this.adLoaded=false;this.adFriendly=false;this.adEnabled=false;this.isSubscriber=false;this.channels=null;this.adPlacement=null;this.isPreviewInstance=false;this.isConfigurable=false;this.inventoryInstId=false;this.inventoryRegId=false;this.appPK=null;this.regPK=null;this.providerPK=null;this.userPK=null;this.fromGalleryPK=null;this.installPartnerNetworkPK=null;this.isUseDefaultDomain=false;this.defaultDomain=null;this.categories=null;this.detailsUrl=null;this.configUrl=null;this.configParams=null;this.partnerNetwork=null;this.fromPartnerNetwork=null;this.fromCustomGallery=null;this.suppressEditWidget=false;this.serviceLevel="0";this.providerServiceLevel="0";this.instServiceLevel="0";this.cfgString=null;this.childParams=null;this.sourceWidgetId=null;this.infoUrlOverride=null;this.testVariants={};this.mouseoutState={mousedOver:false,mouseOutTimeout:null,docMouseHandler:null,suspended:null,doMouseOut:null,setMousedOver:function(G){this.mousedOver=G;},mouseOutHold:false};this.mouseoverState={isHovering:false,onTop:false,doMouseOver:null,mouseChecker:null,mouseElementBox:null,mouseElementBody:null,mouseoutElement:null,mouseoverElement:null,overTimeout:null,IEMouseMove:null,cancelOverTimeout:null,ignoreFirstMouseout:false,mousedOut:false};this.anchoring={lastX:null,lastY:null,lastViewportWidth:0,lastViewportHeight:0,lastDocumentHeight:0,lastPageXOffset:0,lastPageYOffset:0,lastAnchorAttempt:0,anchorToBody:false,anchorChildrenToBody:true,canModifyDOM:false,unloadOnLink:false,overTimeoutLength:250,setUnloadEventConfig:function(G){try{if(!G){return ;}this.unloadEvent=G;}catch(G){this.unloadEvent={};WIDGETBOX.logMessage(G);}},unloadEvent:{}};this.preloaderEnabled=false;this.preloaderAsset=null;this.closeButton=null;this.storedMarginLeft=0;this.zIndexForExpandable=null;this.anchorPosition="TR";this.tracker=null;this.affiliateTrackers=null;D.appendChild(this.divNode);WIDGETBOX.globals.widgets[this.id]=this;}C.prototype={addEventListener:function(D,F){if(F){if((D=="load")&&this.loaded){try{F(this);}catch(G){WIDGETBOX.logMessage(G);}}else{if(!this.eventListeners){this.eventListeners={};}if(!this.eventListeners[D]){this.eventListeners[D]=[];}var E=this.eventListeners[D];E.push(F);}}},notifyEventListeners:function(E){if(!this.eventListeners){return ;}var F=this.eventListeners[E];if(!F){return ;}for(var D=0;D<F.length;D++){var G=F[D];try{G(this);}catch(H){WIDGETBOX.logMessage(H);}}},loadInfo:function(S){if(!S&&!this.info){return ;}if(S&&!this.info){this.info=S;}else{S=this.info;}if(!this.loaded){if(S.configParams){var W=S.configParams["wbx.defer"];if(W&&W.value&&W.value==="true"){this.defer=true;}var Aa=S.configParams["wbx.backupInstanceMap"];if(Aa&&Aa.valueMap){for(var L in Aa.valueMap){if(navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf(L)>-1){var AT=Aa.valueMap[L];if(AT){return WIDGETBOX.subscriber.Main.replaceWidget(this.id,AT);}}}}var c=S.configParams["wbx.controller"];if(c&&c.value){delete S.configParams["wbx.controller"];var Z=document.getElementById("wbx_jscontroller_"+this.id);if(!Z){this.defer=true;var Ab=this.id;this.preventLoad=true;WIDGETBOX.appendScript(c.value,"wbx_jscontroller_"+this.id,true,function(){var d=S.configParams["wbx.controllerInitFn"];var A8=WIDGETBOX.globals.widgets[Ab];if(d&&d.value){var A7=d.value.split(".");var A6=self;try{for(var A5=0;A5<A7.length;A5++){A6=A6[A7[A5]];}A6({setParam:function(e,BA){A8.setConfigParam(e,BA);},renderWidget:function(){A8.preventLoad=false;A8.loadInfo(null);}});}catch(A9){WIDGETBOX.logMessage(A9);}}else{A8.preventLoad=false;WIDGETBOX.subscriber.Main.loadWidgets();}});return ;}}}this.notifyEventListeners("loadInfo");this.regId=S.regId;this.fId=S.fId;if(S.hasDynamicSize||S.hasDynamicStyle||S.sendsMessages){this.sendsMessages=true;}if(S.isContextAware){this.defer=true;}if(S.defer){this.defer=true;}if(this.sendsMessages){this.defer=true;}if(this.sendsMessages){if(!WIDGETBOX.subscriber.Main.isHelperSetupForSubscriber()){WIDGETBOX.subscriber.Main.setupHelperForSubscriber();return ;}}if((this.defer&&!WIDGETBOX.globals.pageLoaded)||this.preventLoad){return ;}if(this.hasChildren()){this.unloadAllChildren();}var P=this.divNode;if(!P){return ;}this.loaded=true;if(S.name=="Widgetbox Error Widget"){this.hasError=true;}if(!this.subscribeMode){this.subscribeMode=S.subscribeMode;}this.configUrl=S.configUrl;this.adFriendly=S.isAdFriendly;this.adEnabled=S.isAdEnabled;this.adPlacement=S.adPlacement;this.isPreviewInstance=S.isPreviewInstance;this.isConfigurable=(this.isConfigurable||this.isPreviewInstance);this.inventoryInstId=S.inventoryInstId;this.inventoryRegId=S.inventoryRegId;this.providerId=S.providerId;this.appPK=S.appPK;this.regPK=S.regPK;this.providerPK=S.providerPK;this.userPK=S.userPK;this.fromGalleryPK=S.fromGalleryPK;this.installPartnerNetworkPK=S.installPartnerNetworkPK;this.isUseDefaultDomain=S.isUseDefaultDomain;this.defaultDomain=S.defaultDomain;this.categories=S.categories;this.serviceLevel=S.serviceLevel;this.providerServiceLevel=S.providerServiceLevel;this.instServiceLevel=S.instServiceLevel;this.fromCustomGallery=S.fromGalleryCode;this.domainWhitelist=S.domainWhitelist;this.affiliateTrackers=[];if(this.domainWhitelist){var AH=false;var Az=window.location.toString();if(Az){var y=Az.indexOf("://")+3;var Al=Az.indexOf("/",y);if(Al==-1){Al=Az.length;}var Y=Az.substring(y,Al);var X=Y.indexOf(":");if(X>0){Y=Y.substring(0,X);}for(var AE=0;AE<this.domainWhitelist.length;AE++){var As=this.domainWhitelist[AE];if(Y.indexOf(As)>-1){AH=true;}}if(!AH){return ;}}}if(S.installPartnerNetworkCode){this.partnerNetwork=S.installPartnerNetworkCode;}else{this.partnerNetwork="code";}if(S.fromPartnerNetworkCode){this.fromPartnerNetwork=S.fromPartnerNetworkCode;}else{this.fromPartnerNetwork="wbx";}if(!this.detailsUrl){this.detailsUrl=WIDGETBOX.urls.galleryBaseUrl;if(this.info.widgetPrototype=="TEMPLATE"){this.detailsUrl+="/i/"+this.appId;}else{this.detailsUrl+="/widget/"+this.fId;this.detailsUrl+="?wbx.refer=1&wbx.refer.instId="+this.appId+"&wbx.refer.targetRegId="+this.regId;if(this.partnerNetwork!=null&&this.partnerNetwork!=""){this.detailsUrl+="&wbx.refer.pn="+this.partnerNetwork;}this.detailsUrl+="&wbx.refer.location="+escape(window.location.href);}}var AW={};var Av=S.configParams;var An={};var n={};var Au={};var u={};var H=false;var AF=false;var Ak=false;if(Av){if(this.cfgString){var AR=this.cfgString.split("&");for(var z=0;z<AR.length;z++){var AO=AR[z].split("=");var AQ=AO[0];var A2=null;if(AO.length>1){A2=decodeURIComponent(AO[1]);}if(AQ=="appInstance.width"){if(A2&&!isNaN(A2)){S.appWidth=A2;}}else{if(AQ=="appInstance.height"){if(A2&&!isNaN(A2)){S.appHeight=A2;}}else{var AM=Av[AQ];if(AM){AM.value=A2;}else{if(S.widgetPrototype==="RICH_MEDIA_AD"||S.widgetPrototype==="AD_V3"){Av[AQ]={name:AQ,value:A2};}}}}}}if(this.sourceWidgetId!=null){var AV=WIDGETBOX.subscriber.Main.getChildParameters(this.sourceWidgetId);for(var AX in AV){var Q=Av[AX];var Ag=AV[AX].value;if(Q){Q.value=Ag;}else{Av[AX]={name:AX,value:Ag};}}}var o=WIDGETBOX.globals.keywordMarkup;var l=WIDGETBOX.globals.taggingMarkup;if(Av){var a="wbx_at";var O=false;var Ay=0;while(Ay<5){var AG=a;if(Ay>0){AG+="_"+Ay;}var v=Av[AG];if(v){var w=v.value;if(w&&w.length>0&&w!="null"){this.affiliateTrackers.push(w);delete Av[AG];O=true;}}Ay++;}if(O){Av.wbx_hasRuntimeTracked={name:"wbx_hasRuntimeTracked",value:"true"};}var Af=Av.wbx_in_editor;Ak=Af&&Af.value&&Af.value=="true";}for(var b in Av){var Ai=Av[b];if(Ai.type==="TEST_VARIABLE"){try{var x=[];var k=Ai.value;for(var Ac in k){var Ah=k[Ac];for(var p=0;p<Ah.weight;p++){x[x.length]=Ac;}}var R=x[Math.floor(Math.random()*x.length)];Ai.value=k[R].value;this.testVariants[Ai.name]=R;}catch(AD){WIDGETBOX.logMessage(AD);}}}var AL=0;var AC=navigator.userAgent.toLowerCase();if(S.widgetType=="FLASH"&&(AC.match(/firefox\/3\.6/i)||AC.match(/msie\s8/i))){AL=-1;}if(AL!=0){u.widthAdjustment=""+AL;}u.appId=this.appId;u.regId=this.regId;u.friendlyId=this.fId;u.name=S.name;u.token=WIDGETBOX.subscriber.Main.getToken();u.sid=this.sid;u.vid=WIDGETBOX.globals.vid;u.id=""+this.id;u.location=window.location.href;u.timestamp=""+B.newTimestamp();u.serviceLevel=""+this.serviceLevel;u.provServiceLevel=""+this.providerServiceLevel;u.instServiceLevel=""+this.instServiceLevel;u.width=""+Number(Number(S.appWidth)+AL);u.height=""+S.appHeight;u.wrapper="JAVASCRIPT";u.isAdFriendly=""+S.isAdFriendly;u.isAdEnabled=""+S.isAdEnabled;u.adPlacement=""+S.adPlacement;u.prototype=S.widgetPrototype;u.prototypeOrdinal=S.widgetPrototypeOrdinal;u.ua=AC;u.version=S.appVersion;u.regVersion=S.regVersion;for(var A0 in this.testVariants){if(this.testVariants.hasOwnProperty(A0)){u["variant."+A0]=this.testVariants[A0];}}var Ax=this;var A4=function(e,d){return Ax.replaceConfigParamTokens(e,d,Av,u,true);};var j=function(e,d){return Ax.replaceConfigParamTokens(e,d,Av,u);};for(var b in Av){var Ai=Av[b];if(Ai.value&&Ai.value.replace){Ai.value=Ai.value.replace(/\$\s*?{\s*?(.*?)\s*?}/gi,A4);}}for(var b in Av){var Ai=Av[b];var g=null;if(o&&Ai.useContext){H=true;var G=o[Ai.contextName];if(G){g=G.keywords;}}if(l&&!g&&(Ai.useRelTags)&&(Ai.contextName=="*")){var G=l[0];if(G){g=G.keywords;}}if(g){Ai.value=g;}if(!Ai.value){Ai.value="";}if(b.indexOf("plugin.")==0){var AI=b.substring(7);if(AI.toLowerCase()=="allowscriptaccess"){continue;}if(S.widgetType=="FLASH"&&AI.toLowerCase()=="wmode"&&S.isAdFriendly&&S.isAdEnabled){AF=true;if(Ai.value.toLowerCase()!="transparent"){An[AI]="opaque";continue;}}An[AI]=Ai.value;continue;}if(b.indexOf("flashvar.")==0){var Ao=b.substring(9);n[Ao]=Ai.value;continue;}if(b.indexOf("loadvar.")==0){continue;}if(b.indexOf("wbx.")==0){var s=b.substring(4);var M=Ai.value;if(s=="initialWidth"){P.style.overflow="hidden";P.style.width=M+"px";u.initialWidth=M;}else{if(s=="initialHeight"){P.style.overflow="hidden";P.style.height=M+"px";u.initialHeight=M;}else{Au[s]=M;}}continue;}var q=Ai.value;if(WIDGETBOX.isType("Object",q)){var V="{";for(var AP in q){if(q.hasOwnProperty(AP)){if(V.length>1){V+=",";}V+='"'+AP+'":"'+q[AP]+'"';}}q=V+"}";}if(S.widgetPrototype=="BLIDGET"||S.widgetPrototype=="RICH_MEDIA_AD"||S.widgetPrototype=="AD_V3"){n[b]=q;AW.cb=WIDGETBOX.version;}else{AW[b]=q;}}if(S.widgetType=="FLASH"&&!AF&&S.isAdFriendly&&S.isAdEnabled){An.wmode="opaque";}this.configParams=Av;}var D=this.getSourceWidget();var AU=Au.paramMode;var J=Au.html5Mode;var Ar=S.widgetType=="HTML"&&(S.widgetPrototype=="MOBILE_HTML5"||S.widgetPrototype=="MOBILE_APP"||S.widgetPrototype=="WIDGET_PAGE"||S.widgetPrototype=="PAGE_COMPONENT");Ar=Ar||(J&&J=="true");var AJ=(AU&&AU=="suppressAll");var K=(AJ||(AU&&AU=="configOnly"));var m=(!Ar&&S.widgetPrototype!="BLIDGET"&&S.widgetPrototype!="RICH_MEDIA_AD"&&S.widgetPrototype!="AD_V3"&&S.widgetPrototype!="TEMPLATE")&&(!AU||AU!="all");this.preloaderEnabled=Au.preloaderEnabled;this.preloaderAsset=Au.preloaderAsset||WIDGETBOX.urls.cdnRuntimeBaseUrl+"/images/indicator-u.gif";this.buttonMode=Au.buttonMode?Au.buttonMode:0;if(D){u.sourceId=String(D.id);}if(S.widgetType!="FLASH"){if(S.hasDynamicSize){u.hasDynamicSize=""+S.hasDynamicSize;}if(S.sendsMessages){u.sendsMessages=""+S.sendsMessages;}}if(S.widgetType=="HTML"){u.output="htmlcontent";}if(!m){u.appPK=this.appPK;u.regPK=this.regPK;u.providerPK=this.providerPK;u.userPK=this.userPK;if(this.installPartnerNetworkPK){u.partnerNetworkPK=this.installPartnerNetworkPK;}if(this.fromGalleryPK){u.fromGalleryPK=this.fromGalleryPK;}if(D){var E=this.getSourceWidget(true);for(var AP in WIDGETBOX.globals.trackingKeys){u["s"+AP.charAt(0).toUpperCase()+AP.slice(1)]=E.info[WIDGETBOX.globals.trackingKeys[AP]];}u.sTsq=E.tracker.seq;u.sThe=E.tracker.hasEngaged;for(var A0 in E.testVariants){if(E.testVariants.hasOwnProperty(A0)){u["sVariant."+A0]=E.testVariants[A0];}}}}if(D){if(D.anchoring.unloadOnLink){if(S.widgetType=="FLASH"){n.wbx_unload_on_link="true";}else{AW.wbx_unload_on_link="true";}}}if(S.widgetType=="FLASH"){if(!K){for(var AS in u){n["widget_"+AS]=u[AS];}}}else{if(S.widgetType=="HTML"||!K){for(var Ad in u){AW["widget."+Ad]=u[Ad];}}}var f=S.url;var N;if(!this.tracker){if(S.widgetPrototype=="AD_V3"||(Av&&Av["wbx.useE2"])){this.tracker=new WIDGETBOX.track.metrics.Client();var U={widgetId:this.id,isInEditor:Ak};this.tracker.init(U);}else{this.tracker=new WIDGETBOX.track.tracker.Tracker(S,this.sid,"1",null,null,(D?D.testVariants:this.testVariants));this.tracker.isInEditor=Ak;}}else{if(typeof this.sourceWidgetId!=="undefined"){this.tracker.setSubInstanceKey(S.appPK);if(this.tracker.isInEditor){if(S.widgetType=="FLASH"){n.wbx_in_editor="true";}else{AW.wbx_in_editor="true";}}}}if(!this.tracker.isNew){this.tracker.affiliateTrackers=this.affiliateTrackers;}this.tracker.logAffiliateImpressions();if(!this.hasError){if(this.tracker.isNew){var At=Av.wbx_expansion_disabled?WIDGETBOX.track.metrics.EventSubtypes.IMPRESSION_LIMITED:WIDGETBOX.track.metrics.EventSubtypes.IMPRESSION_FULL;this.tracker.logImpression({subtype:At});}else{this.tracker.logWidgetImpression();}}var Ae=Au.ab;if(Ae){var AN={};linkTrackingParam=Av.wbx_ls;if(linkTrackingParam){AN.wbx_ls=linkTrackingParam;}linkTrackingParam=Av.wbx_ct;if(linkTrackingParam){AN.wbx_ct=linkTrackingParam;}var AZ="wbx_lp";var AB=0;linkTrackingParam=Av[AZ];if(!linkTrackingParam){AZ="wbx_lp_"+AB;linkTrackingParam=Av[AZ];}while(linkTrackingParam){AN[AZ]=linkTrackingParam;AZ="wbx_lp_"+(++AB);linkTrackingParam=Av[AZ];}this.childParams=AN;if(!this.tracker.isNew){this.tracker.setClickTrackingParams(AN);}this.notifyEventListeners("load");WIDGETBOX.subscriber.Main.renderWidgetInPlaceOfExistingWidget(this.id,Ae,null,true,null,null,true,false,false);return ;}if((S.widgetType=="HTML")&&S.isRenderedInline){try{var Aw=S.htmlContent;Aw=Aw.replace(/\$\s*?{\s*?(.*?)\s*?}/gi,j);Aw=Aw.replace("__MODULE_ID__",this.id);this.headNodes=WIDGETBOX.dom.Utils.insertHtmlText(P,Aw);}catch(AD){WIDGETBOX.logMessage(AD);}this.notifyEventListeners("load");return ;}if(Ar){f=WIDGETBOX.urls.runtimeBaseUrl+"/html5/"+S.appId;}else{if(S.widgetType=="HTML"){f=WIDGETBOX.urls.runtimeBaseUrl+"/get_widget.html";}else{if(S.widgetType=="URL"||S.widgetType=="FLASH"){try{f=f.replace(/\$\s*?{\s*?(.*?)\s*?}/gi,j);}catch(AD){WIDGETBOX.logMessage(AD);}}}}if(!AJ){var Aq;if(S.widgetType=="HTML"&&!H&&!this.isConfigurable&&!this.cfgString){Aq=new Object;for(Am in u){Aq["widget."+Am]=u[Am];}}else{Aq=AW;}f=B.newURLWithParams(f,Aq);}var AY=null;var r=false;if(S.widgetType=="FLASH"){if(!WIDGETBOX.flash.Utils.DetectFlashVer(8,0,0)){var AC=navigator.userAgent.toLowerCase();var t=AC.indexOf("iphone")>-1||AC.indexOf("ipod")>-1||AC.indexOf("ipad")>-1||AC.indexOf("android")>-1;if(t&&Au.backupImageMobile){f=Au.backupImageMobile;r=true;}if(!r&&Au.backupImage){f=Au.backupImage;r=true;}if(r){N=WIDGETBOX.urls.runtimeBaseUrl+"/backuplink/i/"+this.appId;var Aj=Av.wbx_ct;if(Aj){N+="?ct="+encodeURIComponent(Aj);}}}if(!r){if(Au.backupImageLink){n.wbx_cant_expand_url=Au.backupImageLink;}var Ap=null;if((S.widgetPrototype=="RICH_MEDIA_AD"||S.widgetPrototype=="AD_V3")&&window.location.protocol==="https:"&&f.indexOf("http://")==0){f="https"+f.substr(4);}if(!S.hasDynamicSize){Ap=new WIDGETBOX.flash.Utils.FlashTag(f,S.appWidth,S.appHeight,"6,0,65,0");}else{Ap=new WIDGETBOX.flash.Utils.FlashTag(f,-1,-1,"6,0,65,0");}if(S.isRenderedInline||WIDGETBOX.globals.trustedPage){Ap.setAllowScriptAccess("always");}else{Ap.setAllowScriptAccess("sameDomain");}var I="widgetbox_widget_flash_"+this.id;Ap.setId(I);Ap.addParams(An);Ap.addFlashVarsParams(n);var F;try{P.innerHTML=Ap.toString();F=P.children[0];}catch(AD){F=Ap.getElement(P.ownerDocument);P.appendChild(F);}this.addEventListener("unload",function(){WIDGETBOX.flash.Utils.destroyMovie(F);});this.iframe=P.ownerDocument.getElementById(I);if(this.preloaderEnabled){this.addPreloader(this.preloaderAsset);}this.notifyEventListeners("load");if(S.hasDynamicSize){this.notifyEventListeners("resize");}return ;}}if(S.widgetType=="IMG"||r){AY=WIDGETBOX.createElement("img",P);AY.setAttribute("id","widgetbox_widget_img_"+this.id);AY.setAttribute("src",f);if(!S.hasDynamicSize){AY.setAttribute("width",(u.initialWidth)?u.initialWidth:S.appWidth);AY.setAttribute("height",(u.initialHeight)?u.initialHeight:S.appHeight);}AY.setAttribute("alt",S.name);AY.setAttribute("border","0");if(N){var AA=WIDGETBOX.createElement("a",P);AA.setAttribute("href",N);AA.setAttribute("target","_blank");AA.appendChild(AY);P.appendChild(AA);}else{P.appendChild(AY);}this.widgetImage=AY;this.notifyEventListeners("load");if(S.hasDynamicSize){this.notifyEventListeners("resize");}return ;}this.makeWidgetIframe(S,P);var AK=false;if((Ar&&f.length>1000)||f.length>2000){AK=true;}if(AK){if(Ar){f=WIDGETBOX.urls.runtimeBaseUrl+"/html5/"+S.appId;if(!K){f=B.newURLWithParams(f,u,null,"widget");}}else{if(S.widgetType=="HTML"){f=WIDGETBOX.urls.runtimeBaseUrl+"/get_widget.html";}else{f=S.url;}}}var T=null;if(AK){T='<form name="widgetForm" method="POST" action="'+f+'">';for(var Am in AW){var A1=AW[Am];if(WIDGETBOX.isType("String",A1)){A1=A1.replace(/</g,"&lt;");A1=A1.replace(/>/g,"&gt;");A1=A1.replace(/"/g,"&quot;");}T+='<input type="hidden" name="'+Am+'" value="'+A1+'" />';}T+="</form>";}if(S.hasDynamicSize){if(!this.activityImage){AY=WIDGETBOX.createElement("img",P);AY.setAttribute("id","widgetbox_widget_activity_img_"+this.id);AY.setAttribute("src",WIDGETBOX.urls.cdnRuntimeBaseUrl+"/images/indicator-u.gif");AY.setAttribute("width","21");AY.setAttribute("height","21");AY.setAttribute("alt","Loading...");P.appendChild(AY);this.activityImage=AY;}if(this.iframe){this.iframe.src=f;}}else{var h=f.replace(/"/g,'" + \'"\' + "');h=h.replace(/'/g,'" + "\'" + "');if(T){var A3=null;try{A3=(this.iframe.contentDocument)?this.iframe.contentDocument:((this.iframe.contentWindow)?this.iframe.contentWindow.document:this.iframe.document);}catch(AD){this.makeWidgetIframe(S,P);A3=(this.iframe.contentDocument)?this.iframe.contentDocument:((this.iframe.contentWindow)?this.iframe.contentWindow.document:this.iframe.document);}A3.open();A3.write('<html><body onload="document.widgetForm.submit();"><table width="100%" height="100%"><tr><td align="center"><img src="'+WIDGETBOX.urls.cdnRuntimeBaseUrl+'/images/indicator-u.gif" width="21" height="21" alt="Loading..." /></td></tr></table>');A3.write(T);A3.write("</body></html>");A3.close();}else{if(this.iframe){this.iframe.src=h;}}}this.notifyEventListeners("load");}},setConfigParam:function(D,E){var G={name:D,value:E};var F={name:D,value:E};if(!this.configParams){this.configParams={};}this.configParams[D]=G;if(this.info.widgetPrototype=="RICH_MEDIA_AD"){this.configParams["gallery."+D]=F;}if(!this.info.configParams){this.info.configParams={};}this.info.configParams[D]=G;if(this.info.widgetPrototype=="RICH_MEDIA_AD"){this.info.configParams["gallery."+D]=F;}},replaceConfigParamTokens:function(L,O,I,M,J){var P="";var F=O.indexOf(".");if(F>0&&O.length>F){var G=O.substr(0,F);var H=O.substr(F+1);if(G&&H){if(G==="config"){var E=I[H];if(E){P=E.value;}else{var K=H.indexOf(".");var N=H.substr(0,K);E=I[N];if(E){var D=H.substr(K+1);if(E.value[D]){P=E.value[D];}}}}else{if(G==="widget"){P=M[H];}else{if(G==="wbx"&&I[H]){P=I["wbx."+H];}}}}}if(!P){P=(J?"${"+O+"}":"");}return P;},getSourceWidget:function(E){if(typeof this.sourceWidgetId==="undefined"||this.sourceWidgetId===null){return null;}else{var D=WIDGETBOX.globals.widgets[this.sourceWidgetId];if(D){if(typeof D.sourceWidgetId!=="undefined"&&E){return D.getSourceWidget(E)||D;}else{return D;}}}return null;},makeWidgetIframe:function(J,K){var G="hidden";var F=1;var I=1;if(!J.hasDynamicSize){F=J.appWidth;I=J.appHeight;G="visible";}var H="no";if(J.scrolling){H="auto";}var E=this.iframe;if(E!=null){var D=E.parentNode;if(D){D.removeChild(E);E=null;this.iframe=null;}}E=WIDGETBOX.createElement("iframe",K);E.setAttribute("name","widgetbox_widget_iframe_"+this.id);E.setAttribute("id","widgetbox_widget_iframe_"+this.id);E.setAttribute("width",F);E.setAttribute("height",I);E.setAttribute("border","0");E.setAttribute("frameBorder","0");E.setAttribute("src","about:blank");E.setAttribute("marginWidth","0");E.setAttribute("marginHeight","0");E.setAttribute("vspace","0");E.setAttribute("hspace","0");E.setAttribute("allowTransparency","true");E.setAttribute("scrolling",H);if(!this.iframe){K.appendChild(E);this.iframe=E;if(this.preloaderEnabled){this.addPreloader(this.preloaderAsset);}}},addPreloader:function(D){if(this.iframe){try{this.iframe.style.background="url('"+D+"') no-repeat center center";}catch(E){}}},resize:function(D,E){var F=this.info;if(!F){return ;}F.appWidth=D;F.appHeight=E;F.wasResized=true;if(this.activityImage){this.activityImage.style.visibility="hidden";this.activityImage.style.display="none";}if(this.iframe&&(F.hasDynamicSize||F.widgetType=="FLASH")){this.iframe.style.visibility="visible";this.iframe.width=D;this.iframe.height=E;this.notifyEventListeners("resize");}},reloadInfo:function(H){if(!this.loaded){return ;}this.widgetImage=null;this.info=null;this.loaded=false;var F=false;if(((H.widgetType=="HTML")&&H.isRenderedInline)||H.widgetType=="IMG"||H.widgetType=="FLASH"){F=true;}else{if((document.all||navigator.userAgent.toLowerCase().indexOf("safari")!=-1)&&this.iframe){this.iframe=null;F=true;}}if(this.headNodes){var E=document.getElementsByTagName("head").item(0);for(var D=0;D<this.headNodes.length;D++){var G=this.headNodes[D];if(G){E.removeChild(G);}this.headNodes[D]=null;}}this.headNodes=null;if(F){if(H.widgetType=="FLASH"){WIDGETBOX.flash.Utils.destroyMovie(this.iframe);}WIDGETBOX.dom.Utils.removeAllChildren(this.divNode);}this.loadInfo(H);},unload:function(){if(!this.unloaded){try{this.notifyEventListeners("unload");this.activityImage=null;this.widgetImage=null;this.iframe=null;this.headNodes=null;this.info=null;if(this.closeButton){this.closeButton.style.display="none";this.closeButton=null;}if(this.sourceWidgetId!=null){var D=WIDGETBOX.globals.widgets[this.sourceWidgetId];if(D){if(D.mouseoutState){D.mouseoutState.mouseOver=false;D.mouseoutState.suspended=false;}D.dispatchEvent("widget","close_popup",this.appId);if(D.mouseoverState.mouseElementBody&&D.mouseoverState.mouseChecker){try{WIDGETBOX.removeEvent(D.mouseoverState.mouseElementBody,"mousemove",D.mouseoverState.mouseChecker,false);setTimeout(function(){WIDGETBOX.addEvent(D.mouseoverState.mouseElementBody,"mousemove",D.mouseoverState.mouseChecker,false);},10);}catch(E){}}}}if(this.mouseoverState){this.mouseoverState.isHovering=false;this.mouseoverState.onTop=false;try{WIDGETBOX.removeEvent(this.mouseoutState.mouseoutElement,"mousemove",this.mouseoutState.docMouseHandler,false);}catch(E){}if(this.mouseoverState.cancelMouseoverTimeout){this.mouseoverState.cancelMouseoverTimeout();}this.mouseoutState.docMouseHandler=function(){};}this.unloadAllChildren();this.divNode=null;this.eventListeners=null;this.loaded=false;this.unloaded=true;}catch(F){}}},hasChildren:function(){return this.getChildren().length>0;},getChildren:function(){var F=[];for(var E=0;E<WIDGETBOX.globals.widgets.length;E++){var D=WIDGETBOX.globals.widgets[E];if(D&&D.sourceWidgetId==this.id&&D.loaded&&D.info){F.push(D);}}return F;},unloadAllChildren:function(F){var E=this.getChildren();for(var D=0;D<E.length;D++){try{if(F){E[D].anchoring.setUnloadEventConfig(F);}E[D].unload();}catch(G){}}},setOnMouseoutHandler:function(I,O,L){var K=this;if(!O){return ;}if(!I){I=K.iframe;}if(!L){L=0;}var D=navigator.userAgent.toLowerCase();var E=(D.indexOf("msie")>-1);var F=(D.indexOf("msie 6")>-1);var M=(typeof K.sourceWidgetId!=="undefined")?WIDGETBOX.subscriber.Main.getWidget(K.sourceWidgetId):null;K.mouseoutState.mouseoutElement=I.ownerDocument.documentElement;K.mouseoutState.doMouseOut=function(){if(!K.mouseoutState.suspended&&K.mouseoutState.mousedOver){try{WIDGETBOX.removeEvent(K.mouseoutState.mouseoutElement,"mousemove",K.mouseoutState.docMouseHandler);K.mouseoutState.docMouseHandler=function(){};}catch(P){}finally{if(typeof K.sourceWidgetId!=="undefined"){var Q=WIDGETBOX.subscriber.Main.getWidget(K.sourceWidgetId);if(Q){Q.mouseoverState.onTop=false;}}O();}}};var H=function(Q){var P=WIDGETBOX.dom.Utils.getX(Q);var R=WIDGETBOX.dom.Utils.getY(Q);return{x:P,y:R};};var G=function(R){var Q,P=0;if(!R){R=window.event;}if(!R){return{x:0,y:0};}if(E&&R.clientX!==undefined&&R.clientY!=undefined){Q=R.clientX;P=R.clientY;}else{Q=R.pageX;P=R.pageY;}return{x:Q,y:P};};var N=I.offsetWidth||0;var J=I.offsetHeight||0;K.mouseoutState.docMouseHandler=(function(){return function(P){var R=G(P);var S=H(I);var Q=H(K.mouseoutState.mouseoutElement);if(R.x+Q.x<S.x||R.y+Q.y<S.y||R.x+Q.x>S.x+N||R.y+Q.y>S.y+J){if(!K.mouseoutState.mouseOutHold){K.mouseoutState.mouseOutHold=true;K.mouseoutState.closeTimeout=setTimeout(K.mouseoutState.doMouseOut,L);}}else{K.mouseoutState.mousedOver=true;K.mouseoutState.mouseOutHold=false;clearTimeout(K.mouseoutState.closeTimeout);}};})();if(!F){WIDGETBOX.addEvent(K.mouseoutState.mouseoutElement,"mousemove",K.mouseoutState.docMouseHandler,false);}else{I.onmousemove=function(){K.mouseoutState.mousedOver=true;K.mouseoutState.mouseOutHold=false;clearTimeout(K.mouseoutState.closeTimeout);};I.onmouseout=function(){K.mouseoutState.closeTimeout=setTimeout(K.mouseoutState.doMouseOut,L);};}},setOnMouseoverHandler:function(H,P,M){var L=this;if(!P){return ;}if(!H){H=L.iframe;}if(!M){M=0;}var D=navigator.userAgent.toLowerCase();var E=(D.indexOf("msie")>-1);var F=(D.indexOf("msie 9")>-1);var I=function(Q){var R=WIDGETBOX.dom.Utils.getXY(Q);return{x:R[0],y:R[1]};};var G=function(S){var R,Q=0;if(!S){S=window.event;}if(!S){return{x:0,y:0};}if(E&&S.clientX!=undefined&&S.clientY!=undefined){R=S.clientX+H.ownerDocument.documentElement.scrollLeft;Q=S.clientY+H.ownerDocument.documentElement.scrollTop;}else{R=S.pageX;Q=S.pageY;}return{x:R,y:Q};};var N=H.offsetWidth||0;var K=H.offsetHeight||0;var J=function(){try{if(window&&window.parent&&window.parent.frames&&window.parent.document&&window.parent.document.getElementsByTagName){var T=window.parent.document.getElementsByTagName("iframe");for(var R=0;R<T.length;R++){try{if(T[R].contentDocument===H.ownerDocument||T[R].contentWindow.document===H.ownerDocument){return T[R];}}catch(Q){}}}}catch(S){}return null;};var O=J()||H;L.mouseoverState.doMouseOver=function(R){var T=R||window.event;var Q=(T.offsetX!==undefined)?T.offsetX:T.pageX-WIDGETBOX.dom.Utils.getX(T.target);var U=(T.offsetY!==undefined)?T.offsetY:T.pageY-WIDGETBOX.dom.Utils.getY(T.target);if(!L.mouseoverState.overTimeout){var S=function(){P({offsetX:Q,offsetY:U});};if(M){L.mouseoverState.overTimeout=setTimeout(S,M);}else{S();}}};L.mouseoverState.mouseoverElement=H;L.mouseoverState.mouseElementBox=O;L.mouseoverState.mouseElementBody=O.ownerDocument.documentElement;L.mouseoverState.mouseChecker=function(Q){var T=Q||window.event;if(T){var U=I(L.mouseoverState.mouseElementBox);var S=G(T);var R=I(L.mouseoverState.mouseElementBody);if(S.x+R.x<U.x||S.y+R.y<U.y||S.x+R.x>U.x+N||S.y+R.y>U.y+K){L.mouseoverState.onTop=false;L.mouseoverState.cancelMouseoverTimeout();}else{if(E&&!L.mouseoverState.onTop){var V=T.target||T.srcElement;if(V===H||(H===L.divNode&&V.parentNode===H)){L.mouseoverState.doMouseOver(T);}}}}};WIDGETBOX.addEvent(L.mouseoverState.mouseElementBody,"mousemove",L.mouseoverState.mouseChecker,false);WIDGETBOX.addEvent(L.mouseoverState.mouseoverElement,"mousemove",function(Q){var R=Q||window.event;var S=R.target||R.srcElement;if(S===H||(H===L.divNode&&S.parentNode===H)){if(!L.mouseoverState.onTop){L.mouseoverState.doMouseOver(R);}}else{L.mouseoverState.onTop=false;L.mouseoverState.cancelMouseoverTimeout();}},false);WIDGETBOX.addEvent(L.mouseoverState.mouseoverElement,"mouseout",function(Q){L.mouseoverState.cancelMouseoverTimeout();if(L.mouseoverState.ignoreFirstMouseout&&!L.mouseoverState.mousedOut){L.mouseoverState.mousedOut=true;return ;}L.mouseoverState.mousedOut=false;L.mouseoverState.onTop=false;},false);L.mouseoverState.cancelMouseoverTimeout=function(){clearTimeout(L.mouseoverState.overTimeout);L.mouseoverState.overTimeout=null;};L.mouseoverState.IEMouseMove=function(Q){try{var S=G(Q);var U=I(L.mouseoverState.mouseoverElement);var R=I(L.mouseoverState.mouseElementBody);if(S.x+R.x<U.x||S.y+R.y<U.y||S.x+R.x>U.x+N||S.y+R.y>U.y+K){L.mouseoverState.onTop=false;L.mouseoverState.cancelMouseoverTimeout();}}catch(T){}finally{WIDGETBOX.removeEvent(L.mouseoverState.mouseElementBody,"mousemove",L.mouseoverState.IEMouseMove,false);}};},dispatchEvent:function(E,F,H){var D=false;try{if(this.info.widgetPrototype=="BLIDGET"||this.info.widgetPrototype=="RICH_MEDIA_AD"||this.info.widgetPrototype=="AD_V3"){if(this.iframe&&this.iframe.handleEvent){this.iframe.handleEvent({type:E,action:F,value:H});D=true;}}else{}}catch(G){}return D;}};WIDGETBOX.subscriber.Widget=C;WIDGETBOX.setReady("subscriber.Widget");})();}WIDGETBOX.namespace("subscriber");if(!WIDGETBOX.subscriber.Panel){(function(){var A=WIDGETBOX.net.JSONRequest;var B=WIDGETBOX.net.Utils;function C(E,D){if(!E){E="00000000-0000-0000-0000-000000000000";}this.defer=false;this.panelId=E;this.id=WIDGETBOX.globals.panels.length;this.loaded=false;this.panelInfoRequestPending=false;this.showMark=WIDGETBOX.globals.showPanelMarks;this.info=null;this.activityImage=null;this.panelImage=null;this.divNode=null;this.markNode=null;this.markNodeContainer=null;this.parentNode=D;this.divId="widgetbox_panel_div_"+this.id;this.divNode=document.createElement("div");this.divNode.setAttribute("id",this.divId);this.divNode.className="p"+this.panelId;this.deferRendering=false;D.appendChild(this.divNode);WIDGETBOX.globals.panels[this.id]=this;}C.prototype={addEventListener:function(D,F){if(F){if((D=="load")&&this.loaded){try{F(this);}catch(G){WIDGETBOX.logMessage(G);}}else{if(!this.eventListeners){this.eventListeners={};}if(!this.eventListeners[D]){this.eventListeners[D]=[];}var E=this.eventListeners[D];E.push(F);}}},notifyEventListeners:function(E){if(!this.eventListeners){return ;}var F=this.eventListeners[E];if(!F){return ;}for(var D=0;D<F.length;D++){var G=F[D];try{G(this);}catch(H){WIDGETBOX.logMessage(H);}}},loadInfo:function(V){if(!V&&!this.info){return ;}if(V&&!this.info){this.info=V;}else{V=this.info;}this.orientation=V.orientation;this.name=V.name;this.title=V.title;this.token=V.token;this.panelId=V.panelId;this.styleContent=V.styleContent;this.heightSize=V.heightSize;this.heightUnit=V.heightUnit;this.widthSize=V.widthSize;this.widthUnit=V.widthUnit;this.overflowStyle=V.overflowStyle;this.showWidgetLinks=V.widgetLinkOff!=true;this.userAccountServiceLevel=V.userAccountServiceLevel;this.markNodeContainer=null;this.headNodes=null;if(!this.loaded){if(this.deferRendering){this.loaded=true;this.notifyEventListeners("load");return ;}var P=this.divNode;if(!P){return ;}if(P.parentNode&&P.parentNode.className=="module-content"){P.parentNode.style.marginRight="0";P.parentNode.style.marginLeft="0";P.parentNode.style.overflow="auto";}this.loaded=true;var H=this.orientation=="HORIZONTAL";if(this.heightSize){P.style.height=this.heightSize+this.heightUnit;}if(this.widthSize){P.style.width=this.widthSize+this.widthUnit;}if(this.overflowStyle==1){P.style.overflow="auto";}else{if(this.overflowStyle==2){P.style.overflow="hidden";}else{P.style.overflow="";}}var O=null;var E=null;if(H){O=document.createElement("table");O.cellSpacing="0";var D=document.createElement("tbody");O.appendChild(D);E=document.createElement("tr");D.appendChild(E);P.appendChild(O);}var a=V.panelItems;try{var N="";var F=-1;for(var S=0;S<a.length;S++){var T=null;if(H){T=true;}var X=a[S];if(X.textContent){var Y=X.textContent;if(S==0&&Y=="WBX:RANDOMIZE"){var L=0;while(F<0){F=Math.floor(Math.random()*a.length);if(!a[F].appId&&L++<100){F=-1;}}}else{if(X.textType=="PLAIN"){Y=escape(Y);}var Q=document.createElement("div");Q.setAttribute("id","panel-item-"+X.index);Q.className="wbx-panel-textblock";Q.innerHTML=Y;if(H){var I=document.createElement("td");I.vAlign="top";I.appendChild(Q);E.appendChild(I);}else{P.appendChild(Q);}}}else{if(X.appId){if(F<0||F==S){var c="widgetbox_widget_parent_"+WIDGETBOX.globals.widgetCount++;var W=document.createElement("div");W.className="wbx-panel-widget";var J=document.createElement("div");J.setAttribute("id",c);J.className="wbx-widget-div";W.appendChild(J);if(H){var I=document.createElement("td");I.vAlign="top";E.appendChild(I);I.appendChild(W);}else{P.appendChild(W);}WIDGETBOX.subscriber.Main.insertWidget(X.appId,null,J,!this.showWidgetLinks);}}}}if(WIDGETBOX.globals.showPanelMarks){if(!this.markNode&&!this.showWidgetLinks&&this.userAccountServiceLevel==0){this.markNode=document.createElement("div");var R=document.createElement("a");R.setAttribute("href","http://www.widgetbox.com");R.setAttribute("target","_blank");var K=document.createElement("img");K.setAttribute("id","widgetbox_widget_mark_img_"+this.id);K.setAttribute("src",WIDGETBOX.urls.runtimeBaseUrl+"/images/logomark.gif");K.setAttribute("width","81");K.setAttribute("height","18");K.setAttribute("alt","wbx");K.setAttribute("title","Powered by Widgetbox");K.setAttribute("border","0");K.style.border="none";K.style.paddingTop="2px";R.appendChild(K);this.markNode.appendChild(R);var M=null;if(this.overflowStyle>0){M=this.parentNode;if(this.widthSize){this.markNode.style.width=this.widthSize+this.widthUnit;}}else{if(this.markNodeContainer){M=this.markNodeContainer;}else{M=this.divNode;}}M.appendChild(this.markNode);}}if(this.styleContent){var G=document.getElementsByTagName("head").item(0);var b=document.createElement("style");b.setAttribute("type","text/css");G.appendChild(b);if(b.styleSheet){b.styleSheet.cssText=this.styleContent;}else{var Z=document.createTextNode(this.styleContent);b.appendChild(Z);}if(!this.styles){this.styles=[];}this.styles.push(b);}if(this.headNodes){var G=document.getElementsByTagName("head").item(0);}}catch(U){WIDGETBOX.logMessage(U);}this.notifyEventListeners("load");return ;}},reloadInfo:function(I){if(!this.loaded){return ;}this.panelImage=null;this.info=null;this.loaded=false;if(this.markNode){var H=this.markNode;this.markNode=null;if(H.parentNode){H.parentNode.removeChild(H);}}if(this.styles){var E=document.getElementsByTagName("head").item(0);for(var D=0;D<this.styles.length;D++){var G=this.styles[D];if(G){E.removeChild(G);}this.styles[D]=null;}}if(this.headNodes){var E=document.getElementsByTagName("head").item(0);for(var D=0;D<this.headNodes.length;D++){var F=this.headNodes[D];if(F){E.removeChild(F);}this.headNodes[D]=null;}}this.headNodes=null;this.styles=null;WIDGETBOX.dom.Utils.removeAllChildren(this.divNode);this.loadInfo(I);},unload:function(){this.activityImage=null;this.widgetImage=null;this.markNode=null;this.markNodeContainer=null;this.divNode=null;this.eventListeners=null;this.info=null;this.loaded=false;this.styles=null;this.headNodes=null;}};WIDGETBOX.subscriber.Panel=C;WIDGETBOX.setReady("subscriber.Panel");})();}WIDGETBOX.namespace("subscriber");if(!WIDGETBOX.subscriber.Main){(function(){var C=WIDGETBOX.globals;var G=false;var K=false;var P=false;var F=false;var A=false;var E=WIDGETBOX.net.JSONRequest;var J=WIDGETBOX.net.Utils;var R=WIDGETBOX.behaviour.Behaviour;var e=WIDGETBOX.message.Helper.supported()?WIDGETBOX.message.Helper:WIDGETBOX.flash.Helper;var Z=navigator.userAgent.toLowerCase();var c=(Z.indexOf("opera")>-1),b=(Z.indexOf("safari")>-1),Q=(!c&&!b&&Z.indexOf("gecko")>-1),W=(!c&&Z.indexOf("msie")>-1),M=(W&&(Z.indexOf("msie 6")>-1||Z.indexOf("msie 5")>-1)),U=(W&&(Z.indexOf("msie 7")>-1)),T=(W&&(Z.indexOf("msie 8")>-1)),I=(Z.indexOf("firefox")>-1),V=(I&&(Z.indexOf("firefox/2")>-1||Z.indexOf("firefox/1")>-1)),a=(Z.indexOf("camino")),O=(Z.indexOf("mac")>-1);var X=null;var D=null;var B=false;var Y=null;var N=null;var d=null;var L=null;var H=null;WIDGETBOX.subscriber.Main={hiddenElements:[],init:function(){if(!G){G=true;var f=function(){S.unloadWidgets();};WIDGETBOX.addPageUnloadListener(f);S.setupBehaviourForSubscriber();S.loadWidgets();}},getToken:function(){return WIDGETBOX.globals.token;},setupHelperForSubscriber:function(){if(!K&&!P){K=true;var n=function(){if(!P){P=true;K=false;S.loadWidgets();}};var h=function(q){S.resizeWidget(q.widgetId,q.width,q.height);};var m=function(q){S.resizeWidgetDiv(q.widgetId,q.width,q.height);};var l=function(q){S.sendStyleMesssageToWidget(q.widgetId);};var f=function(q){if(q.mode=="inplace"||q.mode=="ontop"){S.renderWidgetInPlaceOfExistingWidget(q.widgetId,q.appId,q.cfgString,false,q.width,q.height,q.isChild,q.closeOnMouseOut,q.mode=="ontop");}else{if(q.mode=="anchor"){S.renderWidgetAnchored(q.widgetId,q.appId,q.cfgString,"TR",false,q.isChild,q.closeOnMouseOut);}else{S.renderWidgetInLightbox(q.appId,q.cfgString,false,q.widgetId,q.isChild,q.closeOnMouseOut);}}};var k=function(q){S.renderUrlInLightbox(q.baseUrl,q.paramObj,q.windowName,q.width,q.height);};var g=function(q){S.renderCanvasInLightbox(q);};var j=function(q){S.unloadWidget(q.widgetId);};var p=function(q){var s=q.widgetId;var r=q.label;var w=q.payload;var v=q.cause;var u=q.custom;if(s&&r&&w){var t=WIDGETBOX.globals.widgets[s];if(t&&t.tracker){t.tracker.logWidgetAction(r,w,v,u);}}};var o=function(q){var t=q.widgetId;var r=q.href;var v=q.target;if(t&&r){var u=WIDGETBOX.globals.widgets[t];if(u&&u.tracker){var w=(u.tracker.isNew)?u.tracker.getClickthruUrl({url:r}):u.tracker.getMetricsRedirectUrl(r);var s=u.tracker.getOOBLinkTracker();if(s){u.tracker.loadMetricsTrackerImage(s);}if(WIDGETBOX.message.Helper.supported()&&v&&v=="_blank"){window.open(w);}else{window.location.href=w;}}}};e.startHelper(WIDGETBOX.globals.token,1001,n);e.setMessageHandler("resizeWidget",h);e.setMessageHandler("resizeWidgetDiv",m);e.setMessageHandler("renderWidget",f);e.setMessageHandler("renderUrl",k);e.setMessageHandler("renderCanvas",g);e.setMessageHandler("unloadWidget",j);e.setMessageHandler("logWidgetAction",p);e.setMessageHandler("gotoAndTrackUrl",o);e.setMessageHandler("requestStyle",l);}},isHelperSetupForSubscriber:function(){return P;},setupBehaviourForSubscriber:function(){if(!F){F=true;var f={"a[rel=tag]":function(h){var j={};var g=h.getAttribute("href");j.href=g;j.keywords=decodeURIComponent(g.substring(g.lastIndexOf("/")+1));j.text=R.getInnerText(h);if(!WIDGETBOX.globals.taggingMarkup){WIDGETBOX.globals.taggingMarkup=[];}WIDGETBOX.globals.taggingMarkup.push(j);},"a[rel=wbx-keywords]":function(j){var h={};var g=j.getAttribute("name");if(!g){g="*";}h.name=g;h.keywords=j.getAttribute("title");h.text=R.getInnerText(j);if(!WIDGETBOX.globals.keywordMarkup){WIDGETBOX.globals.keywordMarkup={};}if(!WIDGETBOX.globals.keywordMarkup[g]){WIDGETBOX.globals.keywordMarkup[g]=h;}},"wbx:keywords":function(j){var h={};var g=j.getAttribute("name");if(!g){g="*";}h.name=g;h.keywords=j.getAttribute("value");h.text=R.getInnerText(j);if(!WIDGETBOX.globals.keywordMarkup){WIDGETBOX.globals.keywordMarkup={};}if(!WIDGETBOX.globals.keywordMarkup[g]){WIDGETBOX.globals.keywordMarkup[g]=h;}},"wbx:widget":function(g){var h=g.getAttribute("appId");if(h){S.insertWidget(h,null,g);}},"wbx:panel":function(h){var g=h.getAttribute("panelId");if(g){S.insertPanel(g,h);}},"div.wbx-widget":function(g){var h=g.getAttribute("id");if(h){S.insertWidget(h,null,g);}},"div.wbx-panel":function(h){var g=h.getAttribute("id");if(g){S.insertPanel(g,h);}},"span.wbx-widget":function(g){var h=g.getAttribute("id");if(h){S.insertWidget(h,null,g);}},"span.wbx-panel":function(h){var g=h.getAttribute("id");if(g){S.insertPanel(g,h);}}};R.register(f);WIDGETBOX.addPageLoadListener(function(){R.apply();S.loadWidgets();});}},replaceWidget:function(h,l){var j=WIDGETBOX.globals.widgets[h];if(j){var n=j.eventListeners;var f=j.divNode.parentNode;var m=j.buttonMode;var g=j.suppressEditWidget;j.eventListeners={};j.unload();WIDGETBOX.globals.widgets[h]=null;var k=S.insertWidget(l,null,f,m,g,null);k.eventListners=n;return k;}},insertWidget:function(l,h,f,g,j,m){if(!WIDGETBOX.globals.firstParentNode){WIDGETBOX.globals.firstParentNode=f;}WIDGETBOX.dom.Utils.removeAllChildren(f);var k=new WIDGETBOX.subscriber.Widget(l,h,f);if(!g&&!WIDGETBOX.globals.suppressGetWidget){k.addEventListener("load",function(n){S.appendGetWidget(n,j);});}else{k.addEventListener("load",S.appendUserChecker);}if(m){k.addEventListener("load",m);}S.loadWidgets();return k;},appendGetWidget:function(h,f){if(h&&!h.getWidgetLoaded){var g=S.buildGetWidgetElement(h,f);h.parentNode.appendChild(g);h.getWidgetLoaded=true;}},appendUserChecker:function(f){if(f&&f.adFriendly){if(f.isPreviewInstance){WIDGETBOX.subscriber.Main.setIsSubscriber(f.id,false);}else{S.loadUchkr(S.getWidgetDiv(f.id),f.id,f.appId);}}},loadUchkr:function(j,g,h){var f=WIDGETBOX.urls.cdnGalleryBaseUrl+"/flash/uchkr.swf";var k=document.createElement("DIV");ft=new WIDGETBOX.flash.Utils.FlashTag(f,1,1,"9,0,0,0");ft.addFlashVar("js","1");ft.addFlashVar("widgetId",g);ft.addFlashVar("appId",h);ft.setWmode("transparent");ft.setAllowScriptAccess("always");if(ft){k.innerHTML=ft.toString();}j.appendChild(k);},loadAd:function(j){if(!(O&&I)){if(!j.info.hasDynamicSize||j.info.wasResized){if(j&&j.adLoaded){var h="wbx-ad-wrapper-"+j.id;var g=document.getElementById(h);if(g){g.parentNode.removeChild(g);}}if(j&&j.info.isAdFriendly){j.adDiv=S.buildAdUnitElement(j);var f=S.getWidgetDiv(j.id);f.appendChild(j.adDiv);f.style.position="relative";j.adLoaded=true;S.updateAdFrameContent(j);}}}},getWidget:function(f){var g=null;try{g=WIDGETBOX.globals.widgets[f];}catch(h){WIDGETBOX.logMessage(h);}return g;},getWidgetCfgString:function(f){var h=null;try{var g=WIDGETBOX.globals.widgets[f];if(g){h=g.cfgString;}}catch(j){WIDGETBOX.logMessage(j);}return h;},getWidgetTrackingData:function(f){var g=WIDGETBOX.globals.widgets[f];if(g){return g.tracker.getTrackingParams();}return{};},setWidgetClickTrackingParams:function(f,h){var g=WIDGETBOX.globals.widgets[f];if(g&&h){g.tracker.setClickTrackingParams(h);}},getWidgetDiv:function(f){var g=document.getElementById("widgetbox_widget_div_"+f);return g;},resizeWidgetDiv:function(j,f,g){var l=S.getWidgetDiv(j);l.style.overflow="hidden";l.style.width=f+"px";l.style.height=g+"px";var k=l.parentNode.parentNode;if(k&&k.className==="flt-ad-strut"){k.style.width=f+"px";k.style.height=g+"px";}},resizeWidget:function(j,f,g){var k=S.getWidget(j);if(!k){return ;}k.resize(f,g);if(k.info.isAdFriendly){if(k.adEnabled||(k.isSubscriber&&k.providerServiceLevel=="0")){WIDGETBOX.subscriber.Main.loadAd(k);}}},sendStyleMesssageToWidget:function(h){var j=[];for(var g=0;g<document.styleSheets.length;g++){var f=document.styleSheets[g];if(f&&f.href){j.push(f.href);}}e.sendMessage(WIDGETBOX.globals.token,h,"sendStyle",{widgetId:h,externalSheets:j});},unloadWidgets:function(h){var g=WIDGETBOX.globals.widgets;for(var f=0;f<g.length;f++){var j=g[f];if(j){if(h&&j.sourceWidgetId==null){continue;}try{j.unload();}catch(k){}}}},loadWidgets:function(){var g=WIDGETBOX.globals.widgets;var h=true;for(var f=0;f<g.length;f++){var j=g[f];if(j!=null){if(!j.loaded&&!j.unloaded&&!j.defer){h=false;}if(j.defer){j.loadInfo();}}}if(h){return ;}setTimeout(S.startWidgetInfoRequest);},reloadWidgets:function(){S.unloadWidgets();S.loadWidgets();},unloadWidget:function(g,j){var h=S.getWidget(g);if(h){var f=S.getWidget(h.sourceWidgetId);if(f){f.mouseoverState.onTop=true;if(W&&!M){WIDGETBOX.addEvent(f.mouseoverState.mouseElementBody,"mousemove",f.mouseoverState.IEMouseMove,false);}}if(j){h.anchoring.setUnloadEventConfig(j);}h.unload();}},unloadAllChildren:function(f,h){var g=S.getWidget(f);if(g){g.unloadAllChildren(h);}},startWidgetInfoRequest:function(){var l=document;var f=WIDGETBOX.urls.runtimeBaseUrl+"/get_widget.js?callback=WIDGETBOX.subscriber.Main.onWidgetInfoResponse&output=json&location="+WIDGETBOX.net.Utils.urlEncode(window.location.href)+"&timestamp="+J.newTimestamp();var n=WIDGETBOX.globals.widgets;for(var h=0;h<n.length;h++){var j=n[h];if(j!=null&&!j.widgetInfoRequestPending&&!j.loaded&&!j.unloaded&&!j.defer){var g="widgetbox_getwidgetinfo_script_"+j.appId;var o=l.getElementById(g);if(o){try{o.parentNode.removeChild(o);}catch(k){}}var m;if(j.infoUrlOverride){m=j.infoUrlOverride;}else{m=f+"&appId."+h+"="+j.appId;if(j.regId){m+="&regId."+h+"="+j.regId;}if(j.sid){m+="&sid."+h+"="+j.sid;}}WIDGETBOX.appendScript(m,g,"true");j.widgetInfoRequestPending=true;}}},onWidgetInfoResponse:function(m){try{if(!WIDGETBOX.globals.token){WIDGETBOX.globals.tokenTime=(new Date()).getTime();WIDGETBOX.globals.token=m.token;}else{m.token=WIDGETBOX.globals.token;}if(m.isBatch){WIDGETBOX.logMessage("Batch response not supported.");}else{var g=m.widgets;if(g){for(var k=0;k<g.length;k++){var f=g[k];for(var h=0;h<WIDGETBOX.globals.widgets.length;h++){var l=WIDGETBOX.globals.widgets[h];if(l&&l.appId==f.appId){try{if(l){l.widgetInfoRequestPending=false;l.loadInfo(f);}}catch(n){l.loaded=true;WIDGETBOX.logMessage(n);}}}}S.loadWidgets();}}}catch(n){WIDGETBOX.logMessage(n);}},buildGetWidgetElement:function(g,f){var h=document.createElement("div");h.setAttribute("class","wbx-gw-wrapper");h.setAttribute("id","wbx-gw-button-wrapper-"+g.id);g.suppressEditWidget=f;WIDGETBOX.subscriber.Main.renderGetWidgetButton(h,g,false);return h;},buildAdUnitElement:function(g){var h=document.createElement("div");h.setAttribute("class","wbx-ad-wrapper");h.setAttribute("id","wbx-ad-wrapper-"+g.id);h.style.height="1px";h.style.width=g.info.appWidth+"px";h.style.position="absolute";h.style.top="0px";h.style.left="0px";h.style.textAlign="center";h.style.overflow="hidden";var f='<iframe src="" width="100%" scrolling="no" height="1" frameborder="0" name="wbx-adframe-'+g.id+'" id="wbx-adframe-'+g.id+'" border="0" allowtransparency="true" style="position:absolute; top:0px; left:0px; visibility: visible;"/>';h.innerHTML=f;return h;},updateAdFrameContent:function(h){var k="<head><script>var widget = parent.WIDGETBOX.subscriber.Main.getWidget("+h.id+');function fetchPromoScript(){var headID = document.getElementsByTagName("head")[0];var newScript = document.createElement("script");newScript.type = "text/javascript";newScript.src = "'+WIDGETBOX.urls.cdnRuntimeBaseUrl+'/promo/promo/";headID.appendChild(newScript);}<\/script><style type="text/css">img{border:none;}a{outline:none;}#ad-loader-div{position:absolute;}</style></head>';var g='<body style="background-color:transparent;padding:0px;margin:0px;" onload="fetchPromoScript();"><div id="ad-loader-div"></div></body>';var f=document.getElementById("wbx-adframe-"+h.id);var j;if(f.contentDocument){j=f.contentDocument;}else{if(f.contentWindow){j=f.contentWindow.document;}else{if(window.frames[f.name]){j=window.frames[f.name].document;}}}if(j){j.open();j.write("<html>"+k+g+"</html>");j.close();}},getAdChannelsAsQueryString:function(j){var f=j.channels;var g="";if(!!f){for(var h in f){if(g!=""){g+="&";}if(f[h].channelName){g+=WIDGETBOX.net.Utils.urlEncode(h)+"="+WIDGETBOX.net.Utils.urlEncode(f[h].channelName);}}}return g;},renderGetWidgetButton:function(f,k,g,l){var j=null;if("DISABLE_GW"!=k.subscribeMode&&k.buttonMode!=2){var h=WIDGETBOX.urls.cdnRuntimeBaseUrl+"/flash/install/getwidget.swf";var m=k.info.hasDynamicSize?141:k.info.appWidth;j=new WIDGETBOX.flash.Utils.FlashTag(h,m,23,"8,0,0,0");j.setAllowScriptAccess("always");j.setId("wbx-gw-button-"+k.id);j.setWmode("transparent");j.addFlashVar("w",m);if(!WIDGETBOX.globals.disableGetWidget){if("REQUIRE_CONFIG"==k.subscribeMode){if(!k.configUrl){j.addFlashVar("gwUrl",k.detailsUrl);}else{j.addFlashVar("gwUrl",k.configUrl);}}else{j.addFlashVar("gwArg",new String(k.id));}if(!k.suppressEditWidget&&g){j.addFlashVar("cw","true");}j.addFlashVar("instanceId",k.appId);}j.addFlashVar("widgetId",new String(k.id));j.addFlashVar("cdnRuntimeUrl",WIDGETBOX.urls.cdnRuntimeBaseUrl);j.addFlashVar("cdnGalleryUrl",WIDGETBOX.urls.cdnGalleryBaseUrl);if(!k.suppressEditWidget){var n=WIDGETBOX.urls.galleryBaseUrl+"/dash/subscription.jsp?id="+k.appId;if(k.configUrl){n=k.configUrl;n+=(n.indexOf("?")>0)?"&":"?";n+="wbx.edit=true&wbx.id="+k.appId;n+="&appInstance.name="+escape(k.name);n+="&appInstance.width="+k.width;n+="&appInstance.height="+k.height;if(k.configParams){for(var o in k.configParams){n+="&"+o+"="+escape(k.configParams[o].value);}}}j.addFlashVar("cwUrl",n);}else{j.addFlashVar("suppressCW","true");}if(j){f.innerHTML=j.toString();}}else{if(k.info&&k.info.isAdFriendly){if(k.isPreviewInstance){WIDGETBOX.subscriber.Main.setIsSubscriber(k.id,false);}else{WIDGETBOX.subscriber.Main.loadUchkr(f,k.id,k.appId);}}}},setIsSubscriber:function(g,f){if(!g){g=0;}var h=WIDGETBOX.globals.widgets[g];h.isSubscriber=f;if(h.info.isAdFriendly){if(h.adEnabled||(h.isSubscriber&&(h.providerServiceLevel=="0"||h.info.widgetPrototype=="TEMPLATE"))){WIDGETBOX.subscriber.Main.loadAd(h);}}},unloadPanels:function(){var g=WIDGETBOX.globals.panels;for(var h=0;h<g.length;h++){var f=g[h];if(f){f.unload();}}},loadPanels:function(){var g=WIDGETBOX.globals.panels;var j=true;for(var h=0;h<g.length;h++){var f=g[h];if(f&&!f.loaded&&!f.defer){j=false;}if(f.defer){f.loadInfo();}}if(j){return ;}S.startPanelInfoRequest();},startPanelInfoRequest:function(){var m=document;var h=WIDGETBOX.urls.runtimeBaseUrl+"/get_panel.js?callback=WIDGETBOX.subscriber.Main.onPanelInfoResponse&output=json&location="+escape(window.location.href)+"&timestamp="+J.newTimestamp();var l=WIDGETBOX.globals.panels;for(var j=0;j<l.length;j++){var f=l[j];if(!f.panelInfoRequestPending&&!f.loaded){var g="widgetbox_getpanelinfo_script_"+f.panelId;var o=m.getElementById(g);if(o){try{o.parentNode.removeChild(o);}catch(k){}}o=m.createElement("script");var n=h+"&panelId."+j+"="+f.panelId;WIDGETBOX.appendScript(n,g,"true");f.panelInfoRequestPending=true;}}},insertPanel:function(h,f){WIDGETBOX.dom.Utils.removeAllChildren(f);var g=new WIDGETBOX.subscriber.Panel(h,f);S.loadPanels();return g;},getPanelDiv:function(f){var g=document.getElementById("widgetbox_panel_div_"+f);return g;},getPanel:function(g){var f=null;try{f=WIDGETBOX.globals.panels[g];}catch(h){WIDGETBOX.logMessage(h);}return f;},onPanelInfoResponse:function(k){try{var f=k.panels;if(k.isBatch){WIDGETBOX.logMessage("Batch response not supported.");}else{var f=k.panels;if(f){for(var j=0;j<f.length;j++){var h=f[j];for(var j=0;j<WIDGETBOX.globals.panels.length;j++){var g=WIDGETBOX.globals.panels[j];if(g.panelId==h.panelId){if(!h.isError){g.loadInfo(h);}else{g.loaded=true;g.panelInfoRequestPending=false;}}}}}S.loadPanels();}}catch(l){WIDGETBOX.logMessage(l);}},getViewportHeight:function(g){if(!g){g=document;}var f=-1;var h=g.compatMode;if((h||W)&&!c){switch(h){case"CSS1Compat":f=g.documentElement.clientHeight;break;default:f=g.body.clientHeight;}}else{f=(window.innerHeight)?window.innerHeight:0;}return f;},getViewportWidth:function(g){if(!g){g=document;}var f=-1;var h=g.compatMode;if(h||W){switch(h){case"CSS1Compat":f=g.documentElement.clientWidth;break;default:f=g.body.clientWidth;}}else{f=(window.innerWidth)?window.innerWidth:0;}return f;},findPosX:function(f){var g=0;if(f.offsetParent){while(1){g+=f.offsetLeft;if(!f.offsetParent){break;}f=f.offsetParent;}}else{if(f.x){g+=f.x;}}return g;},findPosY:function(g){var f=0;if(g.offsetParent){while(1){f+=g.offsetTop;if(!g.offsetParent){break;}g=g.offsetParent;}}else{if(g.y){f+=g.y;}}return f;},getMarginValues:function(){var j=parseInt(document.body.style.marginTop,10);var h=parseInt(document.body.style.marginRight,10);var k=parseInt(document.body.style.marginBottom,10);var g=parseInt(document.body.style.marginLeft,10);var f=[];f[0]=isNaN(j)?0:j;f[1]=isNaN(h)?0:h;f[2]=isNaN(k)?0:k;f[3]=isNaN(g)?0:g;return f;},getDocumentHeight:function(h){if(!h){h=document;}var j=h.compatMode;var g=(j!="CSS1Compat")?h.body.scrollHeight:h.documentElement.scrollHeight;var f=S.innerHeight;if(b){f=h.body.scrollHeight;}else{if((j||W)&&!c){f=(j=="CSS1Compat")?h.documentElement.clientHeight:h.body.clientHeight;}}return Math.max(g,f);},getDocumentWidth:function(h){if(!h){h=document;}var j=h.compatMode;var g=(j!="CSS1Compat")?h.body.scrollWidth:h.documentElement.scrollWidth;var f=S.innerWidth;if(b){f=h.body.scrollWidth;}else{if(j||W){f=(j=="CSS1Compat")?h.documentElement.clientWidth:h.body.clientWidth;}}return Math.max(g,f);},getScrollTop:function(){return WIDGETBOX.dom.Utils.getDocumentScrollTop();},getScrollLeft:function(){return WIDGETBOX.dom.Utils.getDocumentScrollLeft();},displayMask:function(p,g,n,o){if(!n){n=function(){WIDGETBOX.subscriber.Main.closeGetWidgetDiv();};}if(!o){o=document;}var f=o.createElement("div");f.id="wbx-mask-div";if(O&&(I||a)){f.style.backgroundImage="url("+WIDGETBOX.urls.cdnRuntimeBaseUrl+"/images/"+(p?"dark":"light")+"-bg.png)";f.style.backgroundRepeat="repeat";WIDGETBOX.dom.Utils.insertCssText("body * { opacity: 1.0 !important; }",o,null,"wbx-hide-opacity-style");}else{f.style.opacity=p?"0.8":"0.4";f.style.MozOpacity=p?"0.8":"0.4";f.style.filter="alpha(opacity="+(p?"80":"40")+")";f.style.backgroundColor=p?"#000":"#FFF";}f.style.left="0";f.style.top="0";f.style.position="absolute";f.style.zIndex=WIDGETBOX.globals.nextZIndex++;o.getElementsByTagName("body")[0].appendChild(f);var j=o.getElementById("wbx-mask-div");S.resizeMask(o);if(j){j.onclick=function(){n();};}if(!S.isListening){setTimeout(function(){WIDGETBOX.subscriber.Main.onScrollResizeCallback();},50);S.isListening=true;}if(g){var h=o.getElementsByTagName("object");for(var k=0;k<h.length;k++){h[k].style.visibility="hidden";}var q=o.getElementsByTagName("embed");for(var k=0;k<q.length;k++){q[k].style.visibility="hidden";}WIDGETBOX.dom.Utils.hideElementsOnPage(document,"select",null,WIDGETBOX.subscriber.Main.hiddenElements);for(var k=0;k<WIDGETBOX.globals.widgets.length;k++){var m=WIDGETBOX.globals.widgets[k];if(m&&m.iframe){m.iframe.style.visibility="hidden";}}for(var k=0;k<WIDGETBOX.globals.widgets.length;k++){var l=WIDGETBOX.globals.widgets[k];if(l&&WIDGETBOX.globals.widgets[k].adDiv){l.adDiv.style.display="none";}}}return j;},hideMask:function(l){if(!l){l=document;}S.isListening=false;var n=l.getElementById("wbx-mask-div");if(n){n.style.display="none";n.parentNode.removeChild(n);var m=l.getElementsByTagName("object");for(var h=0;h<m.length;h++){var k=m[h];k.style.visibility="visible";}var j=l.getElementsByTagName("embed");for(var h=0;h<j.length;h++){var f=j[h];f.style.visibility="visible";}WIDGETBOX.dom.Utils.showHiddenElementsOnPage(WIDGETBOX.subscriber.Main.hiddenElements);for(var h=0;h<WIDGETBOX.globals.widgets.length;h++){var g=WIDGETBOX.globals.widgets[h];if(g&&g.iframe){g.iframe.style.visibility="visible";}}for(var h=0;h<WIDGETBOX.globals.widgets.length;h++){var g=WIDGETBOX.globals.widgets[h];if(g&&g.adDiv){g.adDiv.style.display="";}}if(O){WIDGETBOX.dom.Utils.insertCssText("/* unhide */",l,null,"wbx-hide-opacity-style");}}if(window.scrollBy){window.scrollBy(0,1);window.scrollBy(0,-1);}},resizeMask:function(h){if(!h){h=document;}var j=h.getElementById("wbx-mask-div");if(j){var g=S.getDocumentWidth(h);var f=S.getDocumentHeight(h);if(g+"px"!=j.style.width){j.style.width=g+"px";}if(f+"px"!=j.style.height){j.style.height=f+"px";}}},onScrollResizeCallback:function(){S.positionGetWidgetDiv();S.resizeMask();if(S.isListening){setTimeout(function(){WIDGETBOX.subscriber.Main.onScrollResizeCallback();},50);}},setAdUnitSizeAndLocation:function(AC,n,m,o,z,AD,j){if(AC){var v=document.getElementById("wbx-adframe-"+AC);var s=document.getElementById("wbx-ad-wrapper-"+AC);if(s&&v){var u;var g=S.getWidgetDiv(AC);try{u=g.childNodes[0];}catch(AB){WIDGETBOX.logMessage(AB);}var p="0px";if(!isNaN(o)){p=o+"px";}var t="0px";if(!isNaN(z)){t=z+"px";}var f=(isNaN(n))?"0":n;var q=(isNaN(m))?"0":m;if(!M){var k=WIDGETBOX.globals.widgets[AC].parentNode;var r=(k.id=="widgetbox_widget_parent_"+AC);var AA=(g.scrollWidth>u.width);var l=u&&(!W||(!r&&AA));if(l){f=Number(f)+Number(u.offsetLeft);q=Number(q)+Number(u.offsetTop);}}s.style.width=p;v.style.width=p;s.style.left=f+"px";v.style.height=j+"px";s.style.height=t;if(q<0){q=0;}s.style.top=q+"px";v.style.top=(-q)+"px";}}},injectAd:function(f,h){var g=WIDGETBOX.globals.widgets[f];if(g&&(g.info.widgetPrototype=="BLIDGET"||g.info.widgetPrototype=="RICH_MEDIA_AD")&&g.iframe&&g.iframe.loadAdFromXML){g.iframe.loadAdFromXML(h,g.isSubscriber);}},makeLightbox:function(h,j){L=false;var f=S.displayMask(true,h,j);f.style.zIndex=10000000000;var g=document.getElementById("wbx-lb-cont-div");if(!g){g=document.createElement("div");g.id="wbx-lb-cont-div";g.style.cssFloat="left";g.style.styleFloat="left";g.style.position="absolute";g.style.zIndex=10000000000+1;g.style.border="0px";g.style.padding="5px";g.style.margin="0px";g.style.background="#FFF";document.getElementsByTagName("body")[0].appendChild(g);}d=g;return d;},renderUrlInLightbox:function(n,h,q,j,r,l,o,m){WIDGETBOX.notifyEventListeners("openModalDialog");var p=null;if(typeof l!=="undefined"){p=WIDGETBOX.globals.widgets[l];}var f=function(){if(p){p.mouseoverState.onTop=true;}try{WIDGETBOX.subscriber.Main.closeGetWidgetDiv(l);}catch(s){}};var k=S.makeLightbox(true,function(){f();});var g=document.createElement("iframe");g.id="wbxLightboxedElement";g.width=j;g.style.width=j+"px";g.height=r;g.style.height=r+"px";g.name=q;g.frameBorder="0";g.marginWidth="0";g.marginHeight="0";g.src=(h&&typeof h!=="string")?WIDGETBOX.net.Utils.newURLWithParams(n,h):n;k.appendChild(g);if(p){if(!p.tracker.isNew){p.tracker.logWidgetAction(WIDGETBOX.track.tracker.ActionLabel.OPEN,p.fId,m||WIDGETBOX.track.tracker.ActionCause.USER,o);}p.mouseoutState.suspended=false;}WIDGETBOX.subscriber.Main.renderCloseButton(k,"outside","right",function(){if(p){p.anchoring.unloadEvent.cause=WIDGETBOX.track.tracker.ActionCause.USER;if(p.tracker.isNew){p.tracker.logCloseInteraction();}}f();},"Close",j);},renderCanvasInLightbox:function(j){var o,t,n,f,s,g,u,k,q,m;if(typeof j!=="string"){o=j.baseUrl;t=j.stream;k=j.sourceWidgetId;n=j.sourceWidgetGuid;f=j.isChild;s=j.windowName;g=j.width;u=j.height;q=j.actionCustomString;m=j.actionCause;}else{o=arguments[0];t=arguments[1];n=arguments[2];f=arguments[3];s=arguments[4];g=arguments[5];u=arguments[6];k=arguments[7];}function p(x,v){var y=x.indexOf("#")>-1;if(!y){x=x+"#";}var w=x.indexOf("#")!=x.length-1;if(w){x=x+"|";}x=x+v;return x;}if(t&&t!=""&&t!="null"&&t!="undefined"){o=p(o,"_stream/"+t);}if(f&&n&&n!=""&&n!="null"&&n!="undefined"){var h="";var r=WIDGETBOX.globals.widgets[k];if(r){h="_tracker/update/"+n+"/"+r.sid;var l=null;if(typeof r.sourceWidgetId!=="undefined"){l=r.getSourceWidget(true)||r;if(l){n=l.appId||n;if(l.testVariants){h+="/"+encodeURIComponent(WIDGETBOX.net.Utils.addParameters("",l.testVariants));}}}}o=p(o,h);}S.renderUrlInLightbox(o,null,s,g,u,k,q,m);},renderWidgetInLightbox:function(q,k,o,m,g,h,j){var p=WIDGETBOX.globals.widgets[m];if(g&&p){if(p.mouseoutState.suspended){return ;}p.mouseoutState.suspended=true;}WIDGETBOX.notifyEventListeners("openModalDialog");var l=S.makeLightbox(true,function(){WIDGETBOX.subscriber.Main.closeGetWidgetDiv(n.id);});var f=document.createElement("div");f.id="wbxLightboxedElement";l.appendChild(f);var n=S.insertWidget(q,null,f,!o,true,S.positionLightbox);n.addEventListener("loadInfo",function(r){if(g){r.sourceWidgetId=m;r.info.configParams.wbx_parent_id={name:"wbx_parent_id",value:m};}});n.addEventListener("load",function(r){if(h){r.setOnMouseoutHandler(f,function(){if(r.tracker.isNew){r.tracker.logCloseInteraction(true);}WIDGETBOX.subscriber.Main.closeGetWidgetDiv(r.id);},((M)?1000:500));}if(j){r.closeButton.style.display="none";}});if(g&&p){n.tracker=p.tracker.clone();}n.cfgString=k;},renderWidgetAnchored:function(x,l,p,o,s,q,z){var w=WIDGETBOX.globals.widgets[x];var r=WIDGETBOX.globals.nextZIndex++;if(q&&w){if(w.mouseoutState.suspended){return ;}w.mouseoutState.suspended=true;if(w.zIndexForExpandable){r=w.zIndexForExpandable;}if(z){w.anchoring.unloadOnLink=true;}}WIDGETBOX.notifyEventListeners("openModalDialog");var m=document.getElementById("wbxAnchoredElement_"+l);if(m){m.parentNode.removeChild(m);}m=document.createElement("div");var y=w.anchoring.anchorChildrenToBody;var AA=w.iframe;var f=null;var h="auto";while(AA&&AA.nodeName.toLowerCase()!="body"&&AA.nodeName.toLowerCase()!="head"&&AA.nodeName.toLowerCase()!="#document"&&AA.parentNode){var t=WIDGETBOX.dom.Utils.getComputedStyle(AA,"position");if(t=="fixed"){y=false;break;}AA=AA.parentNode;}m.style.position="absolute";m.id="wbxAnchoredElement_"+l;var j=WIDGETBOX.dom.Utils.getElementsByTagName("object",document);j=WIDGETBOX.dom.Utils.getElementsByTagName("embed",document,j);var AC=false;for(var v=0;v<j.length;v++){var u=j[v];if(!AC){if(u.offsetWidth>=10&&u.offsetHeight>=10){var AB=WIDGETBOX.flash.Utils.getParamValue(u,"wmode");if(!AB||AB=="window"){AC=true;}}}}m.style.zIndex=r;if(y){document.getElementsByTagName("body")[0].appendChild(m);}else{w.parentNode.parentNode.insertBefore(m,w.parentNode);var n="wbxClearElement_"+l;var g=document.getElementById(n);if(!g){g=document.createElement("div");g.id=n;g.style.clear="both";m.parentNode.insertBefore(g,m);}}var k=S.insertWidget(l,null,m,true,true,function(AD){WIDGETBOX.subscriber.Main.anchorWidget(AD,w,o,true);if(AD.loaded&&w&&w.mouseoutState.suspended&&AD.anchoring.anchorToBody){setTimeout(function(){WIDGETBOX.subscriber.Main.onAdjustAnchorCallback(AD,w,o);},50);}});k.anchoring.anchorToBody=y;k.addEventListener("loadInfo",function(AE){if(q){AE.sourceWidgetId=x;AE.info.configParams.wbx_parent_id={name:"wbx_parent_id",value:x};if(AC){var AD=AE.info.configParams["wbx.wmodeOverride"];if(AD&&AD.value){WIDGETBOX.globals.wmodeOverride=AD.value;}}}});if(q&&w){k.tracker=w.tracker.clone();}k.cfgString=p;k.addEventListener("load",function(AE){var AD=function(){WIDGETBOX.subscriber.Main.hideAnchoredWidget(m.id,AE.id);};AE.addEventListener("unload",function(AF){if(f){f.style.zIndex=h;}AD();});if(z){AE.setOnMouseoutHandler(AE.iframe,function(){if(AE.tracker.isNew){AE.tracker.logCloseInteraction(true);}AE.unload();},((M)?1000:500));}if(!s){AE.closeButton=WIDGETBOX.subscriber.Main.renderCloseButton(m,"outside","right",function(){AE.anchoring.unloadEvent.cause=WIDGETBOX.track.tracker.ActionCause.USER;if(AE.tracker.isNew){AE.tracker.logCloseInteraction();}AE.unload();},"Close",AE.info.appWidth);}});},hideAnchoredWidget:function(m,h){var k=document.getElementById(m);if(k){var l=WIDGETBOX.globals.widgets[h];if(l){var f=l.anchoring.unloadEvent;if(!l.tracker.isNew){l.tracker.logWidgetAction(f.label||WIDGETBOX.track.tracker.ActionLabel.COLLAPSE,f.payload||l.fId,f.cause||WIDGETBOX.track.tracker.ActionCause.AUTO,f.custom);}if(l.sourceWidgetId){var g=WIDGETBOX.globals.widgets[l.sourceWidgetId];if(g){g.mouseoutState.suspended=false;}clearTimeout(H);}}WIDGETBOX.dom.Utils.removeAllChildren(k);WIDGETBOX.notifyEventListeners("closeModalDialog");}for(var j=0;j<WIDGETBOX.subscriber.Main.hiddenElements.length;j++){WIDGETBOX.subscriber.Main.hiddenElements[j].style.visibility="visible";}WIDGETBOX.subscriber.Main.hiddenElements=[];},anchorWidget:function(AJ,AA,m,w){var j=AA.iframe;if(AJ.iframe&&j&&document.getElementById(j.id)){var f=w;var n=AJ.iframe.ownerDocument;var AU=new Date().getTime();f=f||(AU-AJ.anchoring.lastAnchorAttempt>1000);var s=WIDGETBOX.dom.Utils.getDocumentHeight(n);var p=WIDGETBOX.subscriber.Main.getViewportWidth(n);var AE=WIDGETBOX.subscriber.Main.getViewportHeight(n);var h,g;try{h=window.pageXOffset;g=window.pageYOffset;}catch(AS){h=g=null;}if(h==undefined){h=n.documentElement.scrollLeft;}if(g==undefined){g=n.documentElement.scrollTop;}f=f||p!=AJ.anchoring.lastViewportWidth||AE!=AJ.anchoring.lastViewportHeight||h!=AJ.anchoring.lastPageXOffset||g!=AJ.anchoring.lastPageYOffset;if(f){var AN=false;var AM=false;var AD={};var AB={};var AP,AO;while(!AN||!AM){if(!m){m="TR";}if(AJ.anchoring.anchorToBody){var AC=n.documentMode;if(T&&(AC&&!isNaN(AC)&&Number(AC)>=8)){var k=Math.max(n.documentElement.scrollTop,n.body.scrollTop);var AF=Math.max(n.documentElement.scrollLeft,n.body.scrollLeft);AP=AA.iframe.getBoundingClientRect().left;AO=AA.iframe.getBoundingClientRect().top;if(AJ.parentNode.style.position!="fixed"){AP+=AF;AO+=k;}}else{AP=WIDGETBOX.dom.Utils.getX(AA.iframe);AO=WIDGETBOX.dom.Utils.getY(AA.iframe);}}else{AP=0;AO=0;var q=("center"==WIDGETBOX.dom.Utils.getComputedStyle(AA.parentNode,"text-align")||(AA.parentNode.parentNode&&"center"==AA.parentNode.parentNode.getAttribute("align")));if(q){AJ.parentNode.style.marginLeft=(AA.iframe.offsetLeft-AA.divNode.offsetLeft)+"px";}}if(m.indexOf("R")!=-1){AP+=(AA.info.appWidth-AJ.info.appWidth);}else{if(m.indexOf("L")==-1){AP+=(AA.info.appWidth-AJ.info.appWidth)/2;}}if(m.indexOf("B")!=-1){AO+=(AA.info.appHeight-AJ.info.appHeight);}else{if(m.indexOf("T")==-1){AO+=(AA.info.appHeight-AJ.info.appHeight)/2;}}var z=AJ.parentNode.style.left;var AT=AJ.parentNode.style.top;var u=AP;var v=AO;if(!AJ.anchoring.anchorToBody){var AH=WIDGETBOX.dom.Utils.getXY(AA.iframe);u+=AH[0];v+=AH[1];}if(m.indexOf("R")>-1){AN=u>0;}else{if(m.indexOf("L")>-1){AN=(u+AJ.parentNode.offsetWidth)<(p-10);}}if(m.indexOf("B")>-1){AM=v>10;}else{if(m.indexOf("T")>-1){AM=(v+AJ.parentNode.offsetHeight)<s;}}if(AN&&AM){AJ.anchorPosition=m;}else{if(!AN){if(m.indexOf("L")>-1&&!AD[m]){AD[m]=true;m=m.replace("L","R");}else{if(m.indexOf("R")>-1&&!AD[m]){AD[m]=true;m=m.replace("R","L");}else{AN=true;}}}if(!AM){if(m.indexOf("T")>-1&&!AB[m]){AB[m]=true;m=m.replace("T","B");}else{if(m.indexOf("B")>-1&&!AB[m]){AB[m]=true;m=m.replace("B","T");}else{AM=true;}}}}}if(AJ.anchoring.lastX!=AP||AJ.anchoring.lastY!=AO){if(AJ.anchoring.anchorToBody){AJ.parentNode.style.left=AP+"px";AJ.parentNode.style.top=AO+"px";}else{var o=parseFloat(AJ.parentNode.style.marginLeft);o=(AJ.parentNode.style.marginLeft!=""&&!isNaN(o))?o:0;o+=AP;AJ.parentNode.style.marginLeft=o+"px";var AL=parseFloat(AJ.parentNode.style.marginTop);AL=(AJ.parentNode.style.marginTop!=""&&!isNaN(AL))?AL:0;AL+=AO;AJ.parentNode.style.marginTop=AL+"px";}}AJ.anchorPosition=m;WIDGETBOX.dom.Utils.hideElementsOnPage(document,"select",AJ.parentNode,WIDGETBOX.subscriber.Main.hiddenElements);if(w){var AK=WIDGETBOX.dom.Utils.getElementsByTagName("object",document);AK=WIDGETBOX.dom.Utils.getElementsByTagName("embed",document,AK);AK=WIDGETBOX.dom.Utils.getElementsByTagName("img",document,AK);if(AA.zIndexForExpandable==null){var t=AJ.parentNode.style.zIndex;for(var AR=0;AR<AK.length;AR++){var AI=AK[AR];var AQ=AI.parentNode;while(AQ&&AQ.nodeName!="BODY"&&AQ.nodeName!="HEAD"&&AQ.nodeName!="#document"){var l=AQ.style&&WIDGETBOX.dom.Utils.getComputedStyle(AQ,"visibility")!="hidden"&&WIDGETBOX.dom.Utils.getComputedStyle(AQ,"display")!="none";if(l){var r=WIDGETBOX.dom.Utils.doNodesOverlap(AQ,AJ.parentNode);if(r){var AG=AQ.style.zIndex;if(!AG){AG=WIDGETBOX.dom.Utils.getComputedStyle(AQ,"z-index");}if(AG&&!isNaN(AG)&&Number(AG)>=Number(t)){t=Number(AG)+1;}}}AQ=AQ.parentNode;}}}AJ.parentNode.style.zIndex=t;}AJ.anchoring.lastX=AP;AJ.anchoring.lastY=AO;AJ.anchoring.lastViewportWidth=p;AJ.anchoring.lastViewportHeight=AE;AJ.anchoring.lastPageXOffset=h;AJ.anchoring.lastPageYOffset=g;AJ.anchoring.lastAnchorAttempt=AU;}}else{WIDGETBOX.subscriber.Main.hideAnchoredWidget(AJ.parentNode.id,AJ.id);}},onAdjustAnchorCallback:function(j,h,g,f){S.anchorWidget(j,h,g,false);if(j.loaded&&h&&h.mouseoutState.suspended){H=setTimeout(function(){WIDGETBOX.subscriber.Main.onAdjustAnchorCallback(j,h,g,false);},50);}},hideInPlaceWidget:function(g,h,k,p,n){if(!n){n=document;}var o=n.getElementById(h);var l=n.getElementById(k);if(o){WIDGETBOX.dom.Utils.removeAllChildren(o);o.parentNode.removeChild(o);}var m=WIDGETBOX.globals.widgets[g];if(m){m.mouseoutState.suspended=false;}if(l){if(M){l.style.display="";}else{l.style.visibility="visible";l.style.height=m.info.appHeight+"px";var f=WIDGETBOX.globals.widgets[p];var j=f.anchoring.unloadEvent;if(!f.tracker.isNew){f.tracker.logWidgetAction(j.label||WIDGETBOX.track.tracker.ActionLabel.COLLAPSE,j.payload||f.fId,j.cause||WIDGETBOX.track.tracker.ActionCause.AUTO,j.custom);}}}WIDGETBOX.notifyEventListeners("closeModalDialog");},renderWidgetInPlaceOfExistingWidget:function(x,m,p,t,v,s,q,y,AA){var h="wbxwgt"+m.replace(/-/g,"")+x;var u=document.getElementById(h);var w=WIDGETBOX.globals.widgets[x];if(u||(w&&w.mouseoutState.suspended)){return ;}var r=WIDGETBOX.globals.nextZIndex++;if(q&&w){w.mouseoutState.suspended=true;if(w.zIndexForExpandable){r=w.zIndexForExpandable;}}WIDGETBOX.notifyEventListeners("openModalDialog");var z=v||w.info.appWidth;var AB=s||w.info.appHeight;var f=p;if(f){f+="&";}f+="appInstance.width="+z;f+="&appInstance.height="+AB;var o=document.createElement("div");var n=document.createElement("div");o.appendChild(n);o.style.lineHeight="0px";if(AA){o.style.position="absolute";o.style.marginTop="0px";o.style.width=w.parentNode.offsetWidth+"px";var j=WIDGETBOX.dom.Utils.getComputedStyle(w.parentNode,"z-index");o.style.zIndex=(!j||j=="auto")?(r):Number(j)+1;}else{o.style.position="relative";}o.id="wbxwgt"+m.replace(/-/g,"");w.divNode.parentNode.insertBefore(o,((AA)?w.divNode:w.divNode.nextSibling));var k=function(AD){if(AA){var AE="wbxClearElement_"+m;var AC=document.getElementById(AE);if(!AC){AC=document.createElement("div");AC.id=AE;AC.style.clear="both";if(M||U||(W&&document.documentMode<8)){w.divNode.style.height=w.info.appHeight+"px";}o.parentNode.insertBefore(AC,o);}}else{if(M){w.divNode.style.display="none";}else{w.divNode.style.visibility="hidden";w.divNode.style.height="0px";}}AD.resize(w.info.appWidth,w.info.appHeight);};function g(AC){AC.info.appWidth=z;AC.info.appHeight=AB;if(q){AC.sourceWidgetId=x;AC.info.configParams.wbx_parent_id={name:"wbx_parent_id",value:x};}}var l=S.insertWidget(m,null,n,true,true,k);l.addEventListener("loadInfo",g);if(q&&w){l.tracker=w.tracker.clone();}l.cfgString=f;l.addEventListener("load",function(AD){var AC=function(){WIDGETBOX.subscriber.Main.hideInPlaceWidget(x,o.id,w.divNode.id,AD.id,n.ownerDocument);};AD.addEventListener("unload",function(AE){AC();});if(y){AD.setOnMouseoutHandler(AD.iframe,function(){if(AD.tracker.isNew){AD.tracker.logCloseInteraction(true);}AD.unload();},((M)?1000:500));}if(!t){AD.closeButton=WIDGETBOX.subscriber.Main.renderCloseButton(n,"inside","right",function(){AD.anchoring.unloadEvent.cause=WIDGETBOX.track.tracker.ActionCause.USER;if(AD.tracker.isNew){AD.tracker.logCloseInteraction();}AD.unload();},"Close",z,n.ownerDocument);if(AD.closeButton&&AA&&M){AD.closeButton.style.textAlign=WIDGETBOX.dom.Utils.getComputedStyle(AD.closeButton.parentNode,"text-align");}}});},positionLightbox:function(f){S.positionGetWidgetDiv(f.info.appWidth,f.info.appHeight);var g=function(){WIDGETBOX.subscriber.Main.closeGetWidgetDiv(f.id);};f.addEventListener("unload",function(h){g();});f.closeButton=S.renderCloseButton(d,"outside","right",function(){f.anchoring.unloadEvent.cause=WIDGETBOX.track.tracker.ActionCause.USER;if(f.tracker.isNew){f.tracker.logCloseInteraction();}f.unload();},"Close",f.info.appWidth);},closeFunctions:{},renderCloseButton:function(o,m,w,l,s,t,v,g){var q=new Date().getTime();if(!m){m="outside";}if(!w){w="right";}if(!s){s="Close";}if(!l){l=WIDGETBOX.subscriber.Main.closeGetWidgetDiv;}if(!v){v=document;}if(!g){g=q;}var f=WIDGETBOX.createElement("div",o);if(!M){var r=WIDGETBOX.dom.Utils.getComputedStyle(o,"text-align");if(r=="center"||r=="right"){f.style.width="100%";}}else{if(w=="right"){f.style.textAlign="right";}else{f.style.textAlign="left";}}f.style.width="100%";f.style.height="1px";f.style.position="absolute";var k=WIDGETBOX.createElement("div",f);k.setAttribute("id","wbx-close-mask-"+q);k.setAttribute("class","wbx-close-mask");k.style.width=t+"px";if(!M){if(r=="center"){k.style.margin="0 auto";}else{if(r=="right"){k.style.cssFloat="right";}}}var n=function(){try{f.removeChild(k);l();}catch(x){}};k.onclick=n;var p="";if(M){p=' filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+WIDGETBOX.urls.cdnRuntimeBaseUrl+"/images/closebox.png?cb="+q+'", sizingMethod="scale");';}else{p=" background:url("+WIDGETBOX.urls.cdnRuntimeBaseUrl+"/images/closebox.png?cb="+q+");";}var j="text-decoration:none;float:"+w+";";k.innerHTML="<a style='"+j+"' title='"+s+"' href='javascript:void(0);'><div id='wbx-close-btn' style='width:30px; height:30px;"+p+"'>&nbsp;</div></a>";f.style.zIndex=WIDGETBOX.globals.nextZIndex++;f.appendChild(k);o.appendChild(f);if((m=="outside")){f.style.top="-18px";if(w=="left"){f.style.left=(f.style.left-20)+"px";}else{f.style.right="-20px";}}else{f.style.top="0px";f.style.left="0px";var h=f.offsetLeft;var u=-(h)+"px";f.style.left=u;}return f;},openGetWidgetDiv:function(f){S.renderGetWidget(new WIDGETBOX.subscriber.WidgetMenuConfig(WIDGETBOX.globals.widgets[f]));},renderGetWidget:function(AC){WIDGETBOX.notifyEventListeners("openModalDialog");WIDGETBOX.subscriber.Main.closeGetWidgetDiv();if(WIDGETBOX.globals.disableInstallerMenu){return ;}if(!WIDGETBOX.globals.renderInstallerMenuInline){var v=S.displayMask(false,true);v.style.zIndex=10000000000;}var o=document.getElementById("wbx-gw-menu-div");if(o==null){o=document.createElement("div");o.id="wbx-gw-menu-div";o.style.cssFloat="left";o.style.styleFloat="left";o.style.position="absolute";o.style.zIndex=10000000000+1;o.style.border="0px";o.style.backgroundColor="transparent";o.style.padding="0px";o.style.margin="0px";o.style.width="255px";o.style.height="458px";o.style.display="none";o.style.border="0";document.getElementsByTagName("body")[0].appendChild(o);}else{o.innerHTML="";}try{var j=WIDGETBOX.flash.Utils.GetFlashVersionArray();if(!AC.panelId&&j[0]<9){var s=j[0]+"."+j[1]+"r"+j[2];var r="wbxLightboxedElement";var g=document.createElement("iframe");g.id=r;g.name=r;g.width="255";g.height="458";g.frameBorder="0";g.scrolling="no";g.marginWidth="0";g.marginHeight="0";g.style.border="1px solid #000";o.appendChild(g);if(window.frames[r]&&window.frames[r].name!=r){window.frames[r].name=r;}var z=document.createElement("a");z.id="closebtn";z.innerHTML="Close";z.onclick=function(){S.closeGetWidgetDiv();};z.style.background="url(/css/images/close-btn.png) no-repeat";z.style.display="block";z.style.position="absolute";z.style.top="3px";z.style.right="2px";z.style.width="24px";z.style.height="20px";z.style.textIndent="-9999px";z.style.overflow="hidden";o.appendChild(z);var p=document.createElement("form");p.id="wbx_flash_upgrade_form";p.target="wbxLightboxedElement";p.action=WIDGETBOX.urls.galleryBaseUrl+"/getwidget/html_menu.jsp";p.method="POST";o.appendChild(p);var u=document.createElement("input");u.type="hidden";u.name="version";u.value=s;p.appendChild(u);var m=document.createElement("input");m.type="hidden";m.name="appRegId";m.value=AC.regId;p.appendChild(m);var n=document.createElement("input");n.type="hidden";n.name="location";n.value=location.href;p.appendChild(n);if(AC.configData){var q=document.createElement("input");q.type="hidden";q.name="appConfig";q.value=AC.configData;p.appendChild(q);}if(AC.sourceId){var AA=document.createElement("input");AA.type="hidden";AA.name="sourceId";AA.value=AC.sourceId;p.appendChild(AA);}if(AC.instId){var w=document.createElement("input");w.type="hidden";w.name="instId";w.value=AC.instId;p.appendChild(w);}p.submit();}else{var x=WIDGETBOX.urls.cdnRuntimeBaseUrl+"/flash/install/menu.swf?cb="+WIDGETBOX.version;var f=(WIDGETBOX.globals.renderInstallerMenuInline)?281:255;var t=458;var l=WIDGETBOX.subscriber.Main.getDocumentWidth();var h=WIDGETBOX.subscriber.Main.getDocumentHeight();var AB=false;if(h<t){t=h;AB=true;}if(l<f){f=l;AB=true;}var k=null;try{k=new WIDGETBOX.flash.Utils.FlashTag(x,f,t,"9,0,0,0");}catch(y){k=new WIDGETBOX.flash.Utils.FlashTag(x,f,t,"9,0,0,0");}k.setAllowScriptAccess("always");k.setId("wbxLightboxedElement");k.setSalign("tl");k.setWmode("transparent");k.addFlashVar("syndicationHost",AC.syndUrl);k.addFlashVar("galleryHost",AC.galleryUrl);k.addFlashVar("cdnRuntimeURL",AC.cdnRuntimeUrl);k.addFlashVar("appRegId",AC.regId);k.addFlashVar("sourceId",AC.sourceId);k.addFlashVar("instanceId",AC.instId);k.addFlashVar("panelId",AC.panelId);k.addFlashVar("context",AC.context);k.addFlashVar("locationURL",AC.location);k.addFlashVar("fromPartnerCode",AC.fromPn);k.addFlashVar("toPartnerCode",AC.toPn);k.addFlashVar("fromGallery",AC.galleryCode);k.addFlashVar("appConfig",AC.configData);k.addFlashVar("sessionId",AC.sessionId);k.addFlashVar("regVersion",AC.regVersion);k.addFlashVar("version",AC.version);k.addFlashVar("variants",AC.variants);if(AC.jsOnly!=null){k.addFlashVar("jsOnly",AC.jsOnly);}if(WIDGETBOX.globals.renderInstallerMenuInline){k.addFlashVar("onPage","true");}if(AB){k.addFlashVar("w",f-20);k.addFlashVar("h",t-20);}else{if(WIDGETBOX.globals.renderInstallerMenuInline){k.addFlashVar("w",280);}}o.style.display="";o.innerHTML=k.toString();if(S.onShowFn){S.onShowFn();}}if(o.style.position=="absolute"){S.positionGetWidgetDiv();d=o;}}catch(y){}},positionGetWidgetDiv:function(g,l){var f=document.getElementById("wbxLightboxedElement");if(f!=null){g=f.offsetWidth;l=f.offsetHeight;}if(!g||isNaN(g)){g=0;}if(!l||isNaN(l)){l=0;}var m=d;if(m){m.style.display="";var n=S.getViewportHeight();var k=(S.getViewportWidth()/2)-(g/2)+WIDGETBOX.dom.Utils.getDocumentScrollLeft();if(k<0){m.style.left="0px";}else{if(k+"px"!=m.style.left){m.style.left=k+"px";}}if(n-20<=l){if(!L){m.style.top=(WIDGETBOX.dom.Utils.getDocumentScrollTop()+20)+"px";}}else{var j=(n/2)-(l/2)+WIDGETBOX.dom.Utils.getDocumentScrollTop();if(j<0){m.style.top="0px";}else{if(j+"px"!=m.style.top){m.style.top=j+"px";}}}if(l>0){L=true;}}},closeGetWidgetDiv:function(k){S.isListening=false;var h=d;L=false;if(WIDGETBOX.globals.renderInstallerMenuInline){if(h!=null){h.style.display="none";}}else{if(h!=null){setTimeout(function(){if(h.parentNode&&h.parentNode.hasChildNodes()){WIDGETBOX.dom.Utils.removeAllChildren(h);var l=h.parentNode;l.removeChild(h);}d=null;h=null;},100);if(S.onCloseFn){S.onCloseFn();}WIDGETBOX.notifyEventListeners("closeModalDialog");if(typeof k!=="undefined"){var j=WIDGETBOX.globals.widgets[k];var f=j.anchoring.unloadEvent;if(!j.tracker.isNew){j.tracker.logWidgetAction(f.label||WIDGETBOX.track.tracker.ActionLabel.CLOSE,f.payload||j.fId,f.cause||WIDGETBOX.track.tracker.ActionCause.AUTO,f.custom);}var g=WIDGETBOX.globals.widgets[j.sourceWidgetId];if(g){g.mouseoutState.suspended=false;}}}S.hideMask();}},getElementsByClass:function(m,g,p){var o=[];if(g==null){g=document;}if(p==null){p="*";}var k=g.getElementsByTagName(p);var f=k.length;var n=new RegExp("(^|\s)"+m+"(\s|$)");for(var l=0,h=0;l<f;l++){if(n.test(k[l].className)){o[h]=k[l];h++;}}return o;},setChildParameters:function(f,h){var g=S.getWidget(f);if(g){g.childParams=h;}},getChildParameters:function(g){var f=S.getWidget(g);if(f&&f.childParams){return f.childParams;}else{return{};}},addMouseListenerToWidget:function(h,g){var j=S.getWidget(h);if(j&&j.iframe&&g){var f=function(m){var l=m?m:window.event;var k=(l.offsetX!==undefined)?l.offsetX:l.pageX-WIDGETBOX.dom.Utils.getX(l.target);var n=(l.offsetY!==undefined)?l.offsetY:l.pageY-WIDGETBOX.dom.Utils.getY(l.target);j.dispatchEvent("mouse",g,{x:k,y:n});};if(g=="mouseover"){j.setOnMouseoverHandler(j.iframe,f,j.anchoring.overTimeoutLength);}else{WIDGETBOX.removeEvent(j.iframe,g,f);WIDGETBOX.addEvent(j.iframe,g,f);}}}};var S=WIDGETBOX.subscriber.Main;S.init();WIDGETBOX.setReady("subscriber.Main");})();}if(!WIDGETBOX.subscriber.WidgetMenuConfig){(function(){function A(C){this.regId;this.sourceId;this.instId;this.panelId;this.context;this.toPn;this.fromPn;this.galleryUrl;this.syndUrl;this.cdnRuntimeUrl;this.location;this.galleryCode;this.configData;this.jsOnly;this.widgetId=0;this.sessionId;this.regVersion;this.regPubVersion;this.version;this.variants;if(C){this.regId=C.regId;this.sourceId=C.appId;this.instId=null;this.panelId=null;this.context="wild";this.toPn=null;this.fromPn=C.partnerNetwork;this.syndUrl=WIDGETBOX.urls.runtimeBaseUrl;this.galleryUrl=WIDGETBOX.urls.galleryBaseUrl;this.cdnRuntimeUrl=WIDGETBOX.urls.cdnRuntimeBaseUrl;this.location=window.location.href;this.galleryCode=null;this.configData=C.cfgString;this.jsOnly=null;this.widgetId=C.id;this.sessionId=C.sid;this.regVersion=C.info.regVersion;this.regPubVersion=C.info.regPubVersion;this.version=C.info.appVersion;if(C.testVariants){var B=WIDGETBOX.net.Utils.addParameters(null,C.testVariants);if(B){this.variants=B;}}}}WIDGETBOX.subscriber.WidgetMenuConfig=A;})();}